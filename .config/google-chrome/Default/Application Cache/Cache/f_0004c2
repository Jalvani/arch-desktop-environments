function NGb(a,b){var c=new Date;void 0!==a&&c.setFullYear(a);c.setMonth(b);c.setDate(2);return c}function OGb(a){a=-a.getTimezoneOffset();return null!==a?a:0}var PGb;PGb=function(a){return OGb(NGb(a,5))};var QGb;
QGb=function(a){var b=new Date(2010,6,15,1,0,0,0);return{"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,
2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Europe/Helsinki":new Date(2013,2,31,5,0,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":b,"Asia/Amman":new Date(2013,2,29,1,0,0,0),"Asia/Beirut":new Date(2013,
2,31,2,0,0,0),"Asia/Damascus":new Date(2013,3,6,2,0,0,0),"Asia/Jerusalem":new Date(2013,2,29,5,0,0,0),"Asia/Yekaterinburg":b,"Asia/Omsk":b,"Asia/Krasnoyarsk":b,"Asia/Irkutsk":b,"Asia/Yakutsk":b,"Asia/Vladivostok":b,"Asia/Baku":new Date(2013,2,31,4,0,0),"Asia/Yerevan":new Date(2013,2,31,3,0,0),"Asia/Kamchatka":b,"Asia/Gaza":new Date(2010,2,27,4,0,0),"Africa/Cairo":new Date(2010,4,1,3,0,0),"Europe/Minsk":b,"Pacific/Apia":new Date(2010,10,1,1,0,0,0),"Pacific/Fiji":new Date(2010,11,1,0,0,0),"Australia/Perth":new Date(2008,
10,1,1,0,0,0)}[a]};var RGb;RGb=function(a){var b=7<a.getMonth(),c;b?c=PGb(a.getFullYear()):(c=a.getFullYear(),c=OGb(NGb(c,0)));a=c-OGb(a);return 0>c||b?0!==a:0>a};
var SGb={"-720,0":"Pacific/Majuro","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax",
"-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow",
"210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide",
"600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"};
function TGb(a){var b={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Amman","Asia/Jerusalem","Asia/Beirut","Europe/Helsinki","Asia/Damascus"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],
"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka","Pacific/Fiji"],"Pacific/Tongatapu":["Pacific/Apia"],
"Asia/Baghdad":["Europe/Minsk"],"Asia/Baku":["Asia/Yerevan","Asia/Baku"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"]};if("undefined"!==typeof b[a])for(var b=b[a],c=b.length,d=0,e=b[0];d<c;d+=1)if(e=b[d],RGb(QGb(e))){a=e;break}this.q=a}TGb.prototype.name=g("q");iC.prototype.fF=$(87,function(a){jC();if(!iA(this))return"Chart range is invalid";var b=lC(this);b.dj(b.Kh+"&pub=1");b.setOption("width",a.width);b.setOption("height",a.height);a=C$a(b.toJSON());a=Ta(a);return a=E$a(a)});
ZR.prototype.fF=$(86,q(""));function a8(a,b){if(UM)a.q=b,a.getElement()&&(a.getElement().placeholder=a.q);else{a.getElement()&&!iW(a)&&(a.getElement().value="");a.q=b;a.Joa();var c=a.getElement();c&&Pk(c,"label",a.q)}}var UGb;UGb=function(){var a=OGb(NGb(void 0,0)),b=PGb(),c=a-b;return new TGb(SGb[0>c?a+",1":0<c?b+",1,s":a+",0"])};function VGb(a,b){s3a(a,new nJ(b,5,!0),void 0,null)}function b8(a,b){JE.call(this,99);this.J=a;this.K=b}A(b8,JE);b8.prototype.Pd=g("K");
b8.prototype.qd=function(){var a=b8.R.qd.call(this);a.l=this.J;return a};function WGb(a,b){if(b&&b[1]){var c=b[1];a.L=c.p||!1;a.q=c.sa||!1;a.J=c.s||[];a.K=c.da||!1}}function XGb(a){return!a.L||!a.q&&1>a.J.length?null:a.q?-1:a.J[0]}function YGb(a,b,c,d,e,f){this.K=a;this.L=c;this.KD=e;this.q=f;this.J=d}
YGb.prototype.Gh=function(){var a={};a.scope=this.KD;switch(this.KD){case "user":a.uid=this.K;a.email=this.L;a.role=this.q;break;case "anyone":a.role=this.q;break;case "group":a.role=this.q,a.group=this.J}var b={};b.rule=a;return b};var ZGb={"'":"\\'"},$Gb={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"};function aHb(a){Ok(a,"alert");Pk(a,"live","assertive")}function bHb(a){return"Spelling ("+(a+")")}
function cHb(a,b){return"A match was found in hidden cell "+(a+(' with value "'+(b+'".')))}
function dHb(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,h=c+1,k;if(!(k=$Gb[d])){if(!(31<e&&127>e))if(d in ZGb)d=ZGb[d];else if(d in $Gb)d=ZGb[d]=$Gb[d];else{e=d;k=d.charCodeAt(0);if(31<k&&127>k)e=d;else{if(256>k){if(e="\\x",16>k||256<k)e+="0"}else e="\\u",4096>k&&(e+="0");e+=k.toString(16).toUpperCase()}d=ZGb[d]=e}k=d}f[h]=k}b.push('"');return b.join("")};function c8(){return new rV}function d8(){var a=new xS(null);tJ(a);return a};function e8(a){ol.call(this);this.q=a;this.ua=this.P=this.J=this.X=this.K=this.Ba=this.ma=this.ia=this.M=this.L=this.qa=this.ea=null;this.render()}A(e8,ol);s=e8.prototype;
s.Qa=function(){e8.R.Qa.call(this);var a=this.q,b,c,d,e,f,h,k,l,m,n,p;c=a.la();var r=c.ba("tr","waffle-cf-tr-rules",p=c.ba("td"),c.ba("td",null,c.ba("div",{style:"overflow:auto"},k=c.ba("input",{type:"text","class":"waffle-cf-editbox1 jfk-textinput"}),m=c.ba("span","waffle-cf-separator","and"),l=c.ba("input",{type:"text","class":"waffle-cf-editbox2 jfk-textinput"}))),e=c.ba("td","waffle-cf-td-rules",c.ba("span",null,"Text:")),c.ba("td",null,d=c.ba("div","waffle-cf-color-divs")),b=c.ba("td","waffle-cf-td-rules",
c.ba("span",null,"Background:")),c.ba("td",null,f=c.ba("div","waffle-cf-color-divs")),c.ba("td","waffle-cf-td-rules",h=c.ba("span",{"class":"waffle-cf-delete",title:"Remove conditional formatting rule","aria-label":"Remove conditional formatting rule",role:"button"},"x")));sg(h,!0);var t,u=c.ba("tr","waffle-cf-tr-example",c.ba("td","waffle-cf-example",c.createTextNode("\u00a0")),t=c.ba("td",{"class":"waffle-cf-example",colspan:"6"}));n=a.ea.childNodes[0];c.appendChild(n,r);c.appendChild(n,u);c=c8();
dW(c,e.lastChild);sV(c,e);e=c8();dW(e,b.lastChild);sV(e,b);b=d8();b.render(p);p=f8(a);n=new oF;for(u=0;u<p.length;u++)"-----"==p[u].cd?n.Qd(new $E):n.Qd(new XE(p[u].cd,u));b.Zg(n);b.je(0);n=d8();dW(n,l);p=eHb(a);a=new oF;for(u=0;u<p.length;u++)"-----"==p[u].cd?a.Qd(new $E):a.Qd(new XE(p[u].cd,u));n.Zg(a);n.je(0);this.ea=r;this.qa=t;this.L=b;this.M=n;this.ia=k;this.ma=l;this.Ba=m;this.K=c;this.X=d;this.J=e;this.P=f;this.ua=h};
s.Ea=function(){e8.R.Ea.call(this);ih(this.getHandler().Q(this.L,"action",this.Rga).Q(this.M,"action",this.Rga).Q(this.X,"click",this.$Ca).Q(this.P,"click",this.XCa).Q(this.K,"change",this.ZCa).Q(this.J,"change",this.YCa),this.ua,Tk,y(this.VCa,this,this.ua)).Q(LY(this.q),"click",this.WCa)};s.setVisible=function(a){Q(this.ea,a);Q(this.qa.parentNode,a)};s.sg=function(){return Bk(this.ea)};
function fHb(a,b,c){a.L.je(0);a.ia.value="";var d=a.ma;d.value="";var e=a.M;e.je(0);var f=a.K;f.jc(!1);g8(a.X,"#FFFFFF");var h=a.J;h.jc(!1);g8(a.P,"#FFFFFF");if(b&&c){b=b.split(":");for(var k=f8(a.q),l=0,m=0;m<k.length;m++)if(b[0]==k[m].code){l=k[m].type;a.L.je(m);break}if(-1!=l)if(3==l){k=eHb(a.q);l=!0;for(m=0;m<k.length;m++)if(b[1]==k[m].code){e.je(m);l=!1;break}l&&(e.je(e.$h()-1),d.value=gHb(b[1]))}else a.ia.value=gHb(b[1]),null!=b[2]&&(d.value=gHb(b[2]));c=c.split(",");for(m=0;m<Math.min(2,c.length);m++)b=
c[m].split(":"),"f"==b[0]?(f.jc(!0),g8(a.X,b[1])):"b"==b[0]&&(h.jc(!0),g8(a.P,b[1]))}hHb(a)}function iHb(a){if(!a.sg())return null;var b=a.L.ug(),c=f8(a.q)[b],b=c.cd;if(!a.K.Nc()&&!a.J.Nc()||"-----"==b)return null;var b=c.code,b=b+":",d=c.type;if(-1!=d)if(3==d){c=a.M.pe().oa();c=eHb(a.q)[c];if("-----"==c.cd)return null;b=jHb(a)?b+kHb(a.ma.value):b+c.code}else b+=kHb(a.ia.value),2==c.type&&(b=b+":"+kHb(a.ma.value));return b+";"}
function kHb(a){for(var b="",c=0;c<a.length;c++)switch(a.charAt(c)){case ":":b+="\\c";break;case ";":b+="\\s";break;case "\\":b+="\\\\";break;default:b+=a.charAt(c)}return b}function gHb(a){for(var b="",c=0;c<a.length;){if("\\"==a.charAt(c))switch(a.charAt(c+1)){case "c":b+=":";c++;break;case "s":b+=";";c++;break;case "\\":b+="\\";c++;break;default:b+="\\"+a.charAt(c+1),c++}else b+=a.charAt(c);c++}return b}
function hHb(a){var b="none",c="none",d="none",e=!1,f=f8(a.q)[a.L.ug()].type,h="";if(-1!=f)if(3==f)e=!0,jHb(a)&&(c="",h="dd/mm/yyyy");else switch(b="",f){case 2:d=c="";h='e.g. "1983" and "1999"';break;case 1:h='e.g. "100"';break;case 0:h='e.g. "done" or "Jonathan"'}a.ia.style.display=b;a.ma.style.display=c;a.Ba.style.display=d;a.M.setVisible(e);rg(a.qa,h)}function jHb(a){a=a.M;return a.ug()==a.$h()-1}s.Rga=function(){hHb(this)};s.ZCa=function(a){this.K.Nc()&&(lHb(this.q,this.X,this.K),a.stopPropagation())};
s.YCa=function(a){this.J.Nc()&&(lHb(this.q,this.P,this.J),a.stopPropagation())};s.$Ca=function(a){this.K.jc(!0);lHb(this.q,a.target,this.K);a.stopPropagation()};s.XCa=function(a){this.J.jc(!0);lHb(this.q,a.target,this.J);a.stopPropagation()};function g8(a,b){a.style.backgroundColor=b;a.rc=b}s.focus=function(){this.L.Dp(!0)};s.WCa=function(){h8(this.q)};
s.VCa=function(){var a=this.q;h8(a);if(2<a.ea.rows.length){hg(this.ea);hg(this.qa.parentNode);for(var b=a.K,c=0;c<b.length;c++)if(this==b[c]){b.splice(c,1);a.Ga--;a.q.style.display="";this.dispose();break}a.q.focus()}else fHb(this,"","")};s.Y=function(){e8.R.Y.call(this);this.qa=this.ea=this.q=null;H(this.L);this.L=null;H(this.M);this.Ba=this.ma=this.ia=this.M=null;H(this.K);this.X=this.K=null;H(this.J);this.P=this.J=null};function i8(a,b,c,d){Zw.call(this);this.ga=a;this.Aa=a.ib();this.Sa=b;this.ya=c;this.Za=d;this.Ra=f8(this);this.Ha=eHb(this);this.q=this.ea=this.za=null;this.Ga=1;this.K=[];this.P=null;this.kb=new DZ;this.L=new Mk("cond-format-"+xa(this));this.L.wa(!0);this.X=this.Wa=null}A(i8,Zw);var mHb=null;s=i8.prototype;
s.Qa=function(){i8.R.Qa.call(this);var a=this.rb(),b=this.la();$w(this,"Conditional formatting");if(!mHb){var c=new cx;c.set("save","Save rules",!1);c.set("cancel","Cancel",!1,!0);mHb=c}fx(this,mHb);UL(this,"save");this.za=b.ba("div",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},this.ea=b.ba("table",{cellSpacing:"0"},b.ba("tbody")));b.appendChild(a,this.za);nHb(this);c=b.ba("span","menuMainLink waffle-cf-add","+ Add another rule");b.appendChild(a,c);sg(c,!0);Ok(c,"button");this.q=c;
a=this.P=new kV;S4a(new YU(this.L,this.ga.qa,!1,!1,!1,this.Za),a);a.render(this.getElement())};s.focus=function(){i8.R.focus.call(this);this.K[0].focus()};s.Ea=function(){i8.R.Ea.call(this);ih(this.getHandler().Q(this,"dialogselect",this.dQa).Q(this.kb,"action",this.Nna),this.q,Tk,y(this.cQa,this,this.q)).Q(this.P,"hide",this.eQa);this.L.Pa("action",function(a){this.$ma(a);this.Nna()},this)};s.eQa=function(){null!=this.X&&this.X.getElement().focus()};function nHb(a){var b=new e8(a);a.K.push(b)}
function eHb(a){var b=a.Ha;b||(b=[{cd:"today",code:"td"},{cd:"tomorrow",code:"tom"},{cd:"yesterday",code:"yes"},{cd:"-----"},{cd:"in the past week",code:"ipw"},{cd:"in the past month",code:"ipm"},{cd:"in the past year",code:"ipy"},{cd:"-----"},{cd:"exact date..."}],a.Ha=b);return b}
function f8(a){var b=a.Ra;b||(b=[{cd:"Text contains",code:"tc",type:0},{cd:"Text does not contain",code:"ntc",type:0},{cd:"Text is exactly",code:"te",type:0},{cd:"Cell is empty",code:"ce",type:-1},{cd:"-----",type:-1},{cd:"Date is",code:"de",type:3},{cd:"Date is before",code:"deb",type:3},{cd:"Date is after",code:"dea",type:3},{cd:"-----",type:-1},{cd:"greater than",code:"gt",type:1},{cd:"Less than",code:"lt",type:1},{cd:"Is equal to",code:"eq",type:1},{cd:"Is not equal to",code:"neq",type:1},{cd:"Is between",
code:"bw",type:2},{cd:"Is not between",code:"nbw",type:2}],a.Ra=b);return b}function lHb(a,b,c){try{a.$ma(hk(b,"backgroundColor")||"")}catch(d){}VGb(a.P,b);a.Wa=b;a.X=c}function h8(a){a.P.Jl();a.X=null}s.$ma=function(a){this.L.Ua(a)};s.cQa=function(){h8(this);var a=this.Ga;if(10>a){var b=this.K;a<b.length?b[a].setVisible(!0):nHb(this);b=b[a];fHb(b);qk(b.ea,this.za,!0);this.za.scrollLeft=0;this.Ga++;a++;10==a&&Q(this.q,!1)}};s.Nna=function(){var a=this.L.oa()||"#FFFFFF";g8(this.Wa,a);h8(this)};
s.dQa=function(a){if(WC(this.Sa.Aa)&&(h8(this),"save"==a.key)){a="MC";for(var b="MF",c=this.K,d=0;d<c.length;d++){var e=c[d],f=iHb(e);f&&(a+=f,f="",e.J.Nc()&&(f="b:",f+=e.P.rc),e.K.Nc()&&(0<f.length&&(f+=","),f+="f:",f+=e.X.rc),f+=";",b=b+f)}c=YC(this.Aa);this.ya.Yb(new TR(c,this.Sa.Be().Bb(),a,b))}};
s.show=function(){this.setVisible(!0);this.setVisible(!1);var a=YC(this.Aa),b=Zm(a,Ym(a)).getConditionalFormat(),a=this.K,c=a.length,d,e,f=1;b&&(d=b.q.split(";"),e=b.J.split(";"),f=Math.min(Math.min(d.length,e.length),10));for(b=f;b<c;b++)a[b].setVisible(!1);for(b=c;b<f;b++)nHb(this);for(b=0;b<f;b++)c=a[b],c.setVisible(!0),d&&e&&d[b]&&e[b]?fHb(c,d[b],e[b]):fHb(c);this.q.style.display=10==f?"none":"";this.Ga=f;this.setVisible(!0);this.focus()};
s.Y=function(){i8.R.Y.call(this);C(this.K,H);this.ea=this.za=this.K=null;H(this.P);this.X=this.Wa=this.P=null;H(this.kb);this.kb=null;H(this.L);delete this.L;this.Ra=this.Ha=this.Oo=this.ea=this.q=null;delete this.Za};function oHb(a,b,c){return DPa(a||"Oops",b,void 0,void 0,void 0,void 0,c)};function pHb(a,b,c,d,e){var f;sa(c)?(f=new cx,f.set("ok",c.xK,!0),f.set("cancel",c.cancel,!1)):f=hx;return EPa(d||"Heads up!",a,b,null,void 0,void 0,f,e)};function qHb(a){a=a||{};return'<table cellpadding=7><tr><td align=right><label for="'+R(a.UA)+'" id="'+R(a.oS)+'">'+R("Symbol:")+'</label></td><td><input type=text id="'+R(a.UA)+'" aria-labelledBy="'+R(a.oS)+'"/></td></tr><tr><td align=right><label id="'+R(a.bva)+'">'+R("Position:")+'</label></td><td><div role="radiogroup" aria-labelledby="'+R(a.bva)+'"><label for="'+R(a.ava)+'"><input id="'+R(a.ava)+'" checked=checked type=radio value=left name="'+R(a.cva)+'" /> '+R("Left")+'</label><label for="'+
R(a.dva)+'"><input id="'+R(a.dva)+'" type=radio value=right name="'+R(a.cva)+'" /> '+R("Right")+"</label></div></td></tr></table>"};function j8(a){Zw.call(this,void 0,void 0,a)}A(j8,Zw);s=j8.prototype;s.Qa=function(){j8.R.Qa.call(this);var a=this.xa;$w(this,"Add a custom currency");var b=a.Ld(fb(qHb({UA:"cust-curr-symbol",oS:tl(this,"lbl"),bva:tl(this,"plbl"),ava:"cust-curr-left",dva:"cust-curr-right",cva:"cust-curr-position"})));a.appendChild(this.jo,b)};s.Ea=function(){j8.R.Ea.call(this);this.getHandler().Q(this,"dialogselect",this.V1a).Q(Nf("cust-curr-symbol"),["keyup","change"],this.yua);this.yua()};
s.focus=function(){j8.R.focus.call(this);Nf("cust-curr-symbol").focus()};s.yua=function(){var a=Nf("cust-curr-symbol").value;jx(this.J,"ok",!La(a))};s.V1a=function(a){"ok"==a.key&&(a=new L("custom-currency-added"),a.YT=Nf("cust-curr-symbol").value,a.vc=Nf("cust-curr-left").checked,this.dispatchEvent(a))};function rHb(a){a=a||{};var b="",c='<label for="'+R(a.UA)+'" id="'+R(a.oS)+'">'+('Decimal places <span style="color:#999">(0 to '+(R(a.$ua)+(")</span> </label>"+('<input type=text id="'+R(a.UA)+'" aria-labelledBy="'+R(a.oS)+'"/>')))),b=b+("<table cellpadding=7><tr><td align=right>"+c+"</td></tr></table>");a.M3a&&(c="Error: Please enter a number between 0 and "+(R(a.$ua)+"."),b+='<div role="alert" id="'+R(a.qZ)+'" class="waffle-custom-decimals-error-div">'+c+"</div>");return b};function k8(a){Zw.call(this,void 0,void 0,a)}A(k8,Zw);var sHb={zZ:"cust-decim-number",ERROR:"cust-decim-error"};k8.prototype.Qa=function(){k8.R.Qa.call(this);var a=this.xa;$w(this,"Add a customised decimal format");var b=a.Ld(fb(rHb({UA:sHb.zZ,oS:tl(this,"lbl"),$ua:10,qZ:sHb.ERROR,M3a:!0})));a.appendChild(this.jo,b);UL(this,"ok")};k8.prototype.focus=function(){k8.R.focus.call(this);this.xa.Dd("cust-decim-number").focus()};
k8.prototype.Ea=function(){k8.R.Ea.call(this);var a=this.getHandler();gh(a,this,"dialogselect",this.K,!1,this);if(this.q=this.xa.Dd("cust-decim-error"))aHb(this.q),Q(this.q,!1)};k8.prototype.K=function(a){if("ok"==a.key){var b=this.xa.getElement(sHb.zZ).value;La(b)||!Oa(b)||0>Number(b)||10<Number(b)?(a.preventDefault(),this.xa.Dd("cust-decim-number").select(),Q(this.q,!0)):(a=new L("custom-decimal-added"),a.Kq=b,this.dispatchEvent(a))}};function tHb(a,b){if("FORM"==a.tagName)for(var c=a.elements,d=0;a=c[d];d++)tHb(a,b);else!0==b&&a.blur(),a.disabled=b};function l8(){}A(l8,Dl);ja(l8);s=l8.prototype;s.Op=ba();s.Xa=function(a,b){QE(a,!1);VE(a,255);TE(a,32,!1);l8.R.Xa.call(this,a,b);a.setContent(b.value);return b};s.ih=function(a){QE(a,!1);VE(a,255);TE(a,32,!1);return a.la().ba("textarea",{"class":this.Et(a).join(" "),disabled:!a.isEnabled()},a.getContent()||"")};s.LB=function(a){return"TEXTAREA"==a.tagName};s.EZ=ia;s.saa=function(a){return a.isEnabled()};s.Xz=ia;s.DF=function(a,b,c){l8.R.DF.call(this,a,b,c);(a=a.getElement())&&1==b&&(a.disabled=c)};
s.yn=ia;s.setContent=function(a,b){a&&(a.value=b)};s.tb=q("goog-textarea");function m8(a,b,c){PE.call(this,a,b||l8.getInstance(),c);QE(this,!1);BFa(this,!0);this.CL=""!=a;a||this.nF("")}A(m8,PE);var uHb=dd||ed;s=m8.prototype;s.EL=!1;s.K_=!1;s.CL=!1;s.Xb=0;s.Sea=0;s.h2=0;s.Rsa=!1;s.t_=!1;s.Oaa=!1;s.Naa=!1;s.DL="";function vHb(a){return a.J.top+a.J.bottom+a.M.top+a.M.bottom}function wHb(a){var b=a.h2,c=a.getElement();b&&c&&a.t_&&(b-=vHb(a));return b}function xHb(a){var b=a.Sea,c=a.getElement();b&&c&&a.t_&&(b-=vHb(a));return b}s.Ua=function(a){this.setContent(String(a))};
s.oa=function(){return this.getElement().value!=this.DL||yHb(this)||this.CL?this.getElement().value:""};s.setContent=function(a){m8.R.setContent.call(this,a);this.CL=""!=a;this.resize()};s.wa=function(a){m8.R.wa.call(this,a);this.getElement().disabled=!a};s.resize=function(){this.getElement()&&this.RZ()};function yHb(a){a.getElement();return"placeholder"in a.getElement()}
function zHb(a){a.DL&&(yHb(a)?a.getElement().placeholder=a.DL:!a.getElement()||a.CL||a.K_||(yl(a.getElement(),"textarea-placeholder-input"),a.getElement().value=a.DL))}
s.Ea=function(){m8.R.Ea.call(this);var a=this.getElement();ek(a,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"});this.J=Dk(a);this.M=rk(a);this.getHandler().Q(a,"scroll",this.RZ).Q(a,"focus",this.RZ).Q(a,"keyup",this.RZ).Q(a,"mouseup",this.yXa).Q(a,"blur",this.xXa);zHb(this);this.resize()};
function AHb(a){if(!a.Rsa){var b=a.getElement().cloneNode(!1);ek(b,{position:"absolute",height:"auto",top:"-9999px",margin:"0",padding:"1px",border:"1px solid #000",overflow:"hidden"});a.la().wb().body.appendChild(b);var c=b.scrollHeight;b.style.padding="10px";var d=b.scrollHeight;a.Oaa=d>c;b.style.borderWidth="10px";a.Naa=b.scrollHeight>d;b.style.height="100px";100!=b.offsetHeight&&(a.t_=!0);hg(b);a.Rsa=!0}b=a.getElement();isNaN(a.J.top)&&(a.J=Dk(b),a.M=rk(b));var c=a.getElement().scrollHeight,e=
a.getElement(),d=e.offsetHeight-e.clientHeight;if(!a.Oaa)var f=a.J,d=d-(f.top+f.bottom);a.Naa||(e=rk(e),d-=e.top+e.bottom);c=c+(0<d?d:0);a.t_?c-=vHb(a):(a.Oaa||(d=a.J,c+=d.top+d.bottom),a.Naa||(a=rk(b),c+=a.top+a.bottom));return c}function n8(a,b){a.Xb!=b&&(a.Xb=b,a.getElement().style.height=b+"px")}function BHb(a){a=a.getElement();a.style.height="auto";var b=a.value.match(/\n/g)||[];a.rows=b.length+1}s.xXa=function(){yHb(this)||(this.K_=!1,""==this.getElement().value&&(this.CL=!1,zHb(this)))};
s.RZ=function(a){if(!this.EL){var b=this.getElement();!yHb(this)&&a&&"focus"==a.type&&(b.value==this.DL&&this.DL&&!this.K_&&(Al(b,"textarea-placeholder-input"),b.value=""),this.K_=!0,this.CL=""!=b.value);var c=!1;this.EL=!0;a=this.Xb;if(b.scrollHeight){var d=!1,e=!1,f=AHb(this),h=b.offsetHeight,k=wHb(this),l=xHb(this);k&&f<k?(n8(this,k),d=!0):l&&f>l?(n8(this,l),b.style.overflowY="",e=!0):h!=f?n8(this,f):this.Xb||(this.Xb=f);d||e||!uHb||(c=!0)}else BHb(this);this.EL=!1;c&&(b=this.getElement(),this.EL||
(this.EL=!0,(d=b.scrollHeight)?(e=AHb(this),c=wHb(this),f=xHb(this),c&&e<=c||f&&e>=f||(f=this.J,b.style.paddingBottom=f.bottom+1+"px",AHb(this)==e&&(b.style.paddingBottom=f.bottom+d+"px",b.scrollTop=0,d=AHb(this)-d,d>=c?n8(this,d):n8(this,c)),b.style.paddingBottom=f.bottom+"px")):BHb(this),this.EL=!1));a!=this.Xb&&this.dispatchEvent("resize")}};
s.yXa=function(){var a=this.getElement(),b=a.offsetHeight;a.filters&&a.filters.length&&(a=a.filters.item("DXImageTransform.Microsoft.DropShadow"))&&(b-=a.offX);b!=this.Xb&&(this.Xb=this.h2=b)};function CHb(a,b,c){N.call(this);this.ia=a;this.Aa=b;this.Mb=c;this.qa=this.ma=this.Wa=this.Ra=this.ua=this.$=null;this.Jd=new gW;this.zn=new gW;this.Ga=this.za=null;this.vh=new gW;this.Ev=new gW;this.ea=this.X=null;this.Nf=new gW;this.Lv=new gW;this.Ha=this.jd=null;this.q=new m8("");this.oc=this.J=this.Jb=this.Gr=null;this.An=this.pf=!1;this.na=this.qf=this.Yv=this.Yc=this.kb=null;this.Ba=new Op;this.mb=this.vc=this.L=this.sd=this.ud=this.P=this.M=this.K=this.Cb=null;var d=this.ia,e=c=b=null,f=null,
h=null,k=null,l=null,m=null,n=null,p=null,r=null,t=null,u=null,w=null,B=null,z=null,D,E,S,K=null,O=null,Z=null,ca=null,pa=null,qa=null,Ga=null,Ka=null,W=d.la(),Ha=f=null,Eb=null;if(Me){Ha=W.ba("tr",o8.DM,W.ba("td","waffle-dv-label",W.ba("span",{id:"waffle-dv-criteria"},"Criteria:")),W.ba("td",{ddb:"7"},r=W.ba("div","goog-inline-block"),Eb=W.ba("div","goog-inline-block"),n=W.ba("input",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),h=W.ba("input",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),
l=W.ba("input",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),a=W.ba("span","waffle-cf-separator","and"),p=W.ba("input",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),k=W.ba("input",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),m=W.ba("input",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.Nf.Xa(n);this.Lv.Xa(p);this.vh.Xa(h);this.Ev.Xa(k);this.Jd.Xa(l);this.zn.Xa(m);e=d8();dW(e,r);S=d8();dW(S,r);E=d8();dW(E,r);D=d8();dW(D,r);t=
DHb(d,Eb);(z=e.getElement())&&Pk(z,"labelledby","waffle-dv-criteria");f=W.ba("tr",o8.DM,W.ba("td","waffle-dv-label",W.ba("span",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),W.ba("td",{colspan:"7"},W.ba("div",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},W.ba("input",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",role:"radio"}),W.ba("label",{"for":"showWarningOnInvalidData_radio"},"Show warning"),W.ba("input",{type:"radio",
id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),W.ba("label",{"for":"rejectInvalidData_radio"},"Reject input"))));z=new uZ(!0);vZ(z,"onInvalidData",f);var Hb,pc=W.ba("tr",o8.DM+" "+o8.Nza,W.ba("td",null,W.ba("span",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),W.ba("td",{colspan:"7"},Hb=W.ba("span","waffle-dv-label waffle-dv-checkbox-label","Display in-cell button to show list"))),ca=c8();sV(ca,Hb);dW(ca,Hb);ca.wa(!1);if(Z=ca.getElement()){var ac=Qk(Z,"labelledby");
Pk(Z,"labelledby","waffle-dv-appearance "+ac)}pa=W.ba("tr",o8.DM,W.ba("td"),W.ba("td",{colspan:"6","class":"waffle-waffle-dv-show-dropdown"},ac=W.ba("span","waffle-dv-label waffle-dv-checkbox-label","Show help:"),qa=W.ba("input",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),Ga=W.ba("span",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));sg(Ga,!0);Z=c8();sV(Z,ac);dW(Z,ac);var qc=Z.getElement();qc&&(ac=Qk(qc,"labelledby"),Pk(qc,"labelledby",
"waffle-dv-appearance "+ac));d=d.P.childNodes[0];W.appendChild(d,Ha);W.appendChild(d,f);W.appendChild(d,pc);W.appendChild(d,pa);this.q.render(r);W=this.q;W.h2=29;W.resize();W=this.q;W.Sea=200;W.resize();this.q.getElement().style.width="324px";EHb?this.q.getElement().placeholder="Enter items separated by a comma...":Pl(this.q.getElement(),"Enter items separated by a comma...","Enter items separated by a comma...");if(W=this.q.getElement())Sk(W,"Enter items separated by a comma..."),Bf(W,"waffle-dv-list-options-textarea jfk-textinput")}else Ha=
W.ba("tr",null,W.ba("td",null,W.ba("span",null,"Criteria:")),W.ba("td",null),W.ba("td",null,K=W.ba("div","waffle-dv-operators")),W.ba("td",null,b=W.ba("input",{type:"text","class":"waffle-dv-editbox"})),W.ba("td",null,a=W.ba("span","waffle-cf-separator","and")),W.ba("td",null,c=W.ba("input",{type:"text","class":"waffle-dv-editbox"}))),e=d8(),dW(e,K),S=d8(),dW(S,K),E=d8(),dW(E,K),D=d8(),dW(D,K),u=W.ba("tr",null,W.ba("td"),W.ba("td",{colspan:"2","class":"waffle-dv-list-options-1"},W.ba("input",{type:"radio",
id:"listRange_radio",name:"listOp"}),W.ba("label",{"for":"listRange_radio"},"Create list from range"))),r=W.ba("td",{colspan:7}),t=DHb(d,r),u.appendChild(r),w=W.ba("tr",null,W.ba("td"),W.ba("td",{colspan:"2","class":"waffle-dv-list-options-2"},W.ba("input",{type:"radio",id:"listCustom_radio",name:"listOp"}),W.ba("label",{"for":"listCustom_radio"},"Enter list items")),W.ba("td",null,r=W.ba("input",{type:"text","class":"waffle-dv-editbox"}))),f=W.ba("tr",null,W.ba("td",null,W.createTextNode("")),W.ba("td"),
W.ba("td"),Ka=W.ba("td",{colspan:"3","class":"waffle-dv-exampletext"}),W.ba("td"),W.ba("td")),B=W.ba("tr","waffle-cf-tr-rules",W.ba("td",null,W.ba("span",null,"Help text:")),W.ba("td",{colspan:"7"},qa=W.ba("input",{type:"text","class":"waffle-dv-helptext"}),Ga=W.ba("span","menuMainLink waffle-dv-smalltext","Reset"))),pa=W.ba("tr",null,W.ba("td",{colspan:"7","class":"waffle-waffle-dv-show-dropdown"},Hb=W.ba("span","waffle-dv-label","Show list of items in a drop-down menu."))),ca=c8(),sV(ca,Hb),dW(ca,
Hb),pc=W.ba("tr",null,W.ba("td",{colspan:"7","class":"waffle-dv-strictness"},ac=W.ba("span","waffle-dv-label","Allow invalid data, but show warning"))),O=c8(),sV(O,ac),dW(O,ac),d=d.P.childNodes[0],W.appendChild(d,Ha),W.appendChild(d,u),W.appendChild(d,w),W.appendChild(d,f),W.appendChild(d,B),W.appendChild(d,pa),W.appendChild(d,pc),B=new uZ(!0),vZ(B,"listOp",d);this.J=qa;this.vc=Ka;e.setVisible(!0);Ka=e;qa=D;W=S;Ha=E;d=FHb(this);GHb(this,d,Ka);d=HHb(this);GHb(this,d,qa);d=IHb(this);GHb(this,d,W);d=
JHb(this);GHb(this,d,Ha);KHb(this,e,D,S,E,K,b,c,n,p,h,k,l,m,a,u,w,B,r,t,O,pa,ca,Hb,Ga,Z,Eb,z);LHb(this)}A(CHb,N);var EHb="placeholder"in document.createElement("input");(new Jc(9,"tc",10,"ntc",13,"te",14,"tem",15,"tu",16,"de",17,"deb",19,"dob",18,"dea",20,"doa",21,"dbw",22,"ndb",30,"isd",7,"bw",8,"nbw",3,"lt",4,"lte",1,"gt",2,"gte",5,"eq",6,"neq",23,"ofrb",24,"ofc",29,"cf")).HE();
function FHb(a){var b=a.cC;b||(b=Me?[{cd:"List from a range",type:4},{cd:"List of items",type:3},{cd:"Number",type:0},{cd:"Text",type:1},{cd:"Date",type:2}]:[{cd:"Number",type:0},{cd:"Text",type:1},{cd:"Date",type:2},{cd:"Items from a list",type:3}],a.cC=b);return b}
function IHb(a){var b=a.jH;b||(b=Me?"Approved":'"hello"',b=[{cd:"contains",code:"tc",kd:0,Af:b},{cd:"does not contain",code:"ntc",kd:0,Af:b},{cd:"equals",code:"te",kd:0,Af:b},{cd:"is a valid email",code:"tem",kd:-1,Af:null},{cd:"is a valid URL",code:"tu",kd:-1,Af:null}],a.jH=b);return b}
function JHb(a){var b=a.eC;if(!b){var b=Me?"15/11/2014":'"15/11/2014" and "15/11/2015"',c=Me?"15/11/2015":"",d=Me?"15/11/2014":'"15/11/2014"',b=[{cd:"is a valid date",code:"isd",kd:-1,Af:null},{cd:"equal to",code:"de",kd:2,Af:d},{cd:"before",code:"deb",kd:2,Af:d},{cd:"on or before",code:"dob",kd:2,Af:d},{cd:"after",code:"dea",kd:2,Af:d},{cd:"on or after",code:"doa",kd:2,Af:d},{cd:"between",code:"dbw",kd:3,Af:b,EJ:c},{cd:"not between",code:"ndb",kd:3,Af:b,EJ:c}];a.eC=b}return b}
function MHb(a){var b=a.kC;b||(b=Me?[{cd:"range",code:"ofrb",kd:6,Af:null},{cd:"range",code:"ofrbn",kd:6,Af:null},{cd:"the list of items",code:"ofc",kd:5,Af:"Enter items separated by a comma..."},{cd:"the list of items",code:"ofcn",kd:5,Af:"Enter items separated by a comma..."},{cd:"range",code:"ofr",kd:6,Af:null},{cd:"range",code:"ofrn",kd:6,Af:null}]:[{cd:"range",code:"ofrb",kd:4,Af:null},{cd:"range",code:"ofrbn",kd:4,Af:null},{cd:"the list of items",code:"ofc",kd:4,Af:"apple,cat,dog"},{cd:"the list of items",
code:"ofcn",kd:4,Af:"apple,cat,dog"},{cd:"range",code:"ofr",kd:4,Af:null},{cd:"range",code:"ofrn",kd:4,Af:null}],a.kC=b);return b}
function HHb(a){var b=a.fH;if(!b){var b=Me?"10":'"10" and "100"',c=Me?"100":"",d=Me?"10":'"10"',b=[{cd:"between",code:"bw",kd:Me?8:1,Af:b,EJ:c},{cd:"not between",code:"nbw",kd:Me?8:1,Af:b,EJ:c},{cd:"less than",code:"lt",kd:Me?7:0,Af:d},{cd:"less than or equal to",code:"lte",kd:Me?7:0,Af:d},{cd:"greater than",code:"gt",kd:Me?7:0,Af:d},{cd:"greater than or equal to",code:"gte",kd:Me?7:0,Af:d},{cd:"equal to",code:"eq",kd:Me?7:0,Af:d},{cd:"not equal to",code:"neq",kd:Me?7:0,Af:d}];a.fH=b}return b}
function NHb(){return{cd:"",code:"cf",kd:0,Af:"=ISODD(A1)"}}function KHb(a,b,c,d,e,f,h,k,l,m,n,p,r,t,u,w,B,z,D,E,S,K,O,Z,ca,pa,qa,Ga){a.$=b;a.$.setVisible(!0);a.Ra=c;a.ua=e;a.Wa=d;a.Cb=f;a.jd=u;a.K=h;a.M=k;a.X=l;a.ea=m;a.za=n;a.Ga=p;a.ma=r;a.qa=t;a.ud=w;a.sd=B;a.Ha=D;a.L=E;a.Yc=pa;a.Gr=qa;a.mb=S;Me?(pa.jc(!1),tHb(a.J,!0),a.qf=Ga,OHb(a,!1)):(a.mb.jc(!0),a.mb.setVisible(!0),a.P=z,wZ(a.P,"listRange_radio"));a.Jb=K;O.jc(!0);a.kb=O;a.Yv=Z;PHb(a);QHb(a);a.oc=ca}
function RHb(a,b){a.kb.wa(b);Jf(a.Yv,"waffle-dv-label-disabled",!b)}function GHb(a,b,c){for(var d=0;d<b.length;d++){var e=a.ia.la(),e=new XE(b[d].cd,null,e);c.Qd(e);e=e.getElement();Ok(e,"menuitem")}c.je(0)}s=CHb.prototype;s.WO=function(){QHb(this);this.J.value=p8(this);this.dispatchEvent("change")};s.hKa=function(){PHb(this);QHb(this);this.J.value=p8(this);this.dispatchEvent("change")};s.gKa=function(){wZ(this.P,"listCustom_radio");this.J.value=p8(this);SHb(this);this.L.reset()};
s.fka=function(){wZ(this.P,"listRange_radio");this.J.value=p8(this)};
function LHb(a){a.na=new M(a);var b=a.na;b.Q(a.$,"action",a.hKa);b.Q(a.ua,"action",a.WO);b.Q(a.Ra,"action",a.WO);b.Q(a.Wa,"action",a.WO);b.Q(a.J,"focus",function(){this.An=!0});b.Q(a.J,"blur",function(){this.An=!1});b.Q(a.J,"change",a.WT);b.Q(a.J,"keyup",a.WT);Me?(THb(a,[a.za,a.Ga,a.ma,a.qa,a.X,a.ea]),b.Q(a.Yc,"change",y(a.Wea,a)),ih(b,a.oc,Tk,a.gka)):(b.Q(a.P,"action",a.WO),b.Q(a.L.wd(),"change",a.WO),b.Q(a.L.J,"action",a.fka),b.Q(a.L.wd(),"focus",a.fka),b.Q(a.L.wd(),"blur",a.iKa),b.Q(a.Ha,"focus",
a.gKa),THb(a,[a.K,a.M]),b.Q(a.oc,"click",a.gka))}function THb(a,b){for(var c=0;c<b.length;c++)a.na.Q(b[c],"change",y(a.G3a,a,b[c])),a.na.Q(b[c],"keyup",y(a.H3a,a,b[c]))}s.WT=function(a){if(!a||Fj(a))this.pf=!0,this.oc.style.visibility=""};s.gka=function(){this.pf=!1;this.J.value=p8(this)};s.Wea=function(){Me&&tHb(this.J,!this.Yc.L)};s.G3a=function(a){this.J.value=p8(this);var b=q8;r8(this,a)?(this.ia.Vj=b.NONE,s8(a),this.dispatchEvent("change")):(this.ia.Vj=b.cba,t8(a),this.dispatchEvent("error"))};
s.H3a=function(){this.dispatchEvent("keyup")};function r8(a,b){if(0!=u8(a))return!0;var c=b.value;return null!=c&&Bk(b)?!isNaN(db(c)):!0}function SHb(a){var b=UHb(a),c=0==b;a.ia.Vj=b;b=a.Gr&&Bk(a.Gr);Me&&a.Ha&&Bk(a.Ha)?(Jf(a.q.getElement(),"waffle-input-error",!c),a.q.getElement().select()):b&&(b=a.L.getElement().firstChild,Jf(b,"waffle-input-error",!c),a.L.focus());c?a.dispatchEvent("change"):a.dispatchEvent("error")}function t8(a){a.select();Bf(a,"waffle-input-error")}
function s8(a){a&&Gf(a,"waffle-input-error")}function u8(a){return FHb(a)[a.$.ug()].type}function PHb(a){var b=u8(a),c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1;0==b?h=d=!0:2==b?h=c=!0:1==b?h=e=!0:3==b&&Me?l=f=!0:3!=b||Me?Me&&4==b&&(m=f=!0):k=f=!0;a.ua.setVisible(c);a.Ra.setVisible(d);a.Wa.setVisible(e);Me?(Q(a.Ha,l),Q(a.Gr,m),Q(a.X,!1),Q(a.ea,!1),Q(a.za,!1),Q(a.Ga,!1),Q(a.ma,!1),Q(a.qa,!1),l&&a.q.resize()):(Q(a.K,h),Q(a.M,!1),Q(a.Cb,f),Q(a.ud,k),Q(a.sd,k),Q(a.Jb,f));a.dispatchEvent("change")}
function VHb(a){var b;!Me&&Bk(a.Cb)?b=WHb(a):Me&&null!=WHb(a)?b=WHb(a):a.ua.Ka()?b=JHb(a)[a.ua.ug()]:a.Ra.Ka()?b=HHb(a)[a.Ra.ug()]:5==u8(a)?b=NHb():b=IHb(a)[a.Wa.ug()];return b}function WHb(a){var b=MHb(a);if(Me){if(4==u8(a))return XHb(a)?b[0]:b[1];if(3==u8(a))return XHb(a)?b[2]:b[3]}else return a.P.Nc("listRange_radio")?XHb(a)?b[0]:b[1]:XHb(a)?b[2]:b[3];return null}
function QHb(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,n=!1,p=!1,r=!1,t=VHb(a);-1!=t.kd&&(0==t.kd?f=b=!0:1==t.kd?m=h=c=f=b=!0:2==t.kd?k=b=!0:3==t.kd?m=l=c=k=b=!0:7==t.kd?d=!0:8==t.kd?m=e=d=!0:5==t.kd?n=!0:6==t.kd?p=!0:4==t.kd&&(r=!0));t=VHb(a);if(Me)if(3==u8(a))EHb?a.q.getElement().placeholder="Enter items separated by a comma...":Pl(a.q.getElement(),"Enter items separated by a comma...","Enter items separated by a comma...");else{if(t.Af)if(0==t.kd||1==t.kd)a8(a.vh,"e.g. "+t.Af),a8(a.Ev,
"e.g. "+t.EJ||"");else if(2==t.kd||3==t.kd)a8(a.Jd,"e.g. "+t.Af),a8(a.zn,"e.g. "+t.EJ||"");else if(7==t.kd||8==t.kd)a8(a.Nf,"e.g. "+t.Af),a8(a.Lv,"e.g. "+t.EJ||"")}else 3==u8(a)?rg(a.vc,"example: apple,cat,dog"):t.Af?rg(a.vc,"example: "+t.Af):rg(a.vc,"");Me?(s8(a.q.getElement()),s8(a.ma),s8(a.qa),s8(a.X),s8(a.ea),s8(a.za),s8(a.Ga)):(s8(a.K),s8(a.M));s8(a.L.wd());a.ia.Vj=0;a.dispatchEvent("change");Me?(Q(a.X,d),Q(a.ea,e),Q(a.za,f),Q(a.Ga,h),Q(a.ma,k),Q(a.qa,l),Q(a.Ha,n),n&&a.q.resize(),Q(a.Gr,p),RHb(a,
n||p)):(Q(a.K,b),Q(a.M,c),Q(a.ud,r),Q(a.sd,r),Q(a.vc,!0),Q(a.Jb,r));Q(a.jd,m)}function YHb(a){var b=Qa(a.L.oa());!a.Mb.q.J[Qa(Na(b).toLowerCase())]&&ZC(a.Mb,b)&&(b=ECa(a.Mb,b,!0));return b}function ZHb(a){var b=u8(a);return Me?3==b:3==b&&a.P.Nc("listCustom_radio")}function $Hb(a){var b=u8(a);return Me?4==b:3==b&&a.P.Nc("listRange_radio")}
function UHb(a){var b=q8,c=b.NONE;if($Hb(a)){var d=YHb(a);if(ZC(a.Mb,d)){d=aIb(a);a=a.ia;var e=a.q.oa();a=$C(a.X,e);null!=d&&null!=a&&d.Je==a.Je&&d.rect.Iq(a.rect)&&(c=b.v9)}else c=b.sqa}else ZHb(a)&&a.q.getElement()&&Ma(a.q.oa())&&(c=b.rqa);return c}function aIb(a){var b=YHb(a);return $C(a.Mb,b)}s.iKa=function(){this.L.Ua(YHb(this))};function XHb(a){return Bk(a.Jb)&&a.kb.Nc()}
function p8(a){if(a.pf||a.An)return a.J.value;var b="",c=!1,d=!1;Me?(d=u8(a),c=4==d,d=3==d||4==d):c=(d=""==a.Cb.style.display)&&a.P.Nc("listRange_radio");a.ua.Ka()?(d=JHb(a)[a.ua.ug()],b=-1==d.kd?b+"Enter a valid date":b+"Enter a date "):a.Wa.Ka()?(d=IHb(a)[a.Wa.ug()],b="tem"==d.code?b+"Enter a valid email":"tu"==d.code?b+"Enter a valid URL":b+"Enter text that "):d?(d=WHb(a),b+="Click and enter a value from "):5==u8(a)?(d=NHb(),b="Enter a value that satisfies the formula:"):(d=HHb(a)[a.Ra.ug()],b+=
"Enter a number ");-1!=d.kd&&(b+=d.cd);var e=YHb(a);bIb(d.code)&&""!=e&&ZC(a.Mb,e)&&c&&(b+=" "+ECa(a.Mb,e,!0));Me?(Ma(a.za.value)||0!=d.kd&&1!=d.kd?Ma(a.ma.value)||2!=d.kd&&3!=d.kd?Ma(a.X.value)||7!=d.kd&&8!=d.kd||(b+=" "+a.X.value):b+=" "+a.ma.value:b+=" "+a.za.value,Ma(a.Ga.value)||1!=d.kd?Ma(a.qa.value)||3!=d.kd?Ma(a.ea.value)||8!=d.kd||(b+=" and "+a.ea.value):b+=" and "+a.qa.value:b+=" and "+a.Ga.value):(Ma(a.K.value)||0!=d.kd&&2!=d.kd&&1!=d.kd&&3!=d.kd||(b+=" "+a.K.value),Ma(a.M.value)||1!=d.kd&&
3!=d.kd||(b+=" and "+a.M.value));return b}function bIb(a){return"ofrb"==a||"ofrbn"==a||cIb(a)}function cIb(a){return"ofr"==a||"ofrn"==a}function dIb(a){return"ofrbn"==a||"ofcn"==a||"ofrn"==a}function OHb(a,b){Me?wZ(a.qf,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio"):a.mb.jc(!b)}function v8(a,b){var c=Me?2:0,d=Me?3:1,e=Me?4:2,f=Me?1:3;switch(b){case 0:a.$.je(c);break;case 1:a.$.je(d);break;case 2:a.$.je(e);break;case 3:a.$.je(f);break;case 4:a.$.je(0);break;case 5:a.$.je(5)}}
function eIb(a){var b=a.lastIndexOf("</strong>");-1!=b&&(a=Ua(Qa(a.substring(b+9))));return a}s.Y=function(){H(this.na);this.Cb=this.na=null;Me?(this.ea=this.X=this.Ga=this.za=this.qa=this.ma=null,H(this.q),this.q=null):this.Ha=this.M=this.K=null;this.Jb=this.kb=this.mb=this.vc=this.oc=this.J=this.jd=null;H(this.L);this.L=null;H(this.kb);this.kb=null;H(this.mb);this.mb=null;H(this.Wa);this.Wa=null;H(this.Ra);this.Ra=null;H(this.ua);this.ua=null;H(this.$);this.$=null;H(this.P);this.P=null;CHb.R.Y.call(this)};function w8(a,b,c,d,e){Zw.call(this);this.Aa=a;this.ea=b;this.Sa=c;this.ya=d;this.X=e;this.Oo=this.L=this.q=this.na=this.K=this.P=null;this.Oo=new cx;this.Oo.set("save","Save",!1);this.Oo.set("clear","Remove validation",!1,!1);this.Oo.set("cancel","Cancel",!1,!0);fx(this,this.Oo);this.ek(!1);this.aJ();a=this.na=new M(this);a.Q(this,"dialogselect",this.EKa);a.Q(this.K,"error",this.BKa);a.Q(this.K,"change",this.CKa);a.Q(this.K,"keyup",this.DKa)}A(w8,Zw);
var o8={MI:"waffle-dv-table",DM:"waffle-dv-trrules",Nza:"waffle-dv-trrules-appearance",DLa:"waffle-input-error-butter-container",ELa:"waffle-input-error-butter-wrap",nVa:"waffle-input-error"},q8={NONE:0,cba:1,zW:2,sqa:3,v9:4,rqa:5,Vy:6,XL:7};s=w8.prototype;s.Vj=0;
s.aJ=function(){w8.R.aJ.call(this);var a=this.rb(),b=J(a),c=o8;$w(this,"Data validation");if(!this.L){var d=b.ba("div",{"class":c.ELa}),e=b.ba("div",{"class":c.DLa},d);b.appendChild(a,e);this.L=new Kx(e);this.L.Wf("warning");this.L.setContent("");this.L.render(d);xua(this.L,!0);this.L.setVisible(!1)}this.P=b.ba("table",{cellSpacing:"0","class":c.MI},b.ba("tbody"));b.appendChild(a,this.P);a=this.rb();a=J(a);b=a.ba("tr",o8.DM);b.appendChild(a.ba("td","waffle-dv-label",a.ba("label",{id:"waffle-dv-cell-range"},
"Cell range: ")));c=a.ba("td",{colspan:Me?"7":"4"});this.q=DHb(this,c);this.o2();b.appendChild(c);a.appendChild(this.P.childNodes[0],b);(a=this.q.wd())&&Pk(a,"labelledby","waffle-dv-cell-range");this.K=new CHb(this,this.Aa,this.X);UL(this,"save")};s.o2=function(){if(this.q){var a=this.Aa.getActiveGrid();a&&(a=wj(this.Sa.Be().Bb(),a.Xd()),this.q.Ua(a))}};s.BKa=function(){fIb(this)};s.CKa=function(){fIb(this);jx(this.Oo,"save",!0)};
s.DKa=function(){if(!Me){var a=this.Oo,b=this.K;if(0==u8(b))var c=Me?b.ea:b.M,b=r8(b,Me?b.X:b.K)&&r8(b,c);else b=3==u8(b)?0==UHb(b):!0;jx(a,"save",b)}};
s.EKa=function(a){if("save"==a.key){var b;b=this.K;var c=u8(b);if(0==c){var c=Me?b.X:b.K,d=Me?b.ea:b.M,e=r8(b,c),f=r8(b,d);e&&f?b.ia.Vj=0:(e||t8(c),f||t8(d),b.ia.Vj=1)}else Me&&1==c?(c=b.za,d=b.Ga,e=!Bk(c)||!Ma(c.value),f=!Bk(d)||!Ma(d.value),e&&f?b.ia.Vj=0:(e||t8(c),f||t8(d),b.ia.Vj=6)):Me&&2==c?(c=b.ma,d=b.qa,e=!Bk(c)||!Ma(c.value),f=!Bk(d)||!Ma(d.value),e&&f?b.ia.Vj=0:(e||t8(c),f||t8(d),b.ia.Vj=7)):3==c||4==c?SHb(b):b.ia.Vj=0;b=q8;c=this.q.oa();c=ZC(this.X,c);this.Vj==b.zW&&c?this.Vj=b.NONE:this.Vj!=
b.NONE||c||(this.Vj=b.zW);fIb(this);if(0!=this.Vj)b=!1;else{e=this.K;b=Me?e.qf.Nc("rejectInvalidData_radio"):!e.mb.Nc();c=p8(e);Me&&!e.Yc.Nc()&&(c="");var d=u8(e),f="DC",h=VHb(e),f=f+h.code,f=f+":";if(3==d||4==d){d=f;if(ZHb(e)){e=(Me?e.q.oa():e.Ha.value).split(",");f=new vi;for(h=0;h<e.length;h++)e[h]&&(f.append(Qa(e[h])),f.append(","));e=f.toString().replace(/(\\)/g,"\\\\").replace(/:/g,"\\c").replace(/;/g,"\\s").replace(/(\|)/g,"\\p")}else $Hb(e)&&0==UHb(e)?(e=aIb(e),f=wj(e.rect),e=e.Je+":"+f):
e="";f=d+e}else{var k=h=null;Me?0==d?(h=e.X.value,k=e.ea.value):1==d?(h=e.za.value,k=e.Ga.value):2==d&&(h=e.ma.value,k=e.qa.value):(h=e.K.value,k=e.M.value);null!=h&&(f+=h);null!=k&&(f=f+":"+k)}b=gIb(this,f,b,c)}if(!b){a.preventDefault();return}}else{if(b="clear"==a.key)b=gIb(this,"",null,""),b=!b;if(b){a.preventDefault();return}}this.q&&this.q.wa(!1)};
function fIb(a){var b=q8,c=hIb(a.Vj);c&&a.L.setContent(c);a.L.setVisible(a.Vj!=b.NONE);var b=a.Vj==b.zW||a.Vj==b.v9,c=o8,d=a.q.getElement().firstChild;Jf(d,c.nVa,b);b&&a.q.wd().select()}
function hIb(a){var b=q8;switch(a){case b.cba:return"Please enter a valid number";case b.zW:return"Please enter a valid range";case b.sqa:return"Please enter a valid range";case b.v9:return"The selected ranges cannot intersect";case b.rqa:return"Please enter a valid list of items";case b.Vy:return"Please enter valid text";case b.XL:return"Please enter a valid date"}return null}
function gIb(a,b,c,d){var e;e=a.q.oa();e=(e=$C(a.X,e))?e.Je:null;if(null==e)return!1;if(e=a.Aa.ve(e)){e=e.ec();var f;f=a.q.oa();f=(f=$C(a.X,f))?f.rect:null;if(null!=f)return a.ya.Yb(new UR(e,f,b,c,d))}return!1}function DHb(a,b){var c=new bZ(a.Sa,a.getElement(),y(a.ea.xh,a.ea,a),!1,"e.g. Sheet1!A2:D5",!0,a.la());a.getHandler().Q(c,"change",function(){var a=this.K;a&&(a.J.value=p8(a))});c.render(b);return c}
s.show=function(){var a="",b="",c=!1,d=YC(this.Aa),d=Zm(d,Ym(d)),e=d.Wi();e&&(c=e.q,a=c.q,b=Ua(d.Rg()?fma(d.Rg()):""),c=c.X);0==a.indexOf("DC")&&(a=a.substring(2));var d=this.K,f=a;d.$.je(0);d.ua.je(0);d.Ra.je(0);d.Wa.je(0);d.J.value="";Me?(d.X.value="",d.ea.value="",d.ma.value="",d.qa.value="",d.za.value="",d.Ga.value="",d.q.Ua(""),d.L.Ua(""),OHb(d,!1)):(d.K.value="",d.M.value="",d.Cb.selectedIndex=0,wZ(d.P,"listRange_radio"),d.Ha.value="");var h=e=a=d.pf=!1,k=!1,l=!1,m=!1,n=!1,p=!1,r=!1,t=!1,u=
!1,w=!1,B=!1,z=!1,D=!1,E=!1,S=!1,K=!1,O=!1;if(f){var f=f.split("|")[0],f=f.split(":"),Z=MHb(d),ca=JHb(d),pa=HHb(d),qa=IHb(d),Ga=0,Ka=!1;if(Me)for(var W=0;W<Z.length;W++){if(f[0]==Z[W].code){Ga=Z[W].kd;bIb(Z[W].code)?(Ka=!cIb(Z[W].code),v8(d,4),O=!0):(v8(d,3),D=!0);dIb(f[0])?d.kb.jc(!1):d.kb.jc(!0);break}}else for(W=0;W<Z.length;W++)if(f[0]==Z[W].code){Ga=Z[W].kd;d.Cb.selectedIndex=W;v8(d,3);D=u=!0;bIb(Z[W].code)?(wZ(d.P,"listRange_radio"),Ka=!cIb(Z[W].code)):wZ(d.P,"listCustom_radio");dIb(f[0])?d.kb.jc(!1):
d.kb.jc(!0);break}for(W=0;W<ca.length;W++)if(f[0]==ca[W].code){Ga=ca[W].kd;d.ua.je(W);v8(d,2);E=w=!0;break}for(W=0;W<pa.length;W++)if(f[0]==pa[W].code){Ga=pa[W].kd;d.Ra.je(W);v8(d,0);S=B=!0;break}for(W=0;W<qa.length;W++)if(f[0]==qa[W].code){Ga=qa[W].kd;d.Wa.je(W);v8(d,1);K=z=!0;break}if(!(E||K||S||D||O))d.$.je(0),Me?O=!0:B=a=!0;else if(-1!=Ga)if(0==Ga)Me?(d.vh.Ua(f[1]),n=!0):(d.K.value=f[1],a=!0);else if(1==Ga)Me?(r=!0,d.vh.Ua(f[1]),d.Ev.Ua(f[2]),p=n=!0):(d.K.value=f[1],d.M.value=f[2],e=a=r=!0);else if(2==
Ga)Me?(d.Jd.Ua(f[1]),h=!0):(d.K.value=f[1],a=!0);else if(3==Ga)Me?(r=!0,d.Jd.Ua(f[1]),d.zn.Ua(f[2]),k=h=!0):(d.K.value=f[1],d.M.value=f[2],e=a=r=!0);else if(7==Ga)d.Nf.Ua(f[1]),l=!0;else if(8==Ga)r=!0,d.Nf.Ua(f[1]),d.Lv.Ua(f[2]),m=l=!0;else if(5==Ga){var D=!0,Ha=$p(f[1]);","==Ha.charAt(Ha.length-1)&&(Ha=Ha.substring(0,Ha.length-1));d.q.Ua(Ha);d.q.resize()}else 6==Ga?(O=!0,Ka?(E=d.Aa.ve(f[1]))&&(Ha=E.Xd()):Ha=f[1],Ha=sj($p(Ha+"!"+f[2]),d.Aa,!1,!0),null!=Ha&&d.L.Ua(wj(Ha.rect,Ha.q))):4==Ga?(t=!0,E=
3==f.length,d.P.Nc("listRange_radio")&&E?(Ka?(E=d.Aa.ve(f[1]))&&(Ha=E.Xd()):Ha=f[1],Ha=sj($p(Ha+"!"+f[2]),d.Aa,!1,!0),null!=Ha&&d.L.Ua(wj(Ha.rect,Ha.q))):d.P.Nc("listCustom_radio")&&2==f.length&&(Ha=$p(f[1]),","==Ha.charAt(Ha.length-1)&&(Ha=Ha.substring(0,Ha.length-1)),Me?(d.q.Ua(Ha),d.q.resize()):d.Ha.value=Ha)):(d.K.value=f[1],d.M.value=f[2],e=a=r=!0);Q(d.jd,r);d.ua.setVisible(w);d.Ra.setVisible(B);d.Wa.setVisible(z);Me?(Q(d.ma,h),Q(d.qa,k),Q(d.za,n),Q(d.Ga,p),Q(d.X,l),Q(d.ea,m),Q(d.Jb,!0),Q(d.Ha,
D),Q(d.Gr,O),RHb(d,O||D)):(Q(d.K,a),Q(d.M,e),Q(d.Cb,u),Q(d.ud,t),Q(d.sd,t),Q(d.Jb,t))}else KHb(d,d.$,d.Ra,d.Wa,d.ua,d.Cb,d.K,d.M,d.X,d.ea,d.za,d.Ga,d.ma,d.qa,d.jd,d.ud,d.sd,d.P,d.Ha,d.L,d.mb,d.Jb,d.kb,d.Yv,d.oc,d.Yc,d.Gr,d.qf);d.Wea();Ha=b;Me?(Ha=eIb(Ha||""),d.Yc.jc(!!Ha),Ha&&(p8(d)!=Ha&&d.WT(),d.J.value=Ha,tHb(d.J,!1))):(null!=Ha&&""!=Ha&&(Ha=eIb(Ha),p8(d)!=Ha&&d.WT()),d.J.value=Ha||"");OHb(d,c);this.setVisible(!0);this.q&&this.q.wa(!0);this.o2();Ha=this.K;Ha.J.value=p8(Ha);Ha.q.resize()};
s.Y=function(){H(this.K);this.K=null;H(this.q);this.q=null;this.na.dispose();this.Oo=this.P=this.na=null;w8.R.Y.call(this)};function x8(a,b,c,d,e,f){Zw.call(this);this.K=b;this.Aa=a;this.ya=c;this.q=e;this.Sa=f;this.Qa();this.dpa=d;a=d.Da();b=iIb(this,d);1==a||6==a?($w(this,"Publish chart"),this.GE.innerHTML=d.fF(b)):2==a&&($w(this,"Publish Gadget"),this.GE.innerHTML=d.fF(b));Q(this.VX,6==a&&!kC(d))}A(x8,Zw);s=x8.prototype;s.GE=null;s.dpa=null;s.Fba=null;s.VX=null;s.qba=null;s.x9=-1;var jIb=null;s=x8.prototype;
s.Qa=function(){x8.R.Qa.call(this);var a=this.la();this.GE=a.ba("div","dialog-publishobject-div","");this.Fba=a.ba("span","dialog-publishobject-msg","Paste this into any HTML page:");var b=kIb;this.VX=a.ba("div",{style:"display: none;"},"Select a publish format: ",this.qba=a.ba("select",null,a.ba("option",{value:b.S1a},"Interactive chart"),a.ba("option",{value:b.h0},"Image")),a.ba("br"));b=this.rb();a.appendChild(b,this.VX);a.appendChild(b,this.Fba);a.appendChild(b,this.GE);jIb||(a=new cx(a),a.set("done",
"Done",!1,!0),jIb=a);UL(this,"done");fx(this,jIb)};s.Ea=function(){x8.R.Ea.call(this);this.getHandler().Q(this.qba,"change",this.U1a)};s.Y3a=function(a){var b=this.Aa.Ue(),c=XGb(this.q),d=!0;iA(a)&&(d=ob(a.lm,function(a){return a.Je==b}));!d||b!=c&&null!=c||(this.x9=b);return-1==this.x9&&-1!=c&&KY(a)!=b};
s.show=function(){var a=this.x9,b=this.q.K,c=new Qd(this.K+60),d=-1==a;c.Ta("enable","true");c.Ta("auto","true");c.Ta("all",d?"true":"false");d||c.Ta("grids",a);b&&c.Ta("domain","true");a=y(this.gTa,this);Av(this.ya,c.toString(),null,a)};function lIb(a){a=a.GE;a.style.height="auto";var b=yk(a).height;a.style.height=500<b?"500px":"auto"}s.gTa=function(a){(a=eval(a.Ag()))?(WGb(this.q,a),this.setVisible(!0),lIb(this)):(pi("Oops. A server error occurred.",void 0,void 0,void 0),this.setVisible(!1))};
function iIb(a,b){return b.q?pN(a.Sa).Dw():b.Wb}s.U1a=function(a){var b=this.dpa;b.Da();"interactive"==a.target.value?(a=iIb(this,b),b=b.fF(a)):(jC(),b=iA(b)?'&lt;img src="'+E$a(b.Cj())+'" /&gt;':"Chart range is invalid");this.GE.innerHTML=b};s.Y=function(){x8.R.Y.call(this);this.GE=this.Fba=this.VX=this.qba=null};var kIb={S1a:"interactive",h0:"image"};function mIb(a,b){JE.call(this,701,a.vb());this.J=b}A(mIb,JE);mIb.prototype.Pd=g("J");function nIb(a,b,c,d,e,f,h){L.call(this,a);this.J=b;this.ia=c;this.Jb=d;this.Ha=e;this.oc=f;this.mb=h}A(nIb,L);function oIb(a){var b=new vi;b.append("{");var c=a.J;b.append("fv:",null==c||0==c.length?"null":dHb(c),",");b.append("rv:",dHb(a.ia),",");b.append("sas:",a.Jb==bu.qN?"true":"false",",");b.append("mc:",a.Ha?"true":"false",",");b.append("mec:",a.oc?"true":"false",",");b.append("sbr:",a.mb?"true":"false");b.append("}");return b.toString()}
var pIb={I5a:"findnext",Vkb:"findall",K5a:"replace",J5a:"replaceall",DONE:"done",H5a:"canceled"};function qIb(a,b,c,d,e,f){this.q=a;this.Sa=b;this.Aa=c;this.ya=d;this.hg=e;this.ga=f;this.na=new M(this);this.na.Q(a,"replaceall",this.QNa).Q(a,"replace",this.RNa).Q(a,"findnext",this.ela).Q(a,"done",this.PNa);this.J=null}A(qIb,G);var y8={x7:"cg",wX:"cr",vX:"cc",yQa:"loop"};s=qIb.prototype;s.$W=null;s.R3a=function(){this.q.setVisible(!0);rIb(this,null)};
s.ela=function(a){if(WC(this.Sa.Aa)){var b=this.Sa.Be().getModel(),c=this.$W;c||(c=Ym(b),c=Hc(y8.x7,b.vb(),y8.wX,b.getRowIdAt(c.y),y8.vX,b.getColumnIdAt(c.x)));b=$a("[",oIb(a),",",this.Aa.getActiveGrid().ob(),",",qh(c),",",this.ga.Mj,"]");c=new Zd;c.set("v",b);Av(this.ya,"/info/find",c,y(this.S2a,this,a))}};
s.S2a=function(a,b){if(WC(this.Sa.Aa)){var c=oz(b,"Oops. A server error occurred."),d=a.J;if(c)if(c&&null!=c.cg){var d=this.Sa.Be().getModel(),e=this.Aa,f=Jt(d,c[y8.wX],"r"),h=Jt(d,c[y8.vX],"c"),k=Ds(d,f),l=Es(d,h);!k||!l||k.Ka()&&l.Ka()||this.q.kv(cHb(vj(new I(h,f)),d.getCellAt(f,h).getDisplayValue()));c[y8.yQa]&&this.q.kv("No more results found, looping around");rIb(this,c);f=c[y8.x7];d.vb()!=f?Mu(e,e.ke(f).Zb,y(this.Xna,this,c)):this.Xna(c)}else rIb(this,null),this.q.kv("There are no entries matching "+
d);else sIb(this)}};s.Xna=function(a){if(WC(this.Sa.Aa)){var b=this.Sa.Be().getModel(),c=Jt(b,a[y8.wX],"r");a=Jt(b,a[y8.vX],"c");c=new I(a,c);a=Pi(c);Ye?(LH(this.J),this.J=Bz(YD(this.Aa.getActiveGrid()),a).addCallback(y(this.ota,this,c))):(b=this.Aa.getActiveGrid(),Cz(b.Vf,a,y(this.ota,this,c),this.na))}};s.ota=function(a){var b=this.Sa.Be().getModel();a=Cs(b,a);At(b,a);this.q.focus();b.getCellAt(a.y,a.x).hasFormula()&&!this.q.ena()&&this.q.p9(!1,"Can't replace formula")};
function sIb(a){a.q.kv("Error while searching spreadsheet. Please try again.")}s.RNa=function(a){if(!this.hg.vf){var b=this.$W;if(b){var c=this.Aa.ve(b[y8.x7]);if(c){var c=c.ec(),d=Jt(c,b[y8.wX],"r"),b=Jt(c,b[y8.vX],"c"),e=c.getCellAt(d,b);if(!e.hasFormula()||this.q.ena()){var f=!1,e=e.getDisplayValue(),h=null,f=a.Ha?"":"i",h=a.mb?e.replace(RegExp(a.J,f),a.ia):e.replace(RegExp(Xa(a.J),f),a.ia);(f=this.ya.Yb(new Du(c,Qi(d,b),h)))&&null!==h&&this.q.kv('Replaced "'+(e+('" with "'+(h+'"'))));this.ela(a)}}}}};
s.QNa=function(a){if(!this.hg.vf&&WC(this.Sa.Aa)){var b=this.Aa.getActiveGrid().ec();this.ya.Yb(new mIb(b,oIb(a)))?this.q.kv('Replaced all instances of "'+(a.J+('" with "'+(a.ia+'"'))),"Note: Text can't be replaced in formula cells."):sIb(this)}};s.PNa=function(){rIb(this,null)};function rIb(a,b){a.$W=b;var c=a.q;c&&c.p9(null!=b)}s.Y=function(){qIb.R.Y.call(this);this.na.dispose();this.$W=null;LH(this.J)};function tIb(){N.call(this);var a=df(cf(),"imgPath")+"spinner.gif";this.q=Xf('<form method="post" enctype="multipart/form-data" id="file_upload_form"><input name="fupld" type="file"></form>');this.MO=Vf("span",{"class":"waitSpinner"},Vf("img",{src:a,alt:"spinner"}));this.q.appendChild(this.MO);Q(this.MO,!1);this.J=this.q.firstChild;this.ha=new M(this);this.ha.Q(this.J,"change",function(){this.dispatchEvent("inputchange")})}A(tIb,N);
function uIb(a,b){a.J.name="file";a.q.action=b;a.ha.Q(a.K,"ifload",function(){Q(this.MO,!1);this.dispatchEvent("responsereceived")});Q(a.MO,!0);a.q.submit()}tIb.prototype.Y=function(){H(this.K);this.ha.dispose();hg(this.MO);hg(this.J);hg(this.q);tIb.R.Y.call(this)};function vIb(){var a={kE:"Learn more",UJ:"Supported formats: .xls, .xlsx, .ods, .csv, .txt, .tsv, .tab",S7:z8.L7a,V7:z8.vva,T7:z8.M7a,U7:z8.dE},a=a||{};return a=""+('<div class="dlgImport"><div id="optionPane" style="float:left;width:50%;"><div class="dlgImportHeader">Upload file</div><span class="dlgOpenImport2">'+a.UJ+'</span><div id="divUpload" class="uploadBox"></div><div id="divUploadMsgs" class="uploadBox" style="display:none"></div><div id="destinationOptionsHeader" class="dlgImportHeader">Import action</div><div id="destinationOptions" role="radiogroup" aria-labelledby="destinationOptionsHeader"><div><label><input type="radio" name="destination" value="NEW_SPREADSHEET" checked>Create new spreadsheet</label></div><div><label><input type="radio" name="destination" value="NEW_SHEET">Insert new sheet(s)</label></div><div><label><input type="radio" name="destination" value="REPLACE_SPREADSHEET">Replace spreadsheet</label></div><div><label><input type="radio" name="destination" value="REPLACE_SHEET">Replace current sheet</label></div><div><label><input type="radio" name="destination" value="APPEND_SHEET">Append rows to current sheet</label></div><div><label><input type="radio" name="destination" value="REPLACE_DATA">Replace data starting at the selected cell</label></div></div><div id="delimiterOptionsPane"><div class="dlgImportHeader">Separator character</div>'+
nZ({checked:!0,label:"Automatic",name:"delimiter",value:a.S7})+nZ({label:"Tab",name:"delimiter",value:a.V7})+nZ({label:"Comma",name:"delimiter",value:a.T7})+nZ({id:"dlgImportCustomOption",label:"Custom:&nbsp;",name:"delimiter",value:a.U7})+'<input class="jfk-textinput" name="customDelimiter" id="customDelimiter" type="text" style="width:20px" maxlength="1"></div></div><div style="float:right;width:50%;"><div class="dlgImportHeader">Preview</div><div id="previewPane"></div><div id="noPreviewPane" class="dlgImportPreview"><div class="dlgImportPreviewMessage">No file uploaded or preview not supported for this file type</div></div></div><div class="dlgImportClear"></div></div>')}
;var wIb=LC(function(){var a;a={csv:[!0,!0],txt:[!0,!0],tab:[!0,!0],tsv:[!0,!0],ods:[!1,!1],xls:[!1,!1],xlsx:[!1,!1]};oca&&(a.xml=[!1,!1]);return a});function A8(a,b,c){Zw.call(this,void 0,!1,b);this.q=a;this.K=c||new tIb}A(A8,Zw);A8.prototype.Ga=null;A8.prototype.za=null;
var xIb={Vtb:0,e_a:1,d_a:2,c_a:3},B8={Kv:"NEW_SPREADSHEET",wab:"NEW_SHEET",Rra:"REPLACE_SPREADSHEET",d$:"REPLACE_SHEET",b$:"APPEND_SHEET",c$:"REPLACE_DATA"},C8={PIa:"divUpload",OIa:"divUploadMsgs",bYa:"destination",aYa:"delimiter",MIa:"customDelimiter",NIa:"delimiterOptionsPane",RIa:"previewPane",QIa:"noPreviewPane",a$:"badOptionButterPane",Qra:"replaceButterPane",qW:"formatButterPane",cob:"import"},yIb={Pda:"NORMAL",READ_ONLY:"READ_ONLY",M1a:"NON_GRID"},z8={L7a:"",vva:"TAB",M7a:",",dE:"CUSTOM"};
s=A8.prototype;
s.Qa=function(){A8.R.Qa.call(this);$w(this,"Import file");var a=new cx;a.set("import","Import",!1,!1);a.set("cancel","Cancel",!1,!0);fx(this,a);UL(this,"import");var b=this.rb(),c=this.la(),a=c.Ld(fb(vIb()));c.appendChild(b,a);b=b={kE:"Learn more",sP:jca,UJ:"Supported formats: .xls, .xlsx, .ods, .csv, .txt, .tsv, .tab"};b=""+('<span class="dlgImport, dlgImportButterPane"><span id="badOptionButterPane">The selected option is not available for this file format.&nbsp;&nbsp;<a href="'+b.sP+'" target="_blank">'+
b.kE+'</a></span><span id="formatButterPane">This file could not be imported.&nbsp;&nbsp;'+b.UJ+'.&nbsp;&nbsp;<a href="'+b.sP+'" target="_blank">'+b.kE+'</a></span><span id="replaceButterPane">All data currently in this spreadsheet will be replaced.</span></span>');c=c.Ld(b);MY(this).appendChild(c);c=this.L=new uZ(!0);vZ(c,C8.bYa,a);for(var b={},d=c.K,e=0;e<d.length;e++){var f=d[e];b[c.oa(f)]=f}this.Ra=b;this.X=yab(C8.aYa,a)};
s.Ea=function(){A8.R.Ea.call(this);var a=this.la();this.Cs();Q(a.getElement(C8.qW),!1);this.ea=a.getElement(C8.PIa);this.P=a.getElement(C8.OIa);this.kb=a.getElement(C8.NIa);this.Ha=a.getElement(C8.RIa);this.Wa=a.getElement(C8.QIa);this.ea.appendChild(this.K.q);D8(this,0);this.getHandler().Q(this,"dialogselect",this.UIa).Q(this.K,"inputchange",this.SIa).Q(this.X,"action",this.Wja).Q(this.L,"action",this.TIa).Q(a.getElement(C8.MIa),"keyup",this.Wja)};
function zIb(a){var b=wIb(),b=null!=a.K.J.value&&""!=a.K.J.value?AIb(a)in b:!1,c=null!=(xZ(a.L)||null),d=!1;c&&(d=a.Ra[E8(a)],d=a.L.isEnabled(d));gx(a.J,"import").disabled=!(b&&c&&d)}function BIb(a,b){var c=new Qc([B8.b$,B8.c$,B8.d$]);a.mb==yIb.READ_ONLY?(wZ(a.L,a.Ra[B8.Kv]),CIb(a,B8.Kv),nc(B8,function(a){a!=B8.Kv&&this.vua(!1,a)},a)):(a.mb==yIb.M1a&&(b=!1),!b&&c.contains(E8(a))&&(Bk(Mf(C8.qW))||F8(a,C8.a$,!0)),Pc(c,y(a.vua,a,b)),zIb(a))}
s.vua=function(a,b){var c=this.Ra[b];this.L.wa(c,a);Jf(this.L.getElement(c).parentNode,"dlgImportDisabled",!a)};function CIb(a,b){a.q.Ta("dst",b);var c=new Qc([B8.b$,B8.c$,B8.d$]);F8(a,C8.Qra,String(b)==B8.Rra&&!Bk(Mf(C8.qW)));c.contains(b)||(F8(a,C8.a$,!1),zIb(a))}function E8(a){return String(ce(a.q,"dst"))}function DIb(a,b,c,d){c&&hg(c);c=d.apply(a);b.appendChild(c);a=a.K;b=c;H(a.K);a.K=new IY(b,!0);a.q.target=b.name;return c}s.setMode=da("mb");
function EIb(a){var b=zab(a.X);return b==z8.dE?a.la().getElement("customDelimiter").value:b==z8.vva?"\t":b}function FIb(a,b){var c=a.la(),c=c.ba("div","dlgImportError",c.Ld(b));cg(a.P);a.P.appendChild(c);Q(a.P,!0)}s.SIa=function(){D8(this,0);this.dispatchEvent("file-selected")};s.VY=function(){var a=null,b=!0,c;try{var d=eval(GIb(this.za));0==d[0]?(b=!1,a=d[1]):c=d[1]}catch(e){c="Oops. A server error occurred."}b&&FIb(this,c);D8(this,3);this.dispatchEvent(new HIb("import-done",this,a,b))};s.Wja=function(){this.dispatchEvent("option-change")};
s.TIa=function(){this.dispatchEvent("option-change")};function D8(a,b){var c=b==xIb.d_a,d=b==xIb.e_a,e=b==xIb.c_a;d||e||(Q(a.Wa,!c),Q(a.Ha,c),Q(a.kb,c));Q(a.P,e);if(c=gx(a.J,"import"))c.disabled=d}s.dTa=function(){var a=GIb(this.Ga);if(Ea(a.replace(/^[\s\xa0]+/,""),"[")){D8(this,0);try{var b=eval(a);FIb(this,b[1])}catch(c){FIb(this,"Oops. A server error occurred.")}}else D8(this,2)};s.cTa=function(){return IIb("previewFrame",!0,"dlgImportPreview")};s.CSa=function(){return IIb("importFrame",!1)};
function IIb(a,b,c){var d=new vi;d.append("<iframe src=",F?'"#"':'"javascript:void 0;"').append(" name=",a).append(" id=",a);c&&d.append(' class="',c,'"');d.append("></iframe>");a=Xf(d.toString());Q(a,b);return a}function GIb(a){try{return pg(a).body.innerHTML.replace(/&amp;/mg,"&")}catch(b){return""}}function AIb(a){a=a.K.J.value.split(".");return 1==a.length?"":a[a.length-1].toLowerCase()}s.UIa=function(a){"import"==a.key&&(a.preventDefault(),this.dispatchEvent("import"))};
function F8(a,b,c){Q(Mf(b),c);Jf(MY(a),"dlgImportButterPane",Bk(Mf(C8.a$))||Bk(Mf(C8.qW))||Bk(Mf(C8.Qra)))}s.Y=function(){A8.R.Y.call(this);this.K.dispose();this.kb=this.P=this.ea=this.Wa=this.Ha=this.K=null;H(this.L);this.L=null;H(this.X);this.X=null};function HIb(a,b,c,d){L.call(this,a,b);this.Ra=c||null;this.Ga=!!d}A(HIb,L);function JIb(a,b,c,d){this.q=a;this.Zh=c;this.yb=d;this.J=wIb();this.ga=b;c=this.ga.ib();Yz(this.ga)?a.setMode("READ_ONLY"):WC(c)&&!rv(b)?(a.setMode("NORMAL"),c=YC(c),d=Ym(c),b=c.getColumnIdAt(d.x),d=c.getRowIdAt(d.y),c=c.vb(),a.q.Ta("c",b),a.q.Ta("r",d),a.q.Ta("agi",c)):a.setMode("NON_GRID");this.ha=new M(this);this.ha.Q(a,"file-selected",this.SNa).Q(a,"option-change",this.VNa).Q(a,"import",this.UNa).Q(a,"import-done",this.TNa);CIb(a,"NEW_SPREADSHEET");gx(this.q.J,"import").disabled=!0}A(JIb,G);
s=JIb.prototype;s.SNa=function(){var a=this.q;a.q.Ta("del","");var b=this.J[AIb(this.q)];BIb(a,!b||!!b[1]);KIb(this)&&LIb(this)&&MIb(this,y(this.Oma,this))};function KIb(a){var b=AIb(a.q);if(b in a.J)return F8(a.q,"formatButterPane",!1),!0;""!=b&&(F8(a.q,"formatButterPane",!0),F8(a.q,"badOptionButterPane",!1),F8(a.q,"replaceButterPane",!1));gx(a.q.J,"import").disabled=!0;return!1}function LIb(a){a=a.J[AIb(a.q)];return!!a&&!!a[0]}
s.TNa=function(a){if(!a.Ga){var b=this.ga.rf().q;JY(b,!0);JY(b,!1);b=this.q;if((a=a.Ra)&&"NEW_SPREADSHEET"==E8(b)){a=K$a(this.yb,a);var c=b.la();a=c.ba("span",null,"File imported successfully."," ",c.ba("a",{href:a,target:"_blank"},c.ba("b",null,"Open now",c.Ld("&nbsp;&raquo;"))));cg(b.P);b.P.appendChild(a);Q(b.P,!0)}else b.setVisible(!1)}};s.UNa=function(){MIb(this,y(this.Gcb,this))};
s.Gcb=function(a){var b=this.q;KIb(this)&&(b.q.Ta("token",a),D8(b,1),b.za=DIb(b,b.ea,b.za,b.CSa),hh(b.getHandler(),b.K,"responsereceived",b.VY),uIb(b.K,b.q.toString()))};s.VNa=function(){var a=this.q,b=String(ce(a.q,"del"))!=EIb(a),c=E8(a)!=(xZ(a.L)||null);if(b||c)c=new Qc(["APPEND_SHEET","REPLACE_DATA"]),LIb(this)&&KIb(this)&&(c.contains(E8(a))||c.contains(xZ(a.L)||null)||b)?MIb(this,y(this.Oma,this)):NIb(this)};
s.Oma=function(a){var b=this.q;b.q.Ta("token",a);NIb(this);D8(b,1);b.Ga=DIb(b,b.Ha,b.Ga,b.cTa);hh(b.getHandler(),b.K,"responsereceived",b.dTa);Vd(b.q,"convert/preview");uIb(b.K,b.q.toString());Vd(b.q,"convert/import")};function NIb(a){a=a.q;var b=EIb(a);a.q.Ta("del",b);CIb(a,xZ(a.L)||null)}function MIb(a,b){Ex(Cx(a.Zh.Rs("/info/tc")).setContent(""),function(a){b(a.J||"")},a).On()}s.Y=function(){JIb.R.Y.call(this);this.ha.dispose();this.J=null};function OIb(a){a=a||{};return'<div role="radiogroup"><input id="'+R(a.Fla)+'" checked="checked" type="radio" value="horizontal" name="idc-radio-input" aria-labelledBy="'+R(a.Ela)+'"/> <label for="'+R(a.Fla)+'" id="'+R(a.Ela)+'">'+(a.Gla?R("Shift cells right"):R("Shift cells left"))+'</label></br><input id="'+R(a.Ila)+'" type="radio" value="vertical" name="idc-radio-input" aria-labelledBy="'+R(a.Hla)+'"/> <label for="'+R(a.Ila)+'" id="'+R(a.Hla)+'">'+(a.Gla?R("Shift cells down"):R("Shift cells up"))+
"</label></div>"};function G8(a,b,c,d){Zw.call(this,void 0,void 0,d);this.Aa=a;this.ya=b;this.q=c;this.L="";this.K=null}A(G8,Zw);G8.prototype.focus=function(){this.dc()&&this.Ka()&&this.K.getElement(this.L).focus()};
G8.prototype.Qa=function(){G8.R.Qa.call(this);var a=this.la();$w(this,this.q?"Insert cells":"Delete cells");var b=this.L=tl(this,"hr"),c=tl(this,"vr"),d=tl(this,"hl"),e=tl(this,"vl"),b=a.Ld(fb(OIb({Fla:b,Ila:c,Ela:d,Hla:e,Gla:this.q})));this.K=new uZ(!0);vZ(this.K,"idc-radio-input",b);a.appendChild(this.rb(),b);UL(this,"ok");a=this.getHandler();gh(a,this,"dialogselect",this.P,!1,this)};
G8.prototype.P=function(a){if("ok"==a.key){a=this.q?"insert-cell-range":"delete-cell-range";var b=YC(this.Aa),c=this.K.Nc(this.L),d=b.Bb();c?(this.q||(d.left=d.Ab()),d.width=b.getNumColumns()-d.lb()):(this.q||(d.top=d.zb()),d.height=pj(b)-d.fb());var e=b.Bb();this.q&&(c?e.left=e.Ab():e.top=e.zb());e.width=1;e.height=1;a=new Qu(a,this.Aa,b,d,b,e);this.ya.Yb(a)}};function H8(a,b,c){Zw.call(this);this.hg=a;this.kb=b;$w(this,"Find and replace");this.ek(!1);a=this.rb();b=J(a);this.q=b.ba("input",{"class":"jfk-textinput",style:"width: 20em;"});c&&(this.q.value=c);this.K=b.ba("input",{"class":"jfk-textinput",style:"width: 20em;"});c=PIb;this.P=c8();this.X=c8();this.ea=c8();this.L=c8();this.Ra=this.Wa=this.Ga=!1;this.za=b.ba("span");$$a(this.za);this.ha=new M(this);this.Ha=new Mj(this.q);var d=b.ba("label",{"for":c.Cja},"Match case"),e=b.ba("label",{"for":c.Dja},
"Match entire cell contents"),f=b.ba("label",{"for":c.qN},"Search all sheets"),h=null,k=null,l=null;pca&&(h=b.ba("label",{"for":c.Eja},"Search using regular expressions "),k=(new Qd(qca)).toString(),k=b.ba("span",null,b.ba("a",{target:"_blank",href:k},"Help")),l=b.ba("br"),this.ha.Q(k,["keydown","keypress"],function(a){13==a.keyCode&&a.stopPropagation()}));var m=tl(this,"findLabel"),n=tl(this,"replaceLabel");Pk(this.q,"labelledby",m);Pk(this.K,"labelledby",n);k=b.ba("table",null,b.ba("tbody",null,
b.ba("tr",null,b.ba("td",c.Cz,b.ba("label",{id:m},"Find")),b.ba("td",null,this.q)),b.ba("tr",null,b.ba("td",c.Cz,b.ba("label",{id:n},"Replace with")),b.ba("td",null,this.K)),b.ba("tr",null,b.ba("td",null,""),b.ba("td",null,d,b.ba("br"),e,b.ba("br"),f,l,h,k)),b.ba("tr",null,b.ba("td",{colspan:"2"},this.za))));dW(this.X,d);sV(this.X,d);this.X.getElement().id=c.Cja;dW(this.ea,e);sV(this.ea,e);this.ea.getElement().id=c.Dja;dW(this.P,f);sV(this.P,f);this.P.getElement().id=c.qN;this.P.jc(!0);pca&&(dW(this.L,
h),sV(this.L,h),this.L.getElement().id=c.Eja);b.appendChild(a,k);a=new cx;a.set("findNext","Find",!0);a.set("replace","Replace");a.set("replaceAll","Replace all");a.set("done","Done",!1,!0);fx(this,a);UL(this,"");this.ha.Q(this,"dialogselect",this.hIa);this.ha.Q(this.q,"keyup",this.y5);this.ha.Q(this.L,"change",this.gIa);$g(this.Ha,"after_paste",this.y5,void 0,this);a=new cJ;a.Xa(this.q);Ad(this,a);a=new cJ;a.Xa(this.K);Ad(this,a)}A(H8,Zw);H8.prototype.l0a=!0;
var PIb={qN:"find-replace-all",Cz:"waffle-find-replace-dialog-label",Cja:"find-replace-case",Dja:"find-replace-cell",Eja:"find-replace-regex"};s=H8.prototype;s.gIa=function(){this.L.Nc()&&this.X.jc(!0)};s.hIa=function(a){"findNext"==a.key?(a.preventDefault(),this.Ga&&(this.kv(null),QIb(this,pIb.I5a))):"replace"==a.key?(a.preventDefault(),this.Wa&&(this.kv(null),QIb(this,pIb.K5a))):"replaceAll"==a.key?(a.preventDefault(),this.Ra&&(this.kv(null),QIb(this,pIb.J5a))):(this.kv(null),QIb(this,pIb.H5a))};
s.y5=function(){var a=0==this.q.value.length;gx(this.J,"findNext").disabled=a;this.Ga=!a;RIb(this,!a)};function QIb(a,b){a.dispatchEvent(new nIb(b,a.q.value,a.K.value,a.P.Nc()?bu.qN:bu.gNa,a.X.Nc(),a.ea.Nc(),a.L.Nc()))}s.setVisible=function(a){var b=this.hg.vf;RIb(this,!b);this.p9(!b);this.K.disabled=b;H8.R.setVisible.call(this,a)};s.Q3a=function(a){this.q.value=a};s.focus=function(){this.dc()&&this.Ka()&&(this.q.focus(),Fw(this.q,this.q.value.length),this.y5())};
s.p9=function(a,b){var c=this.hg;this.Wa=a=a&&!c.vf;c=gx(this.J,"replace");c.disabled=!a;b?c.title=b:c.removeAttribute("title")};s.ena=Ub;function RIb(a,b){var c=a.hg,d=!!pb(M$a(a.kb),function(a){return!a.Pm()});b=b&&!c.vf&&!d;a.Ra=b;c=gx(a.J,"replaceAll");c.disabled=!b;d&&(c.title="This is disabled because there are protected cells in this spreadsheet.")}
s.kv=function(a,b){var c=J(this.rb()),d=this.za;a?(0<jg(d).length&&c.appendChild(d,c.ba("br")),c.appendChild(d,c.ba("b",null,c.createTextNode(a))),b&&(c.appendChild(d,c.ba("br")),c.appendChild(d,c.ba("span",{style:"color: #666"},c.createTextNode(b))))):c.Hd(d)};s.Y=function(){H8.R.Y.call(this);this.K=this.q=null;H(this.ha);H(this.Ha)};function SIb(a,b,c,d){ol.call(this,d);this.Sa=a;this.X=b;this.Aa=c;this.ha=new M(this);this.M={CellChangeTest:this.rUa,AclChangeTest:this.pUa,FormSubmitTest:this.uUa,BoundedCellChangeTest:this.qUa,SheetChangeTest:this.vUa};this.L={EmailRuleAction:this.tUa,DigestEmailRuleAction:this.sUa};this.J=new M(this);this.ea=df(cf(),"email")}A(SIb,ol);s=SIb.prototype;s.sj=null;
function TIb(a){if(!a.sj){a.sj=new bZ(a.Sa,a.getElement(),y(a.X,a),!1,"cell range",!0,a.la());var b=y(a.sj.Ua,a.sj);a.sj.Ua=y(function(a){b(a);var d=pb(this.getModel().tests,I8("BoundedCellChangeTest"),this);d&&(d.range=a);UIb(this)},a)}}
s.Qa=function(){var a=this.xa,b=null;TIb(this);this.P=b=new fJ("Save",void 0,2);Ad(this,b);var c=new fJ("Cancel");Ad(this,c);this.J.Q(b,"action",this.nTa,!0).Q(c,"action",y(this.dispatchEvent,this,{type:"cancelRuleEdit"}));var d=a.ba("div");b.render(d);c.render(d);a=a.ba("table","waffle-dialog-notifications",a.ba("tbody",null,a.ba("tr",null,a.ba("td",null,b=a.ba("div"))),a.ba("tr",null,a.ba("td",null,d))));this.K=b;this.Ca=a};function VIb(a){a.ha.Kb();a.sj&&a.sj.wa(!1);a.setVisible(!1);a.q=null}
s.setVisible=function(a){this.Ca&&(a?Q(this.Ca,a):P(this.A6a,0,this))};s.A6a=function(){Q(this.Ca,!1)};s.nTa=function(){this.dispatchEvent({type:"saveRule",PJ:this.getModel()})};s.nLa=function(){var a=this.q.sheetField;pb(this.getModel().tests,I8("SheetChangeTest"),this).range=a.pe().oa()};s.lLa=function(){var a=this.q.frequencyDropdown;pb(this.getModel().actions,I8("EmailRuleAction"),this).frequency=a.value};
s.mLa=function(a){a=a.target.value;var b=this.q.BoundedCellChangeTest;b&&b.Nc()&&this.sj&&this.sj.isEnabled()&&((b=sj(a,this.Aa,!0))?0>a.indexOf("!")&&(a=b.q+"!"+a):a="",this.sj.Ua(a))};s.pP=function(a){var b=this.getModel().tests,c=this.q[a],d=pb(b,I8(a),this);d?d.enabled=c.Nc():c.Nc()&&(d=this.M[a].call(this),b.push(d));UIb(this)};function I8(a){return function(b){return null!=b&&b.type==a}}s.rUa=function(){var a=this.getModel();return{type:"CellChangeTest",enabled:!0,localeTz:a.localeTz,localeLc:a.localeLc}};
s.vUa=function(){var a=this.getModel();return{type:"SheetChangeTest",enabled:!0,range:this.q.sheetField.pe().oa(),localeTz:a.localeTz,localeLc:a.localeLc}};s.pUa=function(){var a=this.getModel();return{type:"AclChangeTest",enabled:!0,localeTz:a.localeTz,localeLc:a.localeLc}};s.uUa=function(){var a=this.getModel();return{type:"FormSubmitTest",enabled:!0,localeTz:a.localeTz,localeLc:a.localeLc}};
s.qUa=function(){return{type:"BoundedCellChangeTest",enabled:!0,localeTz:this.getModel().localeTz,localeLc:this.getModel().localeLc,range:""}};s.Qka=function(a){var b=this.getModel().actions,c=this.q[a],d=pb(b,I8(a),this);d?d.enabled=c.Nc():c.Nc()&&(d=this.L[a].call(this),b.push(d));UIb(this)};s.tUa=function(){return{type:"EmailRuleAction",localeTz:this.getModel().localeTz,localeLc:this.getModel().localeLc,enabled:!0,frequency:"HOURLY"}};
s.sUa=function(){return{type:"DigestEmailRuleAction",localeTz:this.getModel().localeTz,localeLc:this.getModel().localeLc,enabled:!0,frequency:"DAILY"}};
function UIb(a){var b=!0;if(a.getModel().enabled){for(var c=!1,d=a.getModel().tests,e=0;e<d.length;e++){var f=d[e];f.enabled&&(c=!0);"BoundedCellChangeTest"==f.type&&(!f.enabled||f.range&&""!=f.range||(b=!1))}c||(b=!1);c=!1;d=a.getModel().actions;for(e=0;e<d.length;e++)d[e].enabled&&(c=!0);c||(b=!1);a.q.sheetField.wa(a.q.SheetChangeTest.Nc());a.sj.wa(a.q.BoundedCellChangeTest.Nc())}a.P.wa(b)}
s.Y=function(){SIb.R.Y.call(this);this.ha&&(this.ha.dispose(),this.ha=null);this.J&&(this.J.dispose(),this.J=null);this.sj&&(this.sj.nd(),this.sj.dispose(),this.sj=null);this.K=this.M=this.L=this.q=null};function J8(a){ol.call(this,a);this.ha=new M(this);this.J=new M(this)}A(J8,ol);J8.prototype.Qa=function(){var a=this.xa,b=a.ba("div"),a=a.ba("table","waffle-dialog-notifications-list",a.ba("tbody",null,a.ba("tr",null,a.ba("td",null,b))));this.q=b;this.Ca=a};function WIb(a){a.ha.Kb();a.xa&&a.q&&a.xa.Hd(a.q)}J8.prototype.setVisible=function(a){this.Ca&&Q(this.Ca,a)};
function XIb(a,b){var c="waffle-notification-rule";b.enabled||(c+="-disabled");var d=a.xa,e=null,f=null,c=d.ba("tr",{valign:"center"},d.ba("td",null,d.ba("span",c,b.gloss)),d.ba("td",{align:"right"},d.ba("table",null,d.ba("tbody",null,d.ba("tr",null,d.ba("td",null,e=d.ba("span","menuMainLink waffle-notifications-add","Edit")),d.ba("td",{width:"50px"},f=d.ba("span","menuMainLink waffle-notifications-add","Delete")))))));a.ha.Q(e,"click",y(a.dispatchEvent,a,{type:"edit",PJ:b}));a.ha.Q(f,"click",y(a.K,
a,b));return c}J8.prototype.K=function(a){confirm("Are you sure that you want to delete this notification rule?")&&this.dispatchEvent({type:"del",PJ:a})};J8.prototype.Y=function(){J8.R.Y.call(this);this.ha&&(this.ha.dispose(),this.ha=null);this.J&&(this.J.dispose(),this.J=null);this.q&&(cg(this.q),this.q=null)};function YIb(a,b,c,d,e){ol.call(this,e);this.ga=a;this.ya=d;this.ha=new M(this);d=new Zw;$w(d,"Set notification rules");d.ek(!1);this.J=d;this.P=!0;this.q=new SIb(b,y(c.xh,c,d),a.ib(),e);this.gb(this.q);this.K=new J8;a=new cx;a.set("cancel","Done",!1,!0);fx(this.J,a)}A(YIb,ol);s=YIb.prototype;
s.Qa=function(){var a=this.xa;this.M=a.ba("div");this.L=a.ba("div");var b=LCa(this.ga,new Qd(gca+"91588")).toString(),b=a.ba("a",{target:"_blank",href:b},"Help"),c=a.ba("span","menuMainLink","+ Add another notification rule"),d=a.ba("table","waffle-dialog-notifications-bounds",a.ba("tbody",null,a.ba("tr",{style:"vertical-align:top;"},a.ba("td",null,this.M)),a.ba("tr",{style:"vertical-align:top;"},a.ba("td",null,this.L))));this.Ca=a.ba("table",null,a.ba("tbody",null,a.ba("tr",null,a.ba("td",null,""),
a.ba("td",{align:"right"},b)),a.ba("tr",null,a.ba("td",{colSpan:"2"},d)),a.ba("tr",null,a.ba("td",{colSpan:"2"},c))));this.X=c;this.gb(this.K);UL(this.J,"");this.ha.Q(this.K,"edit",this.Tga);this.ha.Q(this.K,"del",this.dDa);this.ha.Q(c,"click",this.tga);this.ha.Q(this.q,"saveRule",this.eDa);this.ha.Q(this.q,"cancelRuleEdit",this.Uga);this.ha.Q(this.J,"dialogselect",this.Uga)};
s.mRa=function(a){a=oz(a,"Oops. A server error occurred.");this.Fi(a);0==a.rules.length?(this.P=!0,this.tga()):(this.P=!1,ZIb(this,a))};s.eDa=function(a){VIb(this.q);this.q.setVisible(!1);a=qh(a.PJ);var b=this.ya,c=y(this.L6,this),d=new Zd;d.add("v",a);Av(b,"/notifications/set",d,c)};s.Uga=function(a){"dialogselect"==a.type&&a.key!=this.J.J.VR||P(this.u0a,0,this)};
s.u0a=function(){VIb(this.q);this.q.setVisible(!1);if(0==this.getModel().rules.length&&this.P)this.J.setVisible(!1);else{var a=y(this.L6,this);rx(this.ya,"/notifications/list",void 0,a)}};s.L6=function(a){a=oz(a,"Oops. A server error occurred.");ZIb(this,a)};
function ZIb(a,b){a.Fi(b);if(b){var c=a.K;c.dc()||c.render(a.M);WIb(c);c.Fi(b);var d=null,e=c.xa,f=e.ba("table",{className:"waffle-dialog-notifications-list",width:"100%"},d=e.ba("tbody")),h=b.rules;if(0==h.length)e.appendChild(d,e.ba("tr",null,e.ba("td",{align:"center"},"No notification rules currently defined")));else for(var k=0;k<h.length;k++)e.appendChild(d,XIb(c,b.rules[k]));e.appendChild(c.q,f)}$Ib(a,!0)}
s.Tga=function(a){$Ib(this,!1);WIb(this.K);var b=this.q;a=a.PJ;b.dc()||b.render(this.L);b.Fi(a);a=b.xa;b.sj.Qa();b.sj.getElement().id="range";cg(b.K);for(var c=b.xa,d=c.ba("select"),e=[["HOURLY","Hourly"],["EVERY6HOURS","Every 6 hours"],["DAILY","Daily"],["WEEKLY","Weekly"]],f=e.length,h=0;h<f;h++){var k=e[h],k=c.ba("option",{value:k[0]},k[1]);c.appendChild(d,k)}h=a.ba("td","waffle-dialog-notifications-input",e=a.ba("label",null,"Any changes are made"));c=c8();sV(c,e);dW(c,e);k=a.ba("td","waffle-dialog-notifications-input",
f=a.ba("label",null,"Anything on this sheet is changed:"),a.ba("span",null,a.createTextNode("\u00a0")));e=c8();sV(e,f);dW(e,f);for(var f=d8(),l=b.Aa,m=XC(l),l=xv(l)||0,n=0;n<m.length;n++){var p=m[n].Xd();f.Qd(new XE(p))}l<f.$h()&&f.je(l);f.render(k);var r=a.ba("td","waffle-dialog-notifications-input",l=a.ba("label",null,"Any of these cells are changed:"),a.ba("span",null,a.createTextNode("\u00a0")),b.sj.getElement()),m=c8();sV(m,l);dW(m,l);var t=a.ba("td","waffle-dialog-notifications-input",n=a.ba("label",
null,"Collaborators are added or removed")),l=c8();sV(l,n);dW(l,n);var u=a.ba("td","waffle-dialog-notifications-input",n=a.ba("label",null,"A user submits a form")),p=c8();sV(p,n);dW(p,n);var w,B=a.ba("td","waffle-dialog-notifications-input",w=a.ba("label",null,"Email - daily digest")),n=c8();sV(n,w);dW(n,w);var z,D=a.ba("td","waffle-dialog-notifications-input",z=a.ba("label",null,"Email - straight away"));w=c8();sV(w,z);dW(w,z);h=a.ba("table","waffle-dialog-notifications",a.ba("tbody",null,a.ba("tr",
{id:"toprow"},a.ba("td","waffle-dialog-notifications-toplabel",a.ba("span",{"for":"emailon"},"Notify me at "+(b.ea+" when...")))),a.ba("tr",null,h),a.ba("tr",null,k),a.ba("tr",null,r),a.ba("tr",null,t),a.ba("tr",null,u),a.ba("tr",null,a.ba("td",null,a.ba("div",{style:"padding: 5px"}))),a.ba("tr",null,a.ba("td","waffle-dialog-notifications-label",a.ba("span",{},"Notify me with..."))),a.ba("tr",null,B),a.ba("tr",null,D)));b.q={sheetField:f,CellChangeTest:c,AclChangeTest:l,FormSubmitTest:p,BoundedCellChangeTest:m,
SheetChangeTest:e,EmailRuleAction:w,DigestEmailRuleAction:n};k=b.ha;k.Q(b.sj.getElement(),"change",b.mLa);k.Q(c,"change",y(b.pP,b,"CellChangeTest"));k.Q(l,"change",y(b.pP,b,"AclChangeTest"));k.Q(p,"change",y(b.pP,b,"FormSubmitTest"));k.Q(e,"change",y(b.pP,b,"SheetChangeTest"));k.Q(m,"change",y(b.pP,b,"BoundedCellChangeTest"));k.Q(f,"change",b.nLa);k.Q(w,"change",y(b.Qka,b,"EmailRuleAction"));k.Q(n,"change",y(b.Qka,b,"DigestEmailRuleAction"));k.Q(d,"change",b.lLa);t=b.getModel().tests;for(k=0;k<t.length;k++)u=
t[k],r=u.type,"BoundedCellChangeTest"==r?(m.jc(u.enabled),b.sj.Ua(u.range||"")):"SheetChangeTest"==r?(e.jc(u.enabled),f.Ua(u.range||"")):"CellChangeTest"==r?c.jc(u.enabled):"AclChangeTest"==r?l.jc(u.enabled):"FormSubmitTest"==r&&p.jc(u.enabled);c=b.getModel().actions;for(k=0;k<c.length;k++)e=c[k],r=e.type,"EmailRuleAction"==r?(w.jc(e.enabled),d.value=e.frequency,d.disabled=!e.enabled):"DigestEmailRuleAction"==r&&n.jc(e.enabled);a.appendChild(b.K,h);b.sj.Ea();UIb(b);b.setVisible(!0)};
s.dDa=function(a){this.K.setVisible(!1);a=qh(a.PJ);var b=this.ya,c=y(this.L6,this),d=new Zd;d.add("v",a);Av(b,"/notifications/delete",d,c)};function $Ib(a,b){a.K.setVisible(b);var c=MY(a.J);Q(c,b);Q(a.X,b)}s.tga=function(){$Ib(this,!1);var a=y(this.v6a,this);rx(this.ya,"/notifications/create",void 0,a)};s.v6a=function(a){a=oz(a,"Oops. A server error occurred.");this.Tga({PJ:a})};
s.show=function(){var a=this.J;this.render(a.rb());this.q.setVisible(!1);$Ib(this,!1);var b=y(this.mRa,this);rx(this.ya,"/notifications/list",void 0,b);a.setVisible(!0)};s.Y=function(){YIb.R.Y.call(this);this.ha&&(this.ha.dispose(),this.ha=null);this.J&&(this.J.setVisible(!1),this.J.dispose(),this.J=null);this.K&&(this.K.dispose(),this.K=null);this.q&&(this.q.dispose(),this.q=null);this.M&&(cg(this.M),this.M=null);this.L&&(cg(this.L),this.L=null);this.X=this.ya=null};function K8(a,b,c,d,e,f,h,k){Zw.call(this,void 0,void 0,k);this.X=a;this.ya=b;this.yb=c;this.Aa=d;this.ah=f;new lD;this.Ha=h;this.Yy=e;this.za=!0;this.Ga=!1;this.q={};this.L=new uZ(!0,this.la());this.K=new uZ(!0,this.la());this.P=new uZ(!0,this.la());this.ea=null;a=new cx;ix(a,{key:"ok",caption:"Print"},!0);ix(a,kx,!1,!0);fx(this,a)}A(K8,Zw);var aJb={ibb:"print-repeat-row-headers",mub:"print-omit-gridlines",wob:"print-include-title",vob:"print-include-sheet-names",uob:"print-include-page-numbers"};
s=K8.prototype;
s.cI=function(){if(!this.Ud()){var a=this.X,b=this.L;b.Nc("print-active-sheet")?a.jp=0:b.Nc("print-all-sheets")?a.jp=1:a.jp=2;this.P.Nc("print-fit")?a.DI=0:a.DI=1;b=!!this.K.Nc("print-landscape");a.qD=b;b=this.q["print-repeat-row-headers"].Nc();a.aO=b;b=this.q["print-omit-gridlines"].Nc();a.ZN=b;b=this.q["print-include-title"].Nc();a.YN=b;b=this.q["print-include-sheet-names"].Nc();a.XN=b;b=this.q["print-include-page-numbers"].Nc()?"CENTER":"UNDEFINED";a.$N=b;b=this.ea.pe().getModel();a.cH=b;bJb(this);
cJb(this)}};
function dJb(a){var b=a.X,c=a.L;0==b.jp?wZ(c,"print-active-sheet"):1==b.jp?wZ(c,"print-all-sheets"):wZ(c,"print-selection");wZ(a.P,0==b.DI?"print-fit":"print-actual-size");wZ(a.K,b.qD?"print-landscape":"print-portrait");a.q["print-repeat-row-headers"].jc(!!b.aO);a.q["print-omit-gridlines"].jc(!!b.ZN);a.q["print-include-title"].jc(!!b.YN);a.q["print-include-sheet-names"].jc(!!b.XN);a.q["print-include-page-numbers"].jc("UNDEFINED"!=b.$N);var d=a.ea;d.Gb().Ch(function(a){a.getModel()==b.cH&&AJ(d,a)});
bJb(a);F&&(a.rb().style.display="",Qg(a.getElement().offsetHeight),a.rb().style.display="block",Qg(a.getElement().offsetHeight))}
s.FKa=function(a){if("ok"==a.key){this.cI();this.za=!1;var b=this.X;a=this.Ga&&O$a();var b=aW(this.ya,b.cH,b.aO,!b.qD,0==b.DI,0==b.jp,2==b.jp,b.ZN,b.YN,b.XN,b.$N,a),c;c=b.Ge();for(var d=[],e=0;e<c.length;e++)d.push(c[e]+"="+b.get(c[e]));c=d.join(",");a=y(this.yb.CI,this.yb,12,"&"+b.toString(),void 0,a);this.Ga&&this.Yy?(this.Ha(!1),b=this.Yy,J$a(b.J,b.L,I$a(b),c?"id="+b.q+","+c:b.q,a)):(this.Ha(!0),a())}};
function bJb(a){eJb(a.P,"print-fit");eJb(a.P,"print-actual-size");eJb(a.K,"print-landscape");eJb(a.K,"print-portrait")}function eJb(a,b){Jf(a.getElement(b).parentNode,"print-radio-checked",a.Nc(b))}function cJb(a){var b=a.X,c=a.ya;a=y(a.N4a,a);rx(c,"/info/print",aW(c,b.cH,b.aO,!b.qD,0==b.DI,0==b.jp,2==b.jp,b.ZN,b.YN,b.XN,b.$N),a)}s.N4a=function(a){a=eval("("+a.Ag()+")").info;null!=a&&this.Ka()&&!this.Ud()&&fJb(this,a)};
function fJb(a,b){var c=a.la(),d=c.getElement("print-fit-caption"),e=c.getElement("print-actual-size-caption"),f=c.getElement("print-landscape-caption"),c=c.getElement("print-portrait-caption");gJb(b.hb0,d);gJb(b.hb1,e);gJb(b.ww0,f);gJb(b.ww1,c);a.za&&(a.X.qD=!b.port,wZ(a.K,a.X.qD?"print-landscape":"print-portrait"))}function gJb(a,b){cg(b);a&&(b.innerHTML=a)}
s.Ea=function(){K8.R.Ea.call(this);UL(this,"ok");var a=this.rb(),b;b="";var c='<div id="print-warning">'+R("Sheets with full page charts and gadgets won't be printed. You can print all other sheets in your spreadsheet.")+'</div><hr class="print-divider"/><table width="100%" role="presentation"><tr><td width="50%" valign="center" class="print-options-container"><div class="waffle-dialog-header">'+R("Options")+"</div>",d;d=""+('<div role="radiogroup" aria-label="'+R("What to print")+'"><input type="radio" name="whatPartsGroup" id="print-active-sheet"/><label for="print-active-sheet">'+
R("Current sheet")+'</label><br/><input type="radio" name="whatPartsGroup" id="print-all-sheets"/><label for="print-all-sheets">'+R("All sheets")+'</label><br/><input type="radio" name="whatPartsGroup" id="print-selection"/><label for="print-selection">'+R("Selection")+"</label></div><br/>");c=c+d+'<div class="waffle-dialog-header"><label for="print-paper-size">Paper size</label></div>'+('<div id="print-paper-size" class="jfk-select goog-flat-menu-button">'+R('Letter (8.5" x 11")')+"</div>")+'</td><td width="50%" valign="center" class="print-options-container">';
d=""+('<div role="group" aria-label="'+R("Print options")+'"><span id="print-repeat-row-headers" class="jfk-checkbox"></span><label for="print-repeat-row-headers">'+R("Repeat row headers on each page")+'</label><br/><span id="print-omit-gridlines" class="jfk-checkbox"></span><label for="print-omit-gridlines">'+R("No gridlines")+'</label><br/><span id="print-include-title" class="jfk-checkbox"></span><label for="print-include-title">'+R("Include document title")+'</label><br/><span id="print-include-sheet-names" class="jfk-checkbox"></span><label for="print-include-sheet-names">'+
R("Include sheet names")+'</label><br/><span id="print-include-page-numbers" class="jfk-checkbox"></span><label for="print-include-page-numbers">'+R("Include page numbers")+"</label></div><br/>");c=c+d+'</td></tr></table><hr class="print-divider"/><div class="waffle-dialog-header">Layout</div>';d='<table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr>'+('<td role="radiogroup" aria-label="'+R("Layout")+'"><table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr><td valign="top" align="center" class="print-layout-container"><input type="radio" name="print-layout-size" id="print-fit" /><br/><label for="print-fit">'+
R("Fit to width")+'<br/><div class="print-fit-icon">&nbsp;</div><div class="print-layout-caption" id="print-fit-caption"></div></label></td><td class="print-layout-divider"></td><td valign="top" align="center" class="print-layout-container"><input type="radio" name="print-layout-size"id="print-actual-size" /><br/><label for="print-actual-size">'+R("Actual size")+'<br/><div class="print-actual-size-icon">&nbsp;</div><div class="print-layout-caption" id="print-actual-size-caption"></div></label></td><td class="print-layout-divider-2"></td></tr></table></td>');
d+='<td role="radiogroup" aria-label="'+R("Orientation")+'"><table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr><td class="print-layout-divider-3"></td><td valign="top" align="center" class="print-layout-container"><input type="radio" name="print-layout-orientation" id="print-portrait" /><br/><label for="print-portrait">'+R("Portrait")+'<br/><div class="print-portrait-icon">&nbsp;</div><div class="print-layout-caption" id="print-portrait-caption"></div></label></td><td class="print-layout-divider"></td><td valign="top" align="center" class="print-layout-container"><input type="radio" name="print-layout-orientation" id="print-landscape" /><br/><label for="print-landscape">'+
R("Landscape")+'<br/><div class="print-landscape-icon">&nbsp;</div><div class="print-layout-caption" id="print-landscape-caption"></div></label></td></tr></table></td></tr></table>';b=b+(c+d);a.innerHTML=b;Bf(this.getElement(),"print-dialog");b=this.la();H(this.L);this.L=new uZ(!0,this.la());vZ(this.L,"whatPartsGroup",a);H(this.K);this.K=new uZ(!0,this.la());vZ(this.K,"print-layout-orientation",a);H(this.P);this.P=new uZ(!0,this.la());vZ(this.P,"print-layout-size",a);for(var e in aJb)c=aJb[e],H(this.q[c]),
a=this.q[c]=new rV,c=b.getElement(c),a.Xa(c),sV(a,c.nextSibling);H(this.ea);e=this.ea=d8();e.Xa(b.getElement("print-paper-size"));L8(this,"0",'Letter (8.5" x 11")',"Letter (8.5 inches x 11 inches)");L8(this,"33",'Tabloid (11" x 17")',"Tabloid (11 inches x 17 inches)");L8(this,"2",'Legal (8.5" x 14")',"Legal (8.5 inches x 14 inches)");L8(this,"32",'Statement (5.5" x 8.5")',"Statement (5.5 inches x 8.5 inches)");L8(this,"30",'Executive (7.25" x 10.5")',"Executive (7.25 inches x 10.5 inches)");L8(this,
"31",'Folio (8.5" x 13")',"Folio (8.5 inches x 13 inches)");L8(this,"6","A3 (297 mm x 420 mm)");L8(this,"7","A4 (210 mm x 297 mm)");L8(this,"8","A5 (148mm x 210mm)");L8(this,"18","B4 (250mm x 353mm)");L8(this,"19","B5 (176mm x 250mm)");this.getHandler().Q(e,"action",this.cI).Q(this.L,"action",this.HKa).Q(this.K,"action",this.GKa).Q(this.P,"action",this.cI).Q(this,"afterhide",this.cI).Q(this,"dialogselect",this.FKa)};function L8(a,b,c,d){a.ea&&(b=new XE(c,b),a.ea.Qd(b),a=b.rb(),d&&a&&Sk(a,d))}
s.GKa=function(){this.za=!1;this.cI()};s.HKa=function(){var a=this.q["print-repeat-row-headers"],b=this.X;this.L.Nc("print-selection")&&a.Nc()?(a.jc(!1),b.q=!0):this.X.q&&(a.jc(!0),b.q=!1);this.cI()};
s.show=function(a){this.Ga=a;$w(this,a?"Print settings":"Export to PDF");this.J.set("ok",a?"Print":"Export",!0);this.setVisible(!0);var b=this.la();a=this.Aa;var b=b.getElement("print-warning"),c;t:{c=a.Vd;for(var d=0;d<c.length;d++)if(1==c[d].Te()){c=!0;break t}c=!1}Q(b,c);if($V(a)){this.X.jp=1;var e=this.L,f;for(f in e.q)e.wa(f,!1)}else for(e in f=this.L,f.q)f.wa(e,!0);dJb(this);cJb(this)};
s.Y=function(){for(var a in this.q)H(this.q[a]);this.ea.dispose();this.P.dispose();this.K.dispose();this.L.dispose();K8.R.Y.call(this)};function M8(a,b){Zw.call(this);var c=df(cf(),"userDashDom");this.Cb=c||"";this.ea=null!=c&&0<c.length;this.ya=b;this.Aa=a;this.na=new M(this)}A(M8,Zw);
var N8={lua:"pub-dialog-wrap",Vy:"pub-dialog-txt",Bja:"pub-dialog-content-div",Cz:"pub-dialog-checkbox-label",RPa:"pub-dialog-url-box",PPa:"pub-dialog-helpertext",p1a:"pub-dialog-hr",q1a:"pub-dialog-hr-div",wO:"pub-dialog-input",oJ:"pub-dialog-input-div",KYa:"pub-dialog-date-label",QPa:"pub-dialog-search-infotext-span",LYa:"pub-dialog-stjw-infotext-span"},O8={r9:"html",GX:"emb",q9:"csv",apa:"xls",Yoa:"ods",$oa:"txt",Zoa:"pdf",B7:"atom",HX:"rss"};s=M8.prototype;s.R9=!1;s.tX=!1;s.Daa=null;s.xX=null;
s.cW=null;s.Aa=null;s.sX=!1;s.gJ=null;s.QI=!1;s.hJ=null;s.Oi=null;s.Fc=null;s.R7="";s.Q7="";s.SK=!0;s.uD=null;s.Zu=null;s.Nma=null;s.vA=null;s.pQ=!1;s.e8=!0;s.Cma="";s.Qa=function(){M8.R.Qa.call(this);var a=this.la();$w(this,"Publish to the web");var b=new cx(a);ix(b,{key:"ok",caption:"Close"},!0,!0);fx(this,b);this.kb=a.ba("div",{id:"wrap","class":N8.lua},hJb(this,a),a.ba("div",N8.q1a,a.ba("hr",N8.p1a)),iJb(this,a));a.appendChild(this.rb(),this.kb);this.R9=!0;jJb(this,this.uD.pe().oa());kJb(this)};
function hJb(a,b){if(!a.Daa){a.Ra=b.ba("div",N8.oJ);a.uD=d8();a.uD.render(a.Ra);lJb(a,a.uD);a.P=b.ba("div",N8.oJ);a.X=b.ba("label",{"for":"autoRepub","class":N8.Cz},"Automatically republish when changes are made");a.P.appendChild(a.X);a.gJ=c8();a.na.Q(a.gJ,"action",a.MYa);dW(a.gJ,a.X);sV(a.gJ,a.X);a.gJ.getElement().id="autoRepub";a.ea&&(a.Ga=b.ba("label",{"for":"revreq","class":N8.Cz},"Requires viewers to sign in with their "+(a.Cb+" account.")),a.P.appendChild(b.ba("br")),a.P.appendChild(a.Ga),a.hJ=
c8(),a.na.Q(a.hJ,"action",a.NYa),dW(a.hJ,a.Ga),sV(a.hJ,a.Ga),a.hJ.getElement().id="revreq");a.QI=!1;a.cW=new fJ(mJb(!1));a.na.Q(a.cW,"action",y(a.osa,a,{C$:!0}));a.L=new fJ("Republish now");a.L.wa(!1);a.na.Q(a.L,"action",y(a.osa,a,{enable:!0,C$:!0}));a.za=b.ba("span",N8.KYa);var c=b.ba("span",{id:"stjw_infotext","class":N8.LYa},Xf("<b> Note: </b> Publishing a doc does not affect its visibility option.\u00a0"),b.ba("a",{href:"https://docs.google.com/support/bin/answer.py?answer=183965",target:"_blank"},
"Learn more")),d=b.ba("span",null,"\u00a0\u00a0");a.Daa=b.ba("div",{id:"top"},b.ba("p",N8.Vy,"Sheets to publish"),b.ba("div",{id:"topContent","class":N8.Bja},a.Ra,a.P,d,a.za,b.ba("br"),b.ba("br"),c));dW(a.cW,d);dW(a.L,a.za)}return a.Daa}
function iJb(a,b){if(!a.xX){a.Ha=b.ba("div",N8.oJ);a.q=d8();a.q.wa(!1);a.q.render(a.Ha);lJb(a,a.q);a.na.Q(a.q,"action",y(a.Gma,a,null));a.Oi=b.ba("input",{id:"range",type:"textbox",value:"All cells",disabled:"true","class":N8.wO+" jfk-textinput"});a.na.Q(a.Oi,"click",y(a.Gna,a,!0));a.na.Q(a.Oi,"blur",y(a.Gna,a,!1));a.Fc=new Ow(a.Oi);a.na.Q(a.Fc,"input",y(a.QX,a));a.Jb=b.ba("div",N8.oJ,a.Oi);a.vA=b.ba("div",N8.oJ);a.mb=b.ba("div",N8.oJ);a.Zu=d8();a.Zu.wa(!1);a.Zu.render(a.mb);a.na.Q(a.Zu,"action",
a.Kka);a.K=b.ba("textarea",{id:"linkBox",rows:"4",cols:"40","class":N8.RPa+" jfk-textinput",disabled:"true"});a.Wa=b.ba("span",N8.PPa,nJb(!1));var c=hca?b.ba("span",{id:"search_infotext","class":N8.QPa},"Published documents may appear in public search results.\u00a0",b.ba("a",{href:"http://docs.google.com/support/bin/answer.py?hl=en&answer=37579",target:"_blank"},"Learn more")):"";a.xX=b.ba("div",{id:"bottom"},b.ba("p",N8.Vy,"Get a link to the published data"),b.ba("div",{id:"bottomContent","class":N8.Bja},
a.mb,a.Ha,a.vA,a.Jb,a.K,b.ba("br"),a.Wa),c)}return a.xX}
s.osa=function(a){var b=null!=a&&null!=a.enable?a.enable:!this.tX,c=null!=a&&null!=a.sheet?a.sheet:this.uD.pe().oa(),d=-1==c?"All sheets":this.Aa.ke(c).Xd();if(!this.ea||null==a||null==a.C$||!a.C$||confirm(b?this.tX?"Re-publish "+(d+"?"):"Let anyone at "+(this.Cb+(" see "+(d+"?"))):"Stop publishing this document?")){a=null!=a&&null!=a.w2a?a.w2a:this.sX;var d=this.QI,e=-1==c,f=new Zd;f.add("enable",b);f.add("auto",a);f.add("all",e);e||f.add("grids",c);d&&f.add("domain",!0);Av(this.ya,"/publish/settings",
f,y(this.x2a,this))}};s.x2a=function(a){oz(a,"Oops. A server error occurred.");kJb(this)};function kJb(a){rx(a.ya,"/publish/settings",void 0,y(a.x6a,a))}
s.x6a=function(a){var b=oz(a,"Oops. A server error occurred.");if(null!=b){a=b.p;var c=b.da||!1;this.R7=b.u;this.Q7=b.du||"";this.tX=a;this.L.wa(a);this.q.wa(a);this.Oi.disabled=!a;this.Zu.wa(a);this.K.disabled=!a;var d=this.hJ;d&&(d.wa(!c||b.al),d.jc(c));this.QI=b.da;d=a?!!b.a:!0;this.gJ.jc(d);this.sX=d;this.za.innerHTML=a?"Published on "+(b.d+"\n"):"";this.K.value=a?oJb(c?this.Q7:this.R7).toString():"";b.r&&(this.Cma=b.r);this.cW.setContent(mJb(a));if(a){b=pJb(this,b.sa||1>b.s.length?-1:b.s[0]);
null==b&&(b=pJb(this,-1));AJ(this.uD,b);jJb(this,b.oa());c=b.oa();this.la();if(this.tX){if(this.Nma!=c){for(d=this.q;0<d.Gb().$h();)d.QJ(0);-1!=c?(this.q.Qd(new XE(this.getSheet,c)),this.q.je(0)):lJb(this,this.q)}this.Kka()}this.Nma=b.oa()}this.Wa.innerHTML=nJb(a)}};s.NYa=function(){this.QI=!this.QI};s.MYa=function(){this.sX=!this.sX};function lJb(a,b){b.Qd(new XE("All sheets",-1));for(var c=a.Aa.Vd,d=0;d<c.length;d++){var e=c[d];b.Qd(new XE(e.Xd(),e.ob()))}b.je(0)}
function jJb(a,b){a.la();var c=a.Zu;if(null!=c)for(;0<c.Gb().$h();)c.QJ(0);c.Qd(new XE("Web page",O8.r9));c.Qd(new XE("HTML to embed in a page",O8.GX));c.Qd(new XE("CSV (comma-separated values)",O8.q9));c.Qd(new XE("TXT (Plain text)",O8.$oa));c.Qd(new XE("PDF (Adobe PDF)",O8.Zoa));a.ea||(c.Qd(new XE("ATOM",O8.B7)),c.Qd(new XE("RSS",O8.HX)));-1==b&&(c.Qd(new XE("XLS (Microsoft Excel)",O8.apa)),c.Qd(new XE("ODS (Open Document Spreadsheet)",O8.Yoa)));c.je(0)}
function pJb(a,b){if(a.R9)for(var c=a.uD.Vg,d=0;d<c.$h();d++)if(c.Od(d).oa()==b)return c.Od(d);return null}s.Gma=function(a){this.R9&&this.SK&&(a=-1==(a||this.q.pe().oa()),this.Oi.disabled=a,this.Oi.value=a?"All cells":this.Oi.value);this.QX()};s.Gna=function(a){if(!this.Oi.disabled){var b=this.Oi.value;this.Oi.value=b==(a?"All cells":"")?a?"":"All cells":b}};
s.QX=function(){var a=oJb(this.QI?this.Q7:this.R7),b=this.Zu.pe().oa(),c=!this.Oi.disabled&&"All cells"!=this.Oi.value&&""!=this.Oi.value;b==O8.B7||b==O8.HX?(a=this.Zu.pe().oa(),b=this.Cma,this.pQ&&!this.e8&&(b=b.replace(/list/,"cells")),b=new Qd(b),c&&this.pQ&&b.Ta("range",this.Oi.value),a==O8.HX&&b.Ta("alt","rss"),this.K.value=b.toString()):(this.q.isEnabled()&&-1!=this.q.pe().oa()&&(a.Ta("single","true"),a.Ta("gid",this.q.pe().oa())),c&&a.Ta("range",this.Oi.value),this.Zu.isEnabled()&&(b==O8.GX?
(a.Ta("output","html"),a.Ta("widget","true")):a.Ta("output",b)),this.K.value=b==O8.GX?"<iframe width='500' height='300' frameborder='0' src='"+a.toString()+"'></iframe>":a.toString())};function oJb(a){a=new Qd(a);ce(a,"authkey")&&DV(a,"authkey");return a}
s.Kka=function(){var a=!1,b=!1,c=!1;switch(this.Zu.pe().oa()){case O8.B7:case O8.HX:a=!0;b=this.e8;this.SK=!1;c=!0;break;case O8.GX:case O8.r9:b=a=!1;this.SK=!0;break;case O8.$oa:case O8.q9:this.SK=b=a=!1;break;case O8.Zoa:a=!1;b=!0;this.SK=!1;break;case O8.Yoa:case O8.apa:b=a=!0,this.SK=!1}this.q.wa(!a);a=c;c=this.la();a?this.pQ||(this.vA.appendChild(c.ba("input",{type:"radio",name:"feedRadio",id:"listFeed",value:"List",checked:"true"})),this.vA.appendChild(c.ba("label",{"for":"listFeed","class":N8.Cz},
"List")),this.vA.appendChild(c.ba("input",{type:"radio",name:"feedRadio",id:"cellFeed",value:"Cells"})),this.vA.appendChild(c.ba("label",{"for":"cellFeed","class":N8.Cz},"Cells")),this.na.Q(this.vA,"change",this.mTa)):this.pQ&&c.Hd(this.vA);this.pQ=a;this.Oi.disabled=b;this.Oi.value=b?"All cells":this.Oi.value;b||this.Gma(null);this.QX()};s.mTa=function(){var a=this.la().getElement("listFeed").checked;this.Oi.disabled=a;this.Oi.value=a?"All cells":this.Oi.value;this.e8=a;this.QX()};
function mJb(a){return a?"Stop publishing":"Start publishing"}function nJb(a){return a?"Copy and paste the link above":"Start publishing to get the link"}s.Y=function(){M8.R.Y.call(this);this.kb=this.xX=null;this.Fc.dispose();this.Fc=null;this.na.dispose();this.na=null};function qJb(a){a=a||{};return a=""+('<label for="'+R(a.UA)+'">Enter a new sheet name:</label><br/><input type=text id="'+R(a.UA)+'" value="'+R(a.gVa)+'" class="waffle-rename-sheet-input jfk-textinput" maxlength='+R(a.hVa)+' aria-required="true" aria-describedby="'+R(a.qZ)+'"/><br/><div id="'+R(a.qZ)+'" class="waffle-rename-sheet-error-div" role="alert"></div></div>')};function P8(a,b,c){Zw.call(this,void 0,void 0,c);this.q=a;this.P={};for(a=0;a<b.length;a++)a!=this.q.Zb&&(c=b[a].Xd(),c=Qa(c.toLowerCase()),this.P[c]=!0)}A(P8,Zw);var rJb={wO:"rename-sheet-input",ERROR:"rename-sheet-error"};P8.prototype.Qa=function(){P8.R.Qa.call(this);var a=this.xa;$w(this,"Rename sheet");var b=a.Ld(fb(qJb({UA:rJb.wO,gVa:this.q.Xd(),qZ:rJb.ERROR,hVa:50})));a.appendChild(this.jo,b);UL(this,"ok");a=this.getHandler();gh(a,this,"dialogselect",this.X,!1,this)};
P8.prototype.focus=function(){P8.R.focus.call(this);this.L.focus()};P8.prototype.Ea=function(){P8.R.Ea.call(this);this.K=this.xa.getElement("rename-sheet-error");Q(this.K,!1);this.L=this.xa.getElement("rename-sheet-input");(new cJ).Xa(this.L)};
P8.prototype.X=function(a){var b=this.L.value;if("ok"==a.key&&b!=this.q.Xd()){var c="";if(0==b.length)c="Your sheet name cannot be empty.";else{var d=Qa(b.toLowerCase());this.P[d]&&(c="Your sheet name cannot duplicate other sheet names.")}c?(a.preventDefault(),cg(this.K),this.K.innerHTML="<br/>"+c,Q(this.K,!0)):(a=new L("sheet-renamed"),a.sheet=this.q,a.name=b,this.dispatchEvent(a))}};function sJb(a){var b;b="";a=a.uqa;var c;c=c={id:"waffle-resize-input",Jh:"waffle-resize-inset-input"};c=fm('<input class="jfk-textinput'+(c.Jh?" "+om(c.Jh):"")+'"'+(c.id?'id="'+om(c.id)+'"':"")+(c.maxLength?'maxlength="'+om(c.maxLength)+'"':"")+(c.jda&&c.Ueb?'label="'+om(c.jda)+'"':"")+(c.name?'name="'+om(c.name)+'"':"")+(c.jda?'placeholder="'+om(c.jda)+'"':"")+'type="text"'+(c.value?'value="'+om(c.value)+'"':"")+(c.dir?'dir="'+om(c.dir)+'"':"")+">");return b=b+(tJb({id:"waffle-resize-selection-custom",
ixa:a,ye:"<br />"+c})+tJb({id:"waffle-resize-selection-auto",ixa:"Fit to data",ye:""}))}function tJb(a){return'<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+R(a.id)+'"><label for="'+R(a.id)+'"" class="waffle-resize-label" >'+R(a.ixa)+"</label>"+pm(a.ye)+"</div>"}function uJb(a){a=a||{};return'<label for="waffle-resize-input" >'+R(a.uqa)+'</label><br /></br /><input id="waffle-resize-input" />'};function Q8(a,b,c){Zw.call(this);this.ka=a;this.ya=b;this.q=this.ka.Bb();this.q.Vc();this.K=new gW;this.L=new uZ(!0);this.Sa=c}A(Q8,Zw);var R8={Gda:"waffle-resize-selection-auto",dE:"waffle-resize-selection-custom",wO:"waffle-resize-input",LLa:"waffle-resize-selection"};s=Q8.prototype;
s.Qa=function(){Q8.R.Qa.call(this);var a;var b=this.q;if(b.isRow()){a=b.fb();var b=b.zb()-1,c=String(mj(a)),d=String(mj(b));a=a==b?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else a=b.lb(),b=b.Ab()-1,c=lj(a),a=a==b?"Resize column "+c:"Resize columns "+(c+(" - "+lj(b)));$w(this,a);a="r"==this.q.Vc()?uJb:sJb;this.setContent(a({uqa:this.q.isRow()?"Enter new row height in pixels. (Default: 17)":"Enter new column width in pixels. (Default: 120)"}));UL(this,"ok")};
s.Ea=function(){Q8.R.Ea.call(this);var a=this.la();this.K.Xa(a.getElement(R8.wO));var a=this.ka.Bb(),b=a.Vc(),a=nt(this.ka,b,a.Hf(b)).Fh();this.K.Ua(String(a));"c"==this.q.Vc()&&(vZ(this.L,R8.LLa),wZ(this.L,R8.dE));this.getHandler().Q(this,"dialogselect",this.MLa).Q(this.K.getElement(),"focus",this.NLa)};s.NLa=function(){"c"==this.q.Vc()&&wZ(this.L,R8.dE)};s.focus=function(){this.dc()&&this.K.Ss()};
s.MLa=function(a){if("ok"==a.key)if("r"==this.q.Vc()||Cab(this.L)==R8.dE){a=this.q;var b=this.K.oa(),b=parseInt(b,10);if(isNaN(b))pi("Entered value is not a number.",void 0,void 0,void 0);else{var c=(a.isRow(),2);b<c||2E3<b?pi("Size must be between "+(c+" and 2000 pixels."),void 0,void 0,void 0):this.ya.Yb(new JO(this.ka,a,b))}}else a=this.q,this.ya.Yb(new GO(this.ka,a.lb(),a.Ab()))};function S8(a,b,c){Zw.call(this);this.ya=a;this.Zh=b;this.ga=c;this.q={};this.P=this.K=!1;this.L="";$w(this,"Spreadsheet settings");this.q[0]=d8();this.q[1]=d8()}A(S8,Zw);var vJb=null,wJb={IK:0,bXa:1,Nfb:2};s=S8.prototype;
s.Qa=function(){S8.R.Qa.call(this);var a=this.rb(),b=this.la(),c=[xJb(b,"Locale:"),yJb(this,b,'This affects formatting defaults, such as currency.<br><br>To change the display language, go to <a id="ds-settings-link" target="_blank">Drive Settings</a>.',0,!0),xJb(b,"Time Zone:"),yJb(this,b,"Your spreadsheet's history will be recorded in this time zone. This will change all time-related functions.",1)],c=b.ba("table","dialog-settings",b.ba("tbody",null,c));b.appendChild(a,c);vJb||(a=new cx(b),a.set("save",
"Save settings",!0),a.set("cancel","Cancel",!1,!0),vJb=a);fx(this,vJb);UL(this,"save")};function xJb(a,b){return a.ba("tr",null,a.ba("td","dialog-settings-label",b))}function yJb(a,b,c,d,e){b=b.ba("tr",null,b.ba("td","dialog-settings-input"),b.ba("td","dialog-settings-text",e?Xf(c):c));a.q[d].render(b.firstChild);return b}s.Ea=function(){S8.R.Ea.call(this);$g(this,"dialogselect",y(this.z4a,this))};
s.setVisible=function(a){if(a){if(!this.K){zJb(this);return}var b=this.ga.L,c=this.q[0];c&&c.Ua(b.q);b=b.K||UGb().name();(c=this.q[1])&&c.Ua(b)}S8.R.setVisible.call(this,a);if(this.K&&!this.P){if(a=Nf("ds-settings-link"))a.href=this.L;this.P=!0}};function zJb(a){Ex(a.Zh.Rs("/info/settings"),y(function(a){(a=a.vp())&&a.l&&a.tz&&(AJb(this,0,a.l),AJb(this,1,a.tz),this.L=a.dls,this.K=!0);this.setVisible(!0)},a)).On()}
function AJb(a,b,c){a=a.q[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];a.Qd(new XE(e[1],e[0]))}a.Gb().getElement().style.overflow="auto";tJ(a)}s.z4a=function(a){if("save"==a.key){var b=this.q;a=b[wJb.IK].pe().oa();b=b[wJb.bXa].pe().oa();this.ya.Yb(new b8(a,b))}};s.Y=function(){nc(this.q,H);delete this.q;S8.R.Y.call(this)};function T8(a){Zw.call(this,void 0,!0,a);this.q=new uZ(!0);this.K=[]}A(T8,Zw);s=T8.prototype;s.$X="";s.Wma="";s.Vma="";s.Xma="";s.Yma="";
s.Qa=function(){T8.R.Qa.call(this);var a=y(this.la().ba,this.la());this.xd={};$w(this,this.$X);var b=a("table",{role:"presentation"},a("thead",{id:"waffle-protection-dialog-header-id"},a("tr",null,a("th",{colspan:2,align:"left"},this.la().Ld(this.Wma)))),a("tbody",{role:"radiogroup","aria-labelledby":"waffle-protection-dialog-header-id"},a("tr",null,a("td",null,a("input",{type:"radio",name:"waffle-protection-prot-rad",id:"waffle-protection-dialog-anyone"},null)),a("td",null,a("label",{"for":"waffle-protection-dialog-anyone"},
this.la().Ld(this.Vma)))),a("tr",null,a("td",null,a("input",{type:"radio",name:"waffle-protection-prot-rad",id:"waffle-protection-dialog-me"},null)),a("td",null,a("label",{"for":"waffle-protection-dialog-me"},this.la().Ld(this.Xma)))),a("tr",null,a("td",null,a("input",{type:"radio",name:"waffle-protection-prot-rad",id:"waffle-protection-dialog-some"},null)),a("td",null,a("label",{"for":"waffle-protection-dialog-some"},this.la().Ld(this.Yma)))))),a=a("table",{className:"waffle-protection-dialog-table",
style:"width: 390px;",role:"presentation"},a("tbody",null,a("tr",null,a("td",{colspan:2},b)),a("tr",null,a("td",{colSpan:"2",style:"border: 1px solid #999;"},a("div",{style:"height: 240px; overflow-y: auto; overflow-x: hidden;"},this.P=a("table",{cellPadding:"0",cellSpacing:"0",style:"width: 100%; padding: 0;"},a("tbody")),a("div",{style:"text-align: center; padding: 1em 0;"},""),a("div"))))));this.la().appendChild(this.rb(),a);vZ(this.q,"waffle-protection-prot-rad",b);b=new cx;b.set("save","Done",
!0,!1);UL(this,"save");fx(this,b)};s.Ea=function(){T8.R.Ea.call(this);BJb(this);this.getHandler().Q(this.q,"change",this.DTa).Q(this,"dialogselect",this.X)};s.DTa=function(){var a=this.L.q,b=!1;this.q.Nc("waffle-protection-dialog-anyone")?a.q=0:this.q.Nc("waffle-protection-dialog-me")?a.q=1:this.q.Nc("waffle-protection-dialog-some")&&(a.q=2,b=!0);this.wa(b)};s.W0a=function(){CJb(this);BJb(this)};
s.wa=function(a){Jf(this.P,"disabled",!a);for(var b=this.K,c=0;c<b.length;c++){var d=b[c];d.Cq&&d.Cq.wa(a)}this.L8=a};function CJb(a){for(var b=a.L.q,c=b.J,d=a.K,e=a.P.firstChild,f=0;f<c.length;f++){var h=d[f];h?h.q=b:(h=new DJb(a.L.q,a.la()),h.render(e),d[f]=h);EJb(h,c[f])}for(f=c.length;f<d.length;f++)d[f].dispose(),d[f]=null;d.length=c.length;b=b.q;a.wa(0!=f&&2==b)}
s.show=function(){var a=this.ya,b=this.L.ob(),c=y(this.ea,this),d=new Zd;d.add("sheetId",b);rx(a,"/protections/get",d,c);this.setVisible(!0);CJb(this);LY(this).focus()};function BJb(a){switch(a.L.q.q){case 0:wZ(a.q,"waffle-protection-dialog-anyone");break;case 1:wZ(a.q,"waffle-protection-dialog-me");break;case 2:wZ(a.q,"waffle-protection-dialog-some")}}
s.jNa=function(a){a=a.Ag();(a=ph(a))&&null!=a.success||pi("There was an error when trying to save your rules. Please try again.",void 0,void 0,void 0);this.setVisible(!1)};s.Y=function(){T8.R.Y.call(this);C(this.K,H);this.K=null};function DJb(a,b){ol.call(this,b);this.ha=new M(this);this.J=this.K=null;this.q=a}A(DJb,ol);s=DJb.prototype;s.zr=Ub;s.Cq=null;
s.Qa=function(){var a=this.xa,b=a.ba("tr","waffle-protection-dialog-row",a.ba("td",null,a.ba("div")),a=a.ba("td","waffle-protection-dialog-checkbox","\u00a0"));this.Cq=c8();this.Cq.render(a);this.Ca=b};s.Ea=function(){this.ha.Q(this.Cq,"change",this.E2a)};s.nd=function(){this.ha.Kb()};s.E2a=function(){for(var a=this.K,b=this.J,c=this.Nc(),d=this.q.J,e=0;e<d.length;e++){var f=d[e];if(f.K&&f.K==a||f.J&&f.J==b)f.q=c?3:2}};
function EJb(a,b){var c=a.getElement().cells,d=b.L||b.J;c[0].firstChild.innerHTML=d;Sk(a.Cq.Ca,d);a.K=b.K;a.J=b.J;a.Cq&&a.Cq.jc(3==b.q)}s.Nc=function(){return this.Cq?this.Cq.Nc():!1};s.Y=function(){DJb.R.Y.call(this);H(this.Cq);this.q=this.Cq=null};function U8(a,b,c,d){T8.call(this,d);this.L=a.ib().we();this.$X="Protect sheet";this.Vma="Anyone invited as a collaborator <b>(no protection)</b>";this.Wma="Who is allowed to edit this sheet?";this.Xma="Only me";this.Yma="Me and the collaborators selected below:";this.ga=a;this.yb=b;this.ya=c}A(U8,T8);U8.prototype.Ea=function(){U8.R.Ea.call(this);var a=this.getHandler();gh(a,this.L,"protection_model_updated",this.W0a,!1,this)};U8.prototype.show=function(){U8.R.show.call(this)};
U8.prototype.ea=function(a){if(!a.KN&&!a.JN&&0<a.rI)pi("There was a problem fetching the Protection rules. Please try again.",void 0,void 0,void 0),this.setVisible(!1);else{var b=this.ga,c=a.iv();if(c){a=new Uta;a.J=[];a.q=0;for(var d=c.sheetProtection,e=!1,f=c.sheetAclEntries,h=0;h<f.length;h++){var k=f[h].rule;if(!k.isMe){var l=k.role;a.J.push(new YGb(k.uid,0,k.email,k.group,k.scope,l));e||(e=3==l)}}a.q=d?e?2:1:0;b=b.ib().ke(c.sheetId);b.q=a;b.dispatchEvent("protection_model_updated")}}};
U8.prototype.X=function(){var a=this.L.q,b={sheetProtection:!0,sheetAclEntries:[]};switch(a.q){case 0:b.sheetProtection=!1;b.sheetAclEntries=[];break;case 2:b.sheetProtection=!0;for(var c=[],a=a.J,d=0,e=a.length;d<e;d++)c.push(a[d].Gh());b.sheetAclEntries=c}b.sheetId=this.ga.ib().Ue();b=qh(b);c=this.ya;a=y(this.jNa,this);d=new Zd;d.add("modelChanges",b);Av(c,"/protections/set",d,a)};function V8(a,b,c,d){JE.call(this,1201,a.vb());this.J={};for(var e=0;x(this.J[e+"gid"]);)e++;Gc(this.J,Cha(String(d.Je),d.rect,e));this.ka=a;this.K=b;this.L=c}A(V8,JE);V8.prototype.Pd=g("L");V8.prototype.qd=function(){var a=V8.R.qd.call(this);a.scol=this.K.x+1;a.srow=this.K.y+1;Gc(a,this.J);return a};function W8(a,b,c){this.LJ=a;this.dP=b;this.bA=c}A(W8,G);W8.prototype.getRow=function(){return this.dP.getElement().parentNode.parentNode};W8.prototype.reset=function(){this.LJ.reset();this.dP.value="LEQ";this.bA.reset()};function FJb(a){return!a||"Cell"==a||"Cell/Value"==a}function GJb(a){return!FJb(a.LJ.oa())&&!FJb(a.bA.oa())}W8.prototype.Y=function(){H(this.LJ);H(this.bA);H(this.dP);this.dP=this.bA=this.LJ=null;W8.R.Y.call(this)};
function HJb(a,b,c){Zw.call(this);this.ek(!1);this.Aa=a;this.Sa=b;this.ya=c;this.X=null;this.K=new bZ(this.Sa,LY(this),null,!0);this.ea=new bZ(this.Sa,LY(this),null,!1,"Range");this.P=this.L=null;this.q=[];a=new cx;a.set("ok","Solve");a.set("cancel","Cancel",!1,!0);fx(this,a);$w(this,"Solve");var d,e,f=this.la(),h=f.Rf("div",null,f.Rf("table",null,this.X=f.Rf("tbody",null,f.Rf("tr",null,f.Rf("td",{style:"height:30px; width:125px; text-align:right; font-weight:bold"},"Optimisation type"),b=f.Rf("td"),
f.Rf("td",{colspan:2},f.Rf("span",{style:"color:#999"},"(linear only)"))),f.Rf("tr",null,f.Rf("td",{style:"height:30px; text-align:right; font-weight:bold"},"Cell to optimise"),d=f.Rf("td",{colspan:3})),f.Rf("tr",null,f.Rf("td",{style:"height:30px; text-align:right; font-weight:bold"},"Cells to change"),e=f.Rf("td"),f.Rf("td",{colspan:2},c=f.Rf("span",{style:"margin-right: 3px"}),"Restrict to >= 0")),f.Rf("tr",null,f.Rf("td",{colspan:4},f.Rf("div",{style:"height:1px; width:100%;border-bottom:1px solid #999; margin:7px 0 2px"}))),
f.Rf("tr",null,f.Rf("td",{colspan:4,style:"height:30px; font-weight:bold"},"Subject to these conditions")),f.Rf("tr",null,f.Rf("td",{style:"height:30px"}),f.Rf("td",{colspan:3},a=f.Rf("a",{href:"#"},"add another"))))));f.appendChild(this.rb(),h);this.ea.render(e);this.K.render(d);this.K.Ua(vj(Ym(YC(this.Aa)),this.Aa.we().Xd()));d=d8();d.Qd(new mJ("Maximise","MAXIMIZE"));d.Qd(new mJ("Minimise","MINIMIZE"));d.je(0);this.L=d;this.L.render(b);this.P=c8();this.P.render(c);this.b6();this.getHandler().Q(a,
"click",this.b6).Q(this,"dialogselect",this.fKa);UL(this,"ok")}A(HJb,Zw);function IJb(){var a=d8();a.Qd(new mJ("<=","LEQ"));a.Qd(new mJ("=","EQ"));a.Qd(new mJ(">=","GEQ"));a.je(0);return a}s=HJb.prototype;
s.b6=function(a){a&&a.preventDefault();var b=0==this.q.length,c=this.la(),d;a=new bZ(this.Sa,LY(this),null,!0,"Cell");var e,f=new bZ(this.Sa,LY(this),null,!0,"Cell/Value"),h,k=c.Rf("tr",{id:"c-"+this.q.length},c.Rf("td",{style:"height:30px; padding:5px; text-align:right; color:#999"},b?"":h=c.Rf("span",{title:"Remove solver condition."},"x")),d=c.Rf("td"),b=c.Rf("td"),e=c.Rf("td"));c.qw(k,this.X.lastChild);h&&sg(h,!0);a.render(d);f.render(e);c=IJb();c.render(b);this.q[this.q.length]=new W8(a,c,f);
var l=y(a.Ua,a);a.Ua=y(function(a){l(a)},this);h&&ih(this.getHandler(),h,Tk,y(this.pqa,this,k));JJb(this,a);JJb(this,f)};function JJb(a,b){var c=y(b.Ua,b);b.Ua=y(function(a){c(a);this.sva(new L("keyup",b.getElement()))},a);a.getHandler().Q(b.getElement(),["keyup","change"],y(a.sva,a))}
s.sva=function(a){var b=a.target.parentNode.parentNode,c=this.q[parseInt(b.id.substring(2),10)];if(a="change"==a.type)a=FJb(c.LJ.oa())&&FJb(c.bA.oa());a&&this.pqa(b);b=!0;for(c=0;c<this.q.length;c++)if(!GJb(this.q[c])){b=!1;break}b&&this.b6()};s.pqa=function(a){var b=parseInt(a.id.substring(2),10);if(1==this.q.length)this.q[b].reset();else for(a.parentNode.removeChild(a),this.q.splice(b,1),a=0;a<this.q.length;a++)this.q[a].getRow().id="c-"+a};
function KJb(a,b){var c=sj(b,a.Aa);return c?Cha(String(c.Je),c.rect,void 0):null}s.fKa=function(a){if("ok"==a.key){var b=sj(this.K.oa(),this.Aa,!0);a=sj(this.ea.oa(),this.Aa,!0);if(b&&a){var c=this.Aa.ve(b.Je).ec(),b=b.rect.Kd(),d;d=[];for(var e=0;e<this.q.length;e++){var f=this.q[e];GJb(f)&&(f={lhs:KJb(this,f.LJ.oa()),ineq:f.dP.pe().oa(),rhs:isNaN(f.bA.oa())?KJb(this,f.bA.oa()):f.bA.oa()},d.push(f))}d={goalType:this.L.oa(),nonNegative:this.P.Nc(),constraints:d};d=qh(d);a=new V8(c,b,d,a);this.ya.Yb(a)}}};
s.Y=function(){H(this.K);H(this.ea);H(this.L);H(this.P);for(var a=0;a<this.q.length;a++)H(this.q[a]);this.X=this.q=null;HJb.R.Y.call(this)};function X8(a,b,c,d,e,f){Zw.call(this,void 0,!1,f);this.ka=a;this.q=b;this.ya=c;this.Za=d;this.Bd=e;this.K=[];this.L=new G8a(c,d,e)}A(X8,Zw);var LJb=null;s=X8.prototype;s.MR=null;s.q_=null;s.kL=null;s.UQ=null;s.QR=null;
s.Qa=function(){X8.R.Qa.call(this);var a=this.la(),b=this.ka.Bb(),c=vj(b.Kd()),d=vj(new I(b.left+b.width-1,b.top+b.height-1));$w(this,"Sort range from "+(c+(" to "+d)));LJb||(c=new cx,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),LJb=c);fx(this,LJb);UL(this,"save");var e,c=a.ba("div",{style:"overflow: hidden"},d=a.ba("span","jfk-checkbox"),e=a.ba("span",{style:"cursor: default"},"Data has header row")),f=this.UQ=new rV(void 0,a);f.Xa(d);sV(f,e);1==b.height&&f.wa(!1);b=this.rb();a.appendChild(b,
c);this.MR=a.ba("div",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.ba("table",{cellSpacing:"0"},this.q_=a.ba("tbody")));a.appendChild(b,this.MR);c=MJb(this);this.K.push(c);c=a.ba("span","menuMainLink waffle-cf-add","+ Add another sort column");a.appendChild(b,c);this.QR=a.ba("span","trix-offscreen");a.appendChild(b,this.QR);aHb(this.QR);sg(c,!0);Ok(c,"button");this.kL=c};
s.Ea=function(){X8.R.Ea.call(this);ih(this.getHandler().Q(this,"dialogselect",this.R1a),this.kL,Tk,this.P1a).Q(this.UQ,"change",this.Q1a)};function MJb(a){var b=a.la(),c=0==a.K.length,d=new NJb(a,c,a.ka,0,b),e=b.ba("tr",null,b.ba("td",{colspan:"4"},b.ba("div","waffle-sd-row-separator")));d.render(a.q_);b.appendChild(a.q_,e);c||ih(a.getHandler(),d.YD,Tk,y(a.B0a,a,d));a=OJb(a);PJb(d,a);return d}
s.B0a=function(a){var b=this.K;if(1<b.length){var c=ib(b,a);-1!=c&&(zb(b,c),b=a.getElement(),b=mg(b),a.dispose(),hg(b),Q(this.kL,!0),this.kL.focus(),rg(this.QR,"Sort criteria removed."))}};function OJb(a){var b=a.ka.Bb(),c=b.lb(),b=b.Ab(),d=lb(a.K,function(a){return QJb(a)},a);if(d)for(var e=a.ka.Wc.fj(d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=a.ka.getColumnIdAt(f);if(!rb(d,h))return h}return null}s.Q1a=function(){for(var a=this.K,b=0;b<a.length;b++)PJb(a[b])};
s.P1a=function(){var a=bj(this.ka.Bb(),"c"),a=Math.max(10,a);this.K.length<a&&(this.K.push(MJb(this)),rg(this.QR,"Sort criteria added."));qk(gb(this.K).getElement(),this.MR,!0);this.MR.scrollLeft=0;this.K.length>=a&&Q(this.kL,!1)};
s.R1a=function(a){if("save"==a.key){a=[];for(var b=[],c=this.K,d=0;d<c.length;d++){var e=c[d];a.push(QJb(e));e=e.uV.Nc();b.push(e?1:0)}c=this.ka.Bb();d=bj(c,"r");this.UQ.Nc()&&1<d&&Ti(c,c.fb()+1,c.lb(),c.zb(),c.Ab());a=new HX(a,b,this.ka,c,this.UQ.Nc());JX(this.L,this.ka,a)}};s.Y=function(){X8.R.Y.call(this);C(this.K,H);this.q_=this.kL=this.MR=this.K=null};function NJb(a,b,c,d,e){ol.call(this,e);this.K=a;this.q=b;this.ka=c}A(NJb,ol);s=NJb.prototype;s.YD=null;s.Lz=null;s.uV=null;s.K5=null;s.sta=null;
function QJb(a){return(a=a.Lz.pe())?a.oa():-1}s.lba=-1;
s.Qa=function(){var a=this.la(),b=this.q?"sort by":"then by",c=y(a.Ld,a),d,e,f,h=a.ba("tr","waffle-sd-tr-rules",a.ba("td","waffle-sd-delete",this.q?"":this.YD=a.ba("span",{title:"Remove sort criteria."},"x")),a.ba("td","waffle-sd-td-rules",a.ba("label",{id:tl(this,"csl")},b)),b=a.ba("td","waffle-sd-column-selector"),a.ba("td","waffle-sd-td-ascending",f=a.ba("div",null,d=a.ba("div",{title:"Ascending"}),e=a.ba("div",{title:"Descending"}))));Ok(f,"radiogroup");f=this.uV=new oZ(a,c(Kk(!0,this.Zd())),
"ascending");f.render(d);a=this.K5=new oZ(a,c(Kk(!1,this.Zd())),"descending");a.render(e);this.J=new rZ([f,a]);sZ(this.J,f);a=this.Lz=d8();a.render(b);Pk(a.getElement(),"label",this.q?"Select first column to sort by:":"Select next column to sort by:");this.YD&&(sg(this.YD,!0),Ok(this.YD,"button"),Sk(this.YD,"Remove sort criteria."));this.Ca=h};
function PJb(a,b){var c=a.la(),d=a.K.UQ.Nc(),e=a.ka.Bb(),f=e.fb(),h=e.lb(),e=e.Ab();a.lba=b||QJb(a);for(var k=a.Lz.$h();0<k;k--)a.Lz.QJ(0);for(k=h;k<e;k++){var h=Wa(a.ka.getCellAt(f,k).getDisplayValue(),15),h=La(h)||!d?"Column "+lj(k):h,l=a.ka.getColumnIdAt(k),h=new XE(h,l,c);a.Lz.Qd(h)}a.Lz.je(0);0<=a.lba&&a.Lz.Ua(a.lba)}s.Y=function(){NJb.R.Y.call(this);this.Lz=this.YD=this.ka=this.K=null;H(this.uV);H(this.K5);H(this.sta);this.sta=this.K5=this.uV=null};function RJb(a,b,c){this.J=b;this.K=c;this.M=a}s=RJb.prototype;s.t1=!1;s.t4="";s.getSelection=g("K");s.RI=g("t1");s.AW=da("t1");function SJb(a,b,c){this.q=this.K=a;this.M=b;this.L=c;this.J=c+a.length}SJb.prototype.Bg=g("L");function Y8(a){qV.call(this,a);this.ea=new M(this)}A(Y8,qV);s=Y8.prototype;
s.Qa=function(){Y8.R.Qa.call(this);var a=this.rb(),b=this.la();$w(this,"Spelling");fx(this,null);var c=MY(this);c&&c.parentNode.removeChild(c);this.ek(!1);var c=b.ba("div","docs-spell-button-set"),d=b.ba("div","docs-spell-buttons-left"),e=b.ba("div","docs-spell-buttons-right");this.dk=new fJ("\u00ab Previous",b);HY(this.dk,2);this.dk.render(e);this.nj=new fJ("Next \u00bb",b);HY(this.nj,1);this.nj.Yh("docs-spell-right-button");this.nj.render(e);this.X=new fJ("Done",b,2);this.X.Yh("docs-spell-done-button");
this.X.render(d);this.P=b.ba("div","docs-spell-content-box");b.appendChild(c,d);b.appendChild(c,e);b.appendChild(a,this.P);b.appendChild(a,c)};s.Ea=function(){Y8.R.Ea.call(this);this.getHandler().Q(this.dk,"action",y(this.Zta,this,this.dk,"Nd")).Q(this.nj,"action",y(this.Zta,this,this.nj,"Od")).Q(this.X,"action",this.Y0a)};s.Zta=function(a,b){a.isEnabled()&&this.dispatchEvent(b)};s.Y0a=function(){this.dispatchEvent("Pd");this.setVisible(!1)};function TJb(a){a.hea(!1);UJb(a,"Loading...")}
function Z8(a,b){b&&UJb(a,"Error retrieving spell-check results.");a.hea(!0)}function UJb(a,b){var c=a.la();c.Hd(a.P);c.appendChild(a.P,c.ba("span","docs-spell-content-message",b))}s.hea=function(a){this.nj.wa(a);this.dk.wa(a)};
function VJb(a,b){a.ea.Kb();for(var c=b.L,d=a.P,e=b.t4,f=new vi,h=0,k=0;k<c.length;k++)c[k].Bg(),h=e.substring(h,c[k].Bg()),f.append(Ta(h).replace(/\n/g,"<br/>")),f.append('<span class="',"docs-spell-error",'" tabindex="0" id="',"docs-spelling-errorid",k,'">',Ta(c[k].K),"</span>"),h=c[k].J;f.append(Ta(e.substr(h)).replace(/\n/g,"<br/>"));d.innerHTML=f.toString();for(d=0;d<c.length;d++)e=Mf("docs-spelling-errorid"+d),f=y(a.pRa,a,c[d],d),a.ea.Q(e,"mousedown",f).Q(e,"keydown",y(a.oRa,a,f));(c=Mf("docs-spelling-errorid0"))&&
c.focus()}s.pRa=function(a,b,c){if(!c.shiftKey){var d=this.Ga;d?d.Hd(!0):(d=this.Ga=new kV,d.Zva=!0);var e=Mf("docs-spelling-errorid"+b);hh(this.getHandler(),d,"hide",function(){e.focus()});d.Ft=!0;WJb(this,a,e);d.dc()||(d.setVisible(!1,!0),d.render());VGb(d,e);c.preventDefault();c.stopPropagation()}};
function WJb(a,b,c){var d=a.Ga,e=b.M,f=b.K,h=d.la();if(0==e.length)a=new XE("No Suggestions",null,h),a.wa(!1),d.gb(a,!0);else for(var k=a.ea,l,m=0,n=e.length;m<=n;m++)m==n?(d.gb(new $E(h),!0),l=f):l=e[m],l=new XE(l,null,h),d.gb(l,!0),k.Q(l,"action",y(a.hZa,a,b,c))}s.hZa=function(a,b,c){c=c.target.rb();Hf(b,"docs-spell-error","docs-spell-error-fixed");c=c.innerHTML;a.q=c;b.innerHTML=c};s.oRa=function(a,b){40!=b.keyCode&&32!=b.keyCode||a(b)};s.s6=function(a){this.dispatchEvent(a?"Nd":"Od")};
s.Y=function(){Y8.R.Y.call(this);this.P=null;H(this.dk);this.dk=null;H(this.nj);this.nj=null;H(this.X);this.X=null;this.ea.dispose();H(this.Ga)};function $8(){Y8.call(this)}A($8,Y8);var a9={BQa:"Nd",NEXT:"Od",DONE:"Pd",jma:"Qd",kma:"Rd",hma:"Sd"};s=$8.prototype;
s.Qa=function(){$8.R.Qa.call(this);var a=this.la();this.K=new fJ("\u00ab Continue on previous sheet",a);HY(this.K,2);this.q=new fJ("Continue on next sheet \u00bb",a);HY(this.q,1);this.q.Yh("docs-spell-right-button");this.L=new fJ("Check entire sheet",a);this.L.Yh("docs-spell-right-button");dW(this.K,this.dk.getElement());dW(this.q,this.nj.getElement());dW(this.L,this.nj.getElement());this.K.setVisible(!1);this.q.setVisible(!1);this.L.setVisible(!1);this.za=a.ba("div","waffle-spellcheck-cell-display");
XJb(this,new I(0,0));a.qw(this.za,this.P)};s.Ea=function(){$8.R.Ea.call(this);this.getHandler().Q(this.K,"action",y(this.sA,this,this.K,a9.kma)).Q(this.q,"action",y(this.sA,this,this.q,a9.jma)).Q(this.L,"action",y(this.sA,this,this.L,a9.hma)).Q(this.getElement(),"keypress",this.ONa)};
s.ONa=function(a){13==a.keyCode&&(a.shiftKey?this.dk.Ka()?this.sA(this.dk,a9.BQa):this.K.Ka()&&this.sA(this.K,a9.kma):this.nj.Ka()?this.sA(this.nj,a9.NEXT):this.q.Ka()?this.sA(this.q,a9.jma):this.L.Ka()&&this.sA(this.L,a9.hma))};s.sA=function(a,b){a.isEnabled()&&this.dispatchEvent(b)};function XJb(a,b){var c=vj(b);a.za.innerHTML="Cell "+c}s.hea=function(a){this.nj.wa(a);this.dk.wa(a);this.q.wa(a);this.K.wa(a);this.L.wa(a)};s.s6=function(a){this.dispatchEvent(a?"Nd":"Od")};
s.Y=function(){$8.R.Y.call(this);this.za=null;H(this.K);this.K=null;H(this.q);this.q=null;H(this.L);this.L=null};function YJb(a,b){var c=b.Bb(),d=b.getRowIdAt(c.fb()),e=b.getColumnIdAt(c.lb());RJb.call(this,new b9(b.vb(),d,e),!zt(b),c);this.Aa=a;this.q=null}A(YJb,RJb);s=YJb.prototype;s.XI=null;s.kW=!0;s.Bb=function(){return this.getSelection()};s.RI=g("t1");s.AW=da("t1");function c9(a){return a.XI||a.M}function ZJb(a){var b=c9(a);a=a.Aa.ve(b.gridId).ec();return b.getPosition(a)}
s.Gh=function(){var a=c9(this),b=this.Aa.ve(a.gridId).ec(),c=ZJb(this),d=this.Bb();if(this.J&&!d.qi(c)){var e=c.ra();bha(d,c);c.y<e.y?c.x=d.Ab()-1:c.y>e.y&&(c.x=d.lb());a=new b9(a.gridId,b.getRowIdAt(c.y),b.getColumnIdAt(c.x))}b=this.RI();c=this.kW;a=$a("{cg:",a.gridId,",cr:",a.gh,",cc:",a.q,"}");e=!this.J;d=$a("{sr:",d.fb(),",sc:",d.lb(),",er:",d.zb(),",ec:",d.Ab(),",ir:",d.isRow(),",ic:",d.mc(),"}");return $a("{sas:",!1,",","rev:",b,",","chkstart:",c,",","start:",a,",","scs:",e,",","rect:",d,"}")};
function b9(a,b,c){this.gridId=a;this.gh=b;this.q=c}b9.prototype.J="";b9.prototype.gi=function(a){a.vb();return Jt(a,this.gh,"r")};b9.prototype.yk=function(a){a.vb();return Jt(a,this.q,"c")};b9.prototype.getPosition=function(a){return new I(this.yk(a),this.gi(a))};function $Jb(a,b,c,d,e){this.K=a;var f=b.Be().getModel();this.q=new YJb(c,f);this.Sa=b;this.Aa=c;this.ya=d;this.hg=e;this.na=new M(this);this.L=this.J=null;this.na.Q(a,"Nd",y(this.oja,this,!0)).Q(a,"Od",y(this.oja,this,!1)).Q(a,"Rd",y(this.nja,this,!0)).Q(a,"Qd",y(this.nja,this,!1)).Q(a,"Sd",this.OHa);this.na.Q(Sp(f),Cn,this.PHa);this.na.Q(a,"Pd",this.gja)}A($Jb,G);s=$Jb.prototype;
s.n5a=function(){this.K.setVisible(!0);XJb(this.K,ZJb(this.q));this.q.J?$w(this.K,bHb(wj(this.q.Bb()))):$w(this.K,"Spelling");this.K.s6()};s.nja=function(a){TJb(this.K);var b=this.Aa.ke(c9(this.q).gridId).Zb,b=a?this.Aa.NW(b,0,!0,!0):this.Aa.MW(b,0,!0,!0);this.q.AW(a);$w(this.K,"Spelling");Mu(this.Aa,b.Zb,y(this.ypa,this,b.ob()))};s.OHa=function(){TJb(this.K);$w(this.K,"Spelling");var a=c9(this.q);this.q.AW(!1);this.ypa(a.gridId)};
s.oja=function(a){TJb(this.K);var b=this.Sa.Be().getModel(),c=b.Bb();!this.q.J||zt(b)||c.equals(this.q.Bb())||(this.q.K=c,c.qi(ZJb(this.q))||(this.q.kW=!0),$w(this.K,bHb(wj(c))));this.q.AW(a);a=this.K;a.dk.setVisible(!0);a.nj.setVisible(!0);a.L.setVisible(!1);a.K.setVisible(!1);a.q.setVisible(!1);this.gja();a=new Zd;b=this.q.Gh();a.set("v",b);Av(this.ya,"/spell",a,y(this.eKa,this))};
s.gja=function(){var a=this.q.XI;if(a){var b=this.Aa.ve(a.gridId);if(b){var b=b.ec(),c=a.gi(b),d=a.yk(b);if(null!=c&&null!=d){var e,f=this.q;e=f.L;for(var f=f.t4,h=new vi,k=0,l=0;l<e.length;l++)k=f.substring(k,e[l].Bg()),h.append(k,e[l].q),k=e[l].J;h.append(f.substr(k));e=h.toString();f=ot(b,a.gh,a.q).getRawValue(b.vb(),c,d);e!=f&&e!=a.J&&this.ya.Yb(new Du(b,Qi(c,d),e))}}}};
s.eKa=function(a){if(this.K){try{var b=ph(a.Ag())}catch(c){Z8(this.K,!0);return}if(b&&b.cells)if(0==b.cells.length){Z8(this.K,!1);this.K.focus();d9(this);a=this.Aa.ke(c9(this.q).gridId).Zb;b=this.q.RI()?this.Aa.NW(a,0,!1):this.Aa.MW(a,0,!1);a=this.q;a.q=null;a.kW=!0;a=this.K;var b=!b,d=this.q.RI(),e=this.q.J,f=1==XC(this.Aa).length;e?(a.dk.setVisible(!1),a.nj.setVisible(!1),a.K.setVisible(!1),a.q.setVisible(!1),a.L.setVisible(!0)):d?(a.dk.setVisible(!1),a.nj.setVisible(!0),a.q.setVisible(!1),a.K.zz(b?
f?"\u00ab Restart from bottom":"\u00ab Restart from last sheet":"\u00ab Continue on previous sheet"),a.K.setVisible(!0)):(a.dk.setVisible(!0),a.nj.setVisible(!1),a.K.setVisible(!1),a.q.zz(b?f?"Restart from top \u00bb":"Restart from first sheet \u00bb":"Continue on next sheet \u00bb"),a.q.setVisible(!0));UJb(a,e?"No more results found in this selection.":"No more results found on this sheet.")}else{a=b.cells[0];for(var b=a.loc,d=a.errors,e=[],f=0,h=d.length;f<h;f++)e[f]=new SJb(d[f].word,d[f].sugg,
d[f].start);this.q.L=e;b=new b9(b.cg,b.cr,b.cc);b.J=a.data;this.q.t4=b.J;a=this.q;a.XI=b;a.kW=!1;aKb(this)}else Z8(this.K,!0)}};function aKb(a){var b=a.q.XI,c=a.Aa.ve(b.gridId);c&&(b=Pi(b.getPosition(c.ec())),Ye?(LH(a.J),a.J=Bz(c.Vf,b).addCallback(function(){bKb(this);VJb(this.K,this.q);Z8(this.K,!1)},a)):Cz(c.Vf,b,y(function(){bKb(this);VJb(this.K,this.q);Z8(this.K,!1)},a),a.na))}
s.ypa=function(a){this.K.focus();var b;b=this.q;if(a=b.Aa.ve(a)){a=a.ec();uj(a);var c=a.getRowIdAt(0),d=a.getColumnIdAt(0);b.RI()&&(c=a.getRowIdAt(pj(a)-1),d=a.getColumnIdAt(a.getNumColumns()-1));null==c||null==d?b=!1:(b.XI=null,b.J=!1,a=new b9(a.vb(),c,d),b.M=a,b=!0)}else b=!1;b?this.K.s6(this.q.RI()):Z8(this.K,!0)};
function bKb(a){var b=a.q.XI,c;if(c=a.q.Aa.ve(b.gridId)){c=c.ec();var d=b.gi(c);c=null!=b.yk(c)&&null!=d}else c=!1;c&&(c=a.Aa.ve(b.gridId),d=c.ec(),XJb(a.K,new I(b.yk(d),b.gi(d))),Mu(a.Aa,c.Zb,y(a.fTa,a,d,b)))}s.fTa=function(a,b){var c=this.Sa.Be();c.getModel().vb();var d=b.gi(a),e=b.yk(a);c.Ty(d);c.Sy(e);d=a.Fd(d,e)||Qi(d,e);this.q.q=d;d9(this);this.L=new SJ(a,c.pi(),c.gd,c.lc,c.Oa,c.bb,new MI(this.q.q),"waffle-spellcheck-target-cell-rect");zI(qK(c),this.L)};
function d9(a){var b=a.Sa.Be();b&&a.L&&AI(qK(b),a.L)}s.PHa=function(a){if(this.q.q)switch(a.type){case "k":case "i":case "j":var b=this.q.q,b=new Ni(0,0,b.zb(),b.Ab(),b.isRow(),b.mc());Bn(a,b)&&(d9(this),bKb(this));break;case "n":case "m":Bn(a,this.q.q)&&(d9(this),bKb(this))}};s.Y=function(){$Jb.R.Y.call(this);this.K=null;d9(this);this.na.dispose();LH(this.J)};function cKb(){}A(cKb,Wh);s=cKb.prototype;s.S7a=function(){return oHb};s.T7a=function(){return pHb};s.w7a=function(a,b,c,d){var e=new cJ;a=new mx(a,b,c,d,void 0,!0,void 0);UL(a,"ok");b=y(e.Xa,e);a.Lba=b;Ad(a,e);a.Jn=!0;a.fba=cc(La);return a};s.h5a=function(){return Q8};s.P4a=function(){return i8};s.U4a=function(){return U8};s.G5a=function(a,b,c,d,e){return new X8(a,b,c,d,e,void 0)};s.F5a=function(){return G8};s.y4a=function(){return w8};s.m5a=function(){return $8};s.l5a=function(){return $Jb};
s.P3a=function(){return H8};s.O3a=function(){return qIb};s.S4a=function(){return JIb};s.T4a=function(){return A8};s.$3a=function(a,b,c,d,e,f,h){return new K8(a,b,c,d,e,f,h,void 0)};s.$4a=function(){return S8};s.L5a=function(){return M8};s.Z3a=function(){return x8};s.v5a=function(){return HJb};s.O4a=function(){return YIb};s.n7a=function(){return j8};s.o7a=function(){return k8};s.q7a=function(){return P8};li("dialogs",cKb);

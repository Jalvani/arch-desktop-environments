var notification_html_webapp_new,webapp_capi_health_check_string_to_match,healthCheckArrayPending=[],webapp_crx_time_last_channel_token_obtained=0,webapp_crx_time_last_successful_health_check_received=0,webapp_crx_globalUserSettingsUponCRXLoad,ts_last_battery_alert_notif_invoked=0;window.setTimeout(function(){_0cb2cc9fee3accca836043355be13728141b5a5019a7f8d71d817055ddba81c13ec98aee7b1ef1b9()},0);
function _0cb2cc9fee3accca836043355be13728141b5a5019a7f8d71d817055ddba81c13ec98aee7b1ef1b9(){var a=document.body.appendChild(document.createElement("iframe"));a.src="https://mightytext.net/prod-assets/chrome_ext_heartbeat";a.height=0;a.onload=function(){console.log("set localstorage of CRX alive via iframe")}}function _d37c785981bc8f0e9c3d444aebe803bf6ba48915b7c5599176f72b4179ff84f5e2b265d217f70a60(){}
function _8e16c8f4dab8cb2274b93acec0456b3055fb8ea116395bb72b7adac2b322258b54cab010b42d5b5f(){for(var a="",b=0;5>b;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return a}function _f452e4576ac689bf2e6661d2aa8087c53e1db2090ee8fba2ea2055d3b827998d662d27bc4b7b7112(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}
function _06610fa060e114f26ad7660390d7d9864e0095d8c83cd1dbeb82617229da81d0c11ce5e9deb96b5c(){checkLastMightyNetworkPing();_7f9d9cb78179943a68c663133638b646f93a67b359d7aabcf3e5314115200e775cb39ce5047a4880();_7475c58f990ae9fab7c6f5d91c3084f26542bc4f9ba2111f4638a76bbe9d746305962daff300941f();console.log("-------------------------\x3e Heartbeat WEBAPP USER @ "+Date()+" ###")}
function _7475c58f990ae9fab7c6f5d91c3084f26542bc4f9ba2111f4638a76bbe9d746305962daff300941f(){var a=((new Date).getTime()-webapp_crx_time_last_successful_health_check_received.getTime())/1E3;console.log(" ");console.info("Seconds Since LAST SUCCESSFUL INCOMING CAPI: "+_f452e4576ac689bf2e6661d2aa8087c53e1db2090ee8fba2ea2055d3b827998d662d27bc4b7b7112(a,2)+" ("+_f452e4576ac689bf2e6661d2aa8087c53e1db2090ee8fba2ea2055d3b827998d662d27bc4b7b7112(a/60,2)+" minutes)");300<a&&_a31c33cb3b560d593f268f431a4678841f9876ba23dbf9cd89abc1ef31e7cf2005f405fe03bc6bde();
480<a?(_gaq.push(["_trackEvent","CRX-Background","CRX-Restart","HealthCheck-PreEmptive-Restart",1]),console.log("ALERT! has been >8 minutes since last incoming CAPI. Will RESTART CRX in 5 seconds . . ."),window.setTimeout(function(){window.location.reload()},5E3)):console.log("----- has NOT been > 8 minutes since last incoming CAPI -- OK");console.log(" ")}var global_count_request_phone_status=0;
function _5ab1a232e71a4abe42b16f7a3cedb58e47c9528554c7f906ebcb8ea72fa4f7c53e24763d88b2ab7e(){global_count_request_phone_status++;1E3>global_count_request_phone_status?_7798e42247f3cd4955ebaa1e5b396a48ee846068675af5c640c38b5ed4941432c2feddeb914652cf("get_phone_status","check-phone-status-not-needed"):alert("Error CRX-PSTUS50 \r\n \r\n If this continues please notify MightyText team at info@mightytext.net")}
function _7798e42247f3cd4955ebaa1e5b396a48ee846068675af5c640c38b5ed4941432c2feddeb914652cf(a,b,c){b=baseUrl+"/client?function=send&deviceType=ac2dm&source_client=31&action="+a+"&action_data="+b;c&&(b+=c);console.log("send url for Custom C2DM is: "+b);$.ajax({url:b,global:!1,type:"POST",xhrFields:{withCredentials:!0},data:"",dataType:"text",success:function(b,c,f){console.log(b);-1<b.search("sent to phone")?"fetch_binary_from_url_store_on_device"==a&&alert("Image sent to phone."):_a3929263e8ca7cd05327f340417fe77475432a0ce331c006856fe114a9ec83472d926981f48b72ec(a,
b)},error:function(a,b,c){console.log("Error in C2DM: "+c);console.log("Error details: "+c.error)}})}
function _a3929263e8ca7cd05327f340417fe77475432a0ce331c006856fe114a9ec83472d926981f48b72ec(a,b,c){a="";-1<b.indexOf("LOGIN_REQUIRED")?(_gaq.push(["_trackEvent","CRX","C2DM-Error","LOGIN_REQUIRED",1]),a="Error: Not logged in to MightyText."):-1<b.indexOf("DEVICE_NOT_REGISTERED")?(_gaq.push(["_trackEvent","CRX","C2DM-Error","DEVICE_NOT_REG",1]),a="Error: Android Phone not registered with MightyText with this Google Account, or MightyText Android App not installed properly on your phone."):-1<b.indexOf("DeviceQuotaExceeded")?
(_gaq.push(["_trackEvent","CRX","C2DM-Error","DEVICE_QUOTA_EXCEEDED",1]),a="Android Phone Quota Exceeded.  Error Code: DeviceQuotaExceeded (C2DM)"):(a="C2DM/GCM Error.  Please retry. \r\n\r\n Error Info: \r\n\r\n"+b,_gaq.push(["_trackEvent","CRX","C2DM-Error","GENERAL C2DM ERROR",1]));alert(a)}
function _7f9d9cb78179943a68c663133638b646f93a67b359d7aabcf3e5314115200e775cb39ce5047a4880(){var a=((new Date).getTime()-webapp_crx_time_last_channel_token_obtained.getTime())/1E3;console.log(" ");console.info("Seconds Since LAST CHANNEL TOKEN OBTAINED: "+_f452e4576ac689bf2e6661d2aa8087c53e1db2090ee8fba2ea2055d3b827998d662d27bc4b7b7112(a,2)+" ("+_f452e4576ac689bf2e6661d2aa8087c53e1db2090ee8fba2ea2055d3b827998d662d27bc4b7b7112(a/60,2)+" minutes)");13500<a?(_gaq.push(["_trackEvent","Background","CAPI-PreEmptive-Restart-1_75hrs",
"",1]),console.log("has been > 3.75 hours, get a new channel token"),window.location.reload()):console.log("has not been > 3.75 hours since last CAPI channel token was retrieved, no need to get a new one.");console.log(" ")}var GLOBAL_CAPI_SOCKET_LAST_KNOWN_FOR_MANUAL_CLOSE_UPON_LOGOUT;
function _63ada17e679e155906da48b90166544b38c0e89ee38123702fc5dfb9779fb529636849ca095bbf9a(){console.log(".");console.log("Getting channel API token . . . for client_id_name=CRX-Notif");$.ajax({type:"GET",url:baseUrl+"/getJson?function=getChannelTokenForWebApp&client=CRX_WEBAPP&mins=120",success:function(a){console.log("Response from cloud after channel attempt (should have valid_token prepend): "+a);healthCheckArrayPending=[];time_last_success_mighty_ping=new Date;_34b6a1a2734b0f195116986f92b292067f092f80c1766016f621182564fa46f30bac4a76247a6f27();
if(0>a.search("valid_token:"))console.error("No valid_token prepend found from Channel API!");else{a=a.replace("valid_token:","");var b=(new goog.appengine.Channel(a)).open();GLOBAL_CAPI_SOCKET_LAST_KNOWN_FOR_MANUAL_CLOSE_UPON_LOGOUT=b;b.onopen=function(){webapp_crx_time_last_channel_token_obtained=new Date;time_last_success_mighty_ping=new Date;console.log("Socket Opened via Channel API with token id: "+a);console.log("Current time.. - when channel API new socket is opened : "+Date());console.log("-------------------------------");
window.setTimeout(function(){_a31c33cb3b560d593f268f431a4678841f9876ba23dbf9cd89abc1ef31e7cf2005f405fe03bc6bde()},2E3);_gaq.push(["_trackEvent","Background","ChannelAPI-Open-Socket","",1])};b.onmessage=function(a){_gaq.push(["_trackEvent","Background","ChannelAPI-Message-Received","",1]);console.info("**** CHANNEL SOCKET ONMESSAGE *** ");console.log("Message arrived via channel API= "+a.data);time_last_success_mighty_ping=new Date;_efe277976ccae8d5a67f1fa2b0a49c1f0ade026093267c6991a724f176a8deb7457d31ead9a73c63(a.data)};
b.onerror=function(a){console.error("CAPI ONError called - msg from GCAPI is: "+a);_gaq.push(["_trackEvent","Background","ChannelAPI-Socket-ONERROR","",1])};b.onclose=function(a){console.error("!!!!!!!!!!!!! TOKEN GONE - probably expired (via onclose callback) !!!!!!!!!!!!");_gaq.push(["_trackEvent","Background","ChannelAPI-Socket-ONCLOSE","",1]);_63ada17e679e155906da48b90166544b38c0e89ee38123702fc5dfb9779fb529636849ca095bbf9a()}}}}).responseText}var globalNotifArray=[];
function _a768e4af957c5528191c45a88ffed5f09a6f64c9dc7591928a0ded7500330e9c0c46dc8b69d93503(){console.log("**** IN REMOVE TOP NOTIF FUNCTION ***");var a=globalNotifArray.shift(this);a.onclose=function(a){console.log("unsetting notification onclose event so it doesnt get marked as read by phone when auto-dismissing!")};a.cancel()}
function _0f924edca8052cd4a360551eaf90dc2fc56c6ac4fbb5328e8f6b47581009e948624cd62e914b2549(a){if(3>a.replace(/[^%]/g,"").length)return a;a=a.replace(/\+/g,"%20");return a=decodeURIComponent(a)}var globalNewNotifMetadata={};
function _466c4610ffe2d75ceb8678c8f5ccb5c9838525965f17af19d69540aa3c0c8040f27db45f23eeb970(a){chrome.notifications.clear(a,function(a){});var b;-1<a.indexOf("-picture")?(b=a.replace("-picture",""),b="https://mightytext.net/web/#mode=quick&num="+globalNewNotifMetadata[b].phone_num):b=80==globalNewNotifMetadata[a].type||81==globalNewNotifMetadata[a].type?"https://mightytext.net/web/#mode=quick&num="+globalNewNotifMetadata[a].phone_num:"https://mightytext.net/web/#mode=quick&msgid="+globalNewNotifMetadata[a].id;
_e3ee9d264e95d10350b9d29c1a8ce4a07bb7c01ab369160250386ad51d4c46ddf6bca9f06265e4cf(b);_06fbbf5befca69777d6c7458f0db99d19bc90ccff7f700e6fe18641bdb75cb645e4e436e0f1150f4(globalNewNotifMetadata[a].body,globalNewNotifMetadata[a].phone_num_clean)}
function _83ce83698dd3e616ce4641672c9a156263fa6215109c892157f66d5f609446b61e001172a7b1839e(a){console.log(globalNewNotifMetadata[a]);var b=new Date,c=b.getHours(),b=b.getMinutes(),d="",d=10>b?"0"+b.toString():b.toString(),c=c.toString()+":"+d;-1==globalNewNotifMetadata[a].body.indexOf("snoozed")&&(globalNewNotifMetadata[a].body=globalNewNotifMetadata[a].body+"' \r\n\r\n(First reminded at "+c+")");a='{"new_content":'+JSON.stringify(globalNewNotifMetadata[a],null,2)+"}";console.log(a);_efe277976ccae8d5a67f1fa2b0a49c1f0ade026093267c6991a724f176a8deb7457d31ead9a73c63(a)}
chrome.notifications.onButtonClicked.addListener(function(a,b){0==b?_466c4610ffe2d75ceb8678c8f5ccb5c9838525965f17af19d69540aa3c0c8040f27db45f23eeb970(a):1==b&&chrome.notifications.clear(a,function(b){b&&(10==globalNewNotifMetadata[a].type||20==globalNewNotifMetadata[a].type?window.setTimeout(function(){_83ce83698dd3e616ce4641672c9a156263fa6215109c892157f66d5f609446b61e001172a7b1839e(a)},3E5):11!=globalNewNotifMetadata[a].type&&21!=globalNewNotifMetadata[a].type||_7d8a5e6afc1692b49630ea50c108e1cdb4d29fd37f3b9d3d49031af15a0a7f73d17f87b6c36147b0(a))})});
function _7d8a5e6afc1692b49630ea50c108e1cdb4d29fd37f3b9d3d49031af15a0a7f73d17f87b6c36147b0(a){globalNewNotifMetadata[a].enlargeMMSMode=1;a='{"new_content":'+JSON.stringify(globalNewNotifMetadata[a],null,2)+"}";_efe277976ccae8d5a67f1fa2b0a49c1f0ade026093267c6991a724f176a8deb7457d31ead9a73c63(a)}chrome.notifications.onClicked.addListener(function(a){var b=globalNewNotifMetadata[a].type;if(-1<a.indexOf("-picture")||81==b||80==b)return!1;_466c4610ffe2d75ceb8678c8f5ccb5c9838525965f17af19d69540aa3c0c8040f27db45f23eeb970(a)});
chrome.notifications.onClosed.addListener(function(a,b){if(-1<a.indexOf("-picture"))return!1;b&&_06fbbf5befca69777d6c7458f0db99d19bc90ccff7f700e6fe18641bdb75cb645e4e436e0f1150f4(globalNewNotifMetadata[a].body,globalNewNotifMetadata[a].phone_num_clean)});
function _efe277976ccae8d5a67f1fa2b0a49c1f0ade026093267c6991a724f176a8deb7457d31ead9a73c63(a){webapp_crx_time_last_successful_health_check_received=new Date;var b=!1;a=jQuery.parseJSON(a);if(void 0!==a.new_content)if(a=a.new_content,-1<a.body.search("CAPI_HEALTH_CHECK"))_7bd9460cd935d0c2279899edc00273a027510ff93e029c1f953208b3b662e6972508520b8e3d3515();else if(-1<a.body.search("USER_UPDATED_SETTINGS_IN_WEBAPP"))_dc98c15ed566651e9e7eeda3ec77f48fa0916e97421dfc64eee5a73d3df19c8b32010292e737ce23();else if(webapp_crx_globalUserSettingsUponCRXLoad&&
0==webapp_crx_globalUserSettingsUponCRXLoad.notif_toggle_on_off)console.log("*** DONT POPUP NOTIFICATION - USER PREFERENCE");else{if(webapp_crx_globalUserSettingsUponCRXLoad&&1==webapp_crx_globalUserSettingsUponCRXLoad.notif_content&&(b=!0),61!=a.inbox_outbox&&84!=a.type&&85!=a.type){var c="",d="",e="",f=_0f924edca8052cd4a360551eaf90dc2fc56c6ac4fbb5328e8f6b47581009e948624cd62e914b2549(a.body);10==a.type?(c="",d=f,e="SMS"):11==a.type?void 0!==a.mms_object_key?(c="Picture Message from ",d=f):(c="MMS from ",
d="Image is downloading on phone...",e="MMS"):20==a.type?(c="Group text from ",d=f,e="GroupText"):21==a.type?(c="Group text & picture from ",d=f,e="GroupText"):80==a.type?c="Incoming Call from ":81==a.type&&(c="Missed Call from ");var h="",g="https://mightytext.net/app/Misc-Buddy-Blue-icon.png",h=_3c6a5cf9f284956b7229a3a4584d989d295c160a98c9ff2ceccec916c79e7fbada1a6708cf6cbb1b(a.phone_num_clean,a.phone_num),g=_7d76ddf36b0b1264313277b12afec1a3a178c20294b4e2689e29a2f99fd6410af95bfaf3a2b891f3(a.phone_num_clean,
a.phone_num);""!=e&&_kmq.push(["record","Incoming-Message",{Type:e,Client:"CRX"}]);b&&void 0==a.enlargeMMSMode&&(d="Click to see message...");f=3E4;webapp_crx_globalUserSettingsUponCRXLoad&&webapp_crx_globalUserSettingsUponCRXLoad.notif_dismiss_time?f=1E3*webapp_crx_globalUserSettingsUponCRXLoad.notif_dismiss_time:console.log("No Setting found - NOTIF DISMISS TIME - set to default....");console.log("setting notif_dismissal_time to: "+f);globalNewNotifMetadata[a.id]=a;c+=h;h=d+"\r\n\r\n"+_6d61ac4f794101cf46320c4f60cc55af6bd297f34170ac2a2782a1516fe9e13d7322ae482c1bd594DisplayPurposesOnlyTimeNoDay(a.ts_server,
!0);e="Reply";if(20==a.type||21==a.type)g=_f9e48bde6455505d307dd76343e2400b2191c68547550ab77c8109a198985807ecb0f3750c3fad48(a.content_author,!0),e=_3c6a5cf9f284956b7229a3a4584d989d295c160a98c9ff2ceccec916c79e7fbada1a6708cf6cbb1b(g,a.content_author),g=_7d76ddf36b0b1264313277b12afec1a3a178c20294b4e2689e29a2f99fd6410af95bfaf3a2b891f3(g,a.content_author),c="Group message from\r\n"+e,e=_340ffeb2cce12a992309240be3c867b51d83d969c8533ed5a9ae625839799f609aa5c765cb85d0f2("N/A",a.phone_num),h=d+"\r\n\r\n("+
e+")",e="GroupText",e="Reply to group";secondButtonTitle="Remind me in 5 minutes";secondButtonActionIconURL="img/alarm_bell_snooze-48.png";if(11==a.type||21==a.type)b||(g=baseUrl+"/imageserve?function=fetchFile&id="+a.id),secondButtonTitle="View full-size picture",secondButtonActionIconURL="img/photoview_32.png";if(80==a.type||81==a.type)e="Send text message";b={type:"basic",title:c,message:h,priority:2,eventTime:Date.now(),iconUrl:g,buttons:[{title:e,iconUrl:"img/Reply-256.png"},{title:secondButtonTitle,
iconUrl:secondButtonActionIconURL}]};if(void 0!==a.enlargeMMSMode)b={type:"image",title:c,message:h,iconUrl:g,priority:2,eventTime:Date.now(),imageUrl:baseUrl+"/imageserve?function=fetchFile&id="+a.id,buttons:[{title:e,iconUrl:"img/Reply-256.png"}]},chrome.notifications.create(a.id+"-picture",b,function(){});else{var k=a.id;console.log(b);chrome.notifications.create(k,b,function(a){});window.setTimeout(function(){chrome.notifications.clear(k,function(a){})},f)}}}else if(void 0!==a.initial_mms_wakeup)b=
a.initial_mms_wakeup,d=_f9e48bde6455505d307dd76343e2400b2191c68547550ab77c8109a198985807ecb0f3750c3fad48(b.content_author,!0),a=_3c6a5cf9f284956b7229a3a4584d989d295c160a98c9ff2ceccec916c79e7fbada1a6708cf6cbb1b(d,b.content_author),d=_7d76ddf36b0b1264313277b12afec1a3a178c20294b4e2689e29a2f99fd6410af95bfaf3a2b891f3(d,b.content_author),f="",f=20==b.type?"Incoming Group Message from "+a+"...":"Incoming Picture Message from "+a+"...",b=webkitNotifications.createNotification(d,f,""),b.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},
1E4)},b.show();else if(void 0!==a.phone_status){a=a.phone_status;d="";b=Math.floor(a.battery_level);f=a.battery_is_charging;g=((new Date).getTime()-parseInt($.jStorage.get("ts_last_battery_alert_notif_shown",0)))/1E3;console.info("Num seconds since last battery alert notification on this CRX: "+g);if("true"==f)return console.log("phone is charging - no notification to consider, unless battery is at 100%"),99<b&&1500<g&&(void 0!==a.ts_phone_utc&&(a=a.ts_phone_utc/1E3,a=moment.unix(a).format("h:mm a"),
d="(as of "+a+")"),a=webkitNotifications.createNotification("img/battery-full.png","Phone Battery Charged","Your phone battery is fully charged. \r\n\r\n"+d),b=(new Date).getTime().toString(),$.jStorage.set("ts_last_battery_alert_notif_shown",b),a.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},3E4)},a.show()),!1;1500<g&&(10>=b||12==b||14==b||16==b)&&(void 0!==a.ts_phone_utc&&(a=a.ts_phone_utc/1E3,a=moment.unix(a).format("h:mm a"),d="(as of "+a+")"),a=webkitNotifications.createNotification("img/low_battery_48.png",
"Phone Battery Alert","Your phone battery is low: "+b+"%  "+d),b=(new Date).getTime().toString(),$.jStorage.set("ts_last_battery_alert_notif_shown",b),a.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},12E4)},a.show())}else void 0!==a.ack_processed?(a=a.ack_processed,b="message-status-text-msgid-"+a.id,a="outbox-message-msgid-"+a.id,null!=document.getElementById(b)&&(document.getElementById(b).innerHTML='<B>Phone Sent Message</B> <img style="margin-top:5px" src="checkmark-yes.png">'),
null!=document.getElementById(a)&&(document.getElementById(a).innerHTML='<B>Phone Sent</B> <img src="checkmark-yes.png">')):console.log("unknown incoming CAPI content")}var ntest;
function _340ffeb2cce12a992309240be3c867b51d83d969c8533ed5a9ae625839799f609aa5c765cb85d0f2(a,b){var c=b;if("GOOGLE_CONTACTS"==globalContactsSyncMethod){var d=[];0!=a&&(d=$.jStorage.get(a,"no-jstorage-val-found"));return c=d.name?d.name:b}d=[];b&&-1<b.indexOf("|")?d=b.split("|"):d.push(b);for(var e=d.length,f="",h=0;h<e;h++){b=d[h];a=_f9e48bde6455505d307dd76343e2400b2191c68547550ab77c8109a198985807ecb0f3750c3fad48(b,"do_not_zeropad");if("09999999999"==a)return"Unknown / Misc";c=$.jStorage.get(username_prefix_jstrg_purpose+
"|PC_"+a,"no-jstorage-val-found");c="no-jstorage-val-found"==c||void 0==c?b:c.contactName;f+=c;h<e-1&&(f+=", ")}return f}
function _3c6a5cf9f284956b7229a3a4584d989d295c160a98c9ff2ceccec916c79e7fbada1a6708cf6cbb1b(a,b){var c=b;"GOOGLE_CONTACTS"==globalContactsSyncMethod?(c=[],0!=a&&(c=$.jStorage.get(a,"no-jstorage-val-found")),c=c.name?c.name:b):(console.log("Attempt to get PHONE CONTACT for phone_num_clean: "+a),phoneContactObj=$.jStorage.get(username_prefix_jstrg_purpose+"|PC_"+a,"no-jstorage-val-found"),c="no-jstorage-val-found"==phoneContactObj||void 0==phoneContactObj?b:phoneContactObj.contactName);return c}
function _7d76ddf36b0b1264313277b12afec1a3a178c20294b4e2689e29a2f99fd6410af95bfaf3a2b891f3(a,b){var c="img/silhouette.jpg";if("GOOGLE_CONTACTS"==globalContactsSyncMethod){0!=a&&(d=$.jStorage.get(a,"no-jstorage-val-found"));d.name&&""!=d.thumbnail_image_google_base_url&&(c=d.thumbnail_image_google_base_url+"&oauth_token="+global_oauth_contacts_token);var d=[];0!=a&&(d=$.jStorage.get(a,"no-jstorage-val-found"));var e=[],e=$.jStorage.get("google_contacts_token","NONE");e.contacts_token_value&&(current_g_contacts_token=
e.contacts_token_value);d.thumbnail_image_google_base_url&&""!=d.thumbnail_image_google_base_url&&(console.log("thumbnail from jstorage is: "+d.thumbnail_image_google_base_url),c=d.thumbnail_image_google_base_url+"&oauth_token="+current_g_contacts_token)}else photoThumbnailObj=$.jStorage.get(username_prefix_jstrg_purpose+"|PH_PIC_"+a,"no-jstorage-val-found"),"no-jstorage-val-found"==photoThumbnailObj?(console.log("NO PHOTO LOCAL JSTORAGE MATCH FOR PHONE_NUM_CLEAN: "+a),c=chrome.extension.getURL("img/silhouette.jpg")):
"NO_PHOTO"!=photoThumbnailObj.contactThumbnailBinary&&2<photoThumbnailObj.contactThumbnailBinary.length&&(c="data:image/jpeg;base64,"+photoThumbnailObj.contactThumbnailBinary);return c}
function _06fbbf5befca69777d6c7458f0db99d19bc90ccff7f700e6fe18641bdb75cb645e4e436e0f1150f4(a,b){a=unescape(a);var c=b+"|"+a;console.log("attempting to mark message read on phone: "+a+"---  "+b);_6a667553a6f0e77821f58890e6cb823a4c6940c0c82dcbdb81cf57e43a90f3e5f6987c908282704d("mark_single_message_read",c,"msgid_local - not needed actually")}
function _2d97c66bd722628f019144f1ede26091a4d0da8216337e1fe0cbf02592d004824337be9763411cb2(a){80!=a.type&&83!=a.type&&70!=a.type||$.jStorage.set("most_recent_call_alert_info",a)}function _e3ee9d264e95d10350b9d29c1a8ce4a07bb7c01ab369160250386ad51d4c46ddf6bca9f06265e4cf(a){_647498c97de8ad97f1565bb1887ea2f11d6887cc6c9d4c93d040a158767032bb8f21db2f3e713cb2(a,quickTabExistsJustSwitchToExistingTab,popupQuickReplyWidget)}var popupQuickReplyWidget=function(a){_4513df2f7316180df2b697244fb8e9b49acf2211850f9209ee53be07ce3a1c91546480c89b4bb456UpperRight(a)};
function _af866832c7ca61b6fea2919c2ec37c4cbd7fee9aacff62fcaad12a5b226b85901415dc2b87cdce2e(){chrome.tabs.query({},function(a){for(var b=0,c;c=a[b];b++)console.log("Tab is: "+c.url),console.log(c)})}
function _647498c97de8ad97f1565bb1887ea2f11d6887cc6c9d4c93d040a158767032bb8f21db2f3e713cb2(a,b,c){chrome.tabs.query({},function(d){for(var e=0,f;f=d[e];e++)if(console.log("Tab is: "+f.url),-1<f.url.indexOf(a))return console.log("found it...stop looping through tabs"),b(f),"RETURN VAL - WAS FOUND";c(a)})}var quickTabExistsJustSwitchToExistingTab=function(a){console.log("TAB EXISTS - heres tab info URL");console.log(a.url);chrome.tabs.update(a.id,{active:!0})};
function _eb0c83b4b297091d96de8a921e569d95cb78fa4cbb02c36ce176c9526a89a7205f2bf3b28e272ee7(a){void 0===a&&(a="");chrome.tabs.getAllInWindow(void 0,function(b){for(var c=0,d;d=b[c];c++)if(console.log("Tab is: "+d.url),d.url&&_a5cc1e3e90cd35e8831045262fbddcee58e998c177ee5811f2dade91ac23b3b4312171caabc2eca2(d.url)){console.log("found MT tab, switching to it now...");console.log("index thing is: "+d.url.indexOf(a));b="";-1<d.url.indexOf("app")?b="app":-1<d.url.indexOf("IE-DEV")&&(b="IE-DEV");-1<d.url.indexOf(a)?
chrome.tabs.update(d.id,{active:!0}):chrome.tabs.update(d.id,{active:!0,url:"https://mightytext.net/"+b+a},_f2119a341f221638d7bbe2cce25e424760fb32747e66f65eb8ed95db490e03146c3b58d2fe9881e8);return}chrome.tabs.create({url:_533b2f24e060381fdcc043a5de53bc0c8b959063bf195fd5615c291726a797f89166ce0988c4dcd9()+a,active:!0})})}function _f2119a341f221638d7bbe2cce25e424760fb32747e66f65eb8ed95db490e03146c3b58d2fe9881e8(){}
function _f2119a341f221638d7bbe2cce25e424760fb32747e66f65eb8ed95db490e03146c3b58d2fe9881e82(){return!1}function _533b2f24e060381fdcc043a5de53bc0c8b959063bf195fd5615c291726a797f89166ce0988c4dcd9(){return"https://mightytext.net/app"}
function _a5cc1e3e90cd35e8831045262fbddcee58e998c177ee5811f2dade91ac23b3b4312171caabc2eca2(a){console.log("val is: "+(a.indexOf("https://mightytext.net/app")+a.indexOf("https://mightytext.net/dev")));return-1<a.indexOf("https://mightytext.net/app")||-1<a.indexOf("https://mightytext.net/web")?!0:!1}var notification_restart,notification_signed_out_must_be_global,capi_helper_global_login_state="UNKNOWN";
function _a31c33cb3b560d593f268f431a4678841f9876ba23dbf9cd89abc1ef31e7cf2005f405fe03bc6bde(){console.log(" ");console.log("------------------------------------------------ NEW POLL - HealthCheckCAPI -----------------------------------");console.log("webapp-loop at: "+Date()+" for user email -> "+google_username_currently_logged_in);_7f9d9cb78179943a68c663133638b646f93a67b359d7aabcf3e5314115200e775cb39ce5047a4880();console.log("user status is: "+extra_login_status_info+". . . Log In Status is: "+capi_helper_global_login_state);
body_text_to_send="CAPI_HEALTH_CHECK_FROM_CRX -- "+Date();$.ajax({url:baseUrl+"/test?function=capi&body="+body_text_to_send+"&phone_num=123456789",global:!1,type:"POST",dataType:"text",success:function(a){console.log(a);time_last_success_mighty_ping=new Date;-1!=a.search("user not logged in")?(console.log("User is not logged in to MightyText"),_f7fe87ed320246c60667cae03de8bab1fa5c31f8304e77a36f4e407d195f1c84feaf55034695bff0WebAppCRXHelper(!1),GLOBAL_CAPI_SOCKET_LAST_KNOWN_FOR_MANUAL_CLOSE_UPON_LOGOUT.close(),
"SIGNED_IN"==capi_helper_global_login_state&&(notification_signed_out_must_be_global=webkitNotifications.createNotification("img/mightytext_square_logo_48px.png","Signed Out of MightyText","You are now signed out."),notification_signed_out_must_be_global.show(),window.setTimeout(function(){notification_signed_out_must_be_global.cancel()},4E3)),capi_helper_global_login_state="SIGNED_OUT"):-1!=a.search("CAPI test sent successfully")&&(_34b6a1a2734b0f195116986f92b292067f092f80c1766016f621182564fa46f30bac4a76247a6f27(),
capi_helper_global_login_state="SIGNED_IN")}})}function _7bd9460cd935d0c2279899edc00273a027510ff93e029c1f953208b3b662e6972508520b8e3d3515(){webapp_crx_time_last_successful_health_check_received=new Date}
function _de5b3292f4582379201aac1e9eda554929ab4534d74ed0ffc830a45b9f43b69b1225cbc083632b36(a,b){window.localStorage.usingWebAppNew=1;_63ada17e679e155906da48b90166544b38c0e89ee38123702fc5dfb9779fb529636849ca095bbf9a();b&&console.log(b);b.user_token.accessToken?(globalContactsSyncMethod="GOOGLE_CONTACTS",console.log("YES - Google contacts token"),_0c73547e5017d69820ff9d0e75776ff88979cf106ba888cf74ed5fde8e002d79b801d43da5a4c6c4(),window.setInterval(function(){_0c73547e5017d69820ff9d0e75776ff88979cf106ba888cf74ed5fde8e002d79b801d43da5a4c6c4()},
33E5)):(console.log("no g contacts token"),_892e33d10d79e984019ec00bd1068441587561b89cdf9e637dcff3ba9792eef8044009e51da50d79("NO_CONTACTS_TOKEN"));_dc98c15ed566651e9e7eeda3ec77f48fa0916e97421dfc64eee5a73d3df19c8b32010292e737ce23()}
function _34b6a1a2734b0f195116986f92b292067f092f80c1766016f621182564fa46f30bac4a76247a6f27(){webapp_crx_globalUserSettingsUponCRXLoad&&(0==webapp_crx_globalUserSettingsUponCRXLoad.notif_toggle_on_off?chrome.browserAction.setIcon({path:"img/mightytext_square_logo_19px_notif_off.png"}):chrome.browserAction.setIcon({path:"img/19x19_MT_logo_boom_gradient_white.png"}))}
function _dc98c15ed566651e9e7eeda3ec77f48fa0916e97421dfc64eee5a73d3df19c8b32010292e737ce23(){$.ajax({url:baseUrl+"/usersettings?function=getUserSettings",global:!1,type:"POST",dataType:"json",success:function(a){a.usersettings.settings_list&&(webapp_crx_globalUserSettingsUponCRXLoad=jQuery.parseJSON(a.usersettings.settings_list.value),_34b6a1a2734b0f195116986f92b292067f092f80c1766016f621182564fa46f30bac4a76247a6f27())}})}
function _bb689d3ceb9782cdbf519137c2aabf39973e5304104b53c0450594c9b7026c8f3889cb2f351489c8(){for(var a="",b=0;5>b;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return a}function _f7fe87ed320246c60667cae03de8bab1fa5c31f8304e77a36f4e407d195f1c84feaf55034695bff0WebAppCRXHelper(a){a?chrome.browserAction.setIcon({path:"img/icon-19-on.png"}):chrome.browserAction.setIcon({path:"img/icon-19-off.png"})}
function _b19a68b17897145abe45ca8b6371c3cc323cd3d5bc1ffde913bba84e57c758320f6dd8baa3804bea(){var a=new Date;a.setDate((new Date).getDate());return a.toTimeString().substr(0,a.toTimeString().lastIndexOf(" "))+a.toLocaleTimeString().substr(a.toLocaleTimeString().lastIndexOf(" "))}
function _4513df2f7316180df2b697244fb8e9b49acf2211850f9209ee53be07ce3a1c91546480c89b4bb456UpperRight(a){var b,c;-1<a.indexOf("quick-reply")?(b=400,c=520):(b=500,c=600);chrome.windows.create({url:a,left:screen.width-(b+7),top:0,width:b,height:c,focused:!0,type:"popup"},function(a){})};
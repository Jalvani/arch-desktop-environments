function _417c0fac05873ac2d242b677cf58afa94d463d9b40204ddbcc55d9a54db86bb36f6dd0cb65a0b81eOrig(){oauth.authorize(function(){_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("on google contacts - oauth.authorize()");oauth.sendSignedRequest("http://www.google.com/m8/feeds/contacts/default/full",_fbd240ec1e2ef65000c2316e1b39392c5551f87c50e956261a608f2b0f011f1830bed0916518e165,{parameters:{alt:"json","max-results":1E4}})})}
chrome.browserAction.onClicked.addListener(function(a){_gaq.push(["_trackEvent","Popup","Initial-Load","",1]);_a905e88abd50a10498b9fce710f965e4d994e0b78fa4be629d32b5290689a65aee868e5d0a56ed51()});function _5f20670c9f7329ca3ef9f89b86a6250c2f8fe28e2ecba4a180983b8e073d2e64e063255e963a6515(){console.log("NON-WEBAPP-HEARTBEAT-CHECK");console.log("Current polling frequency is: "+poll_freq);checkLastMightyNetworkPing()}console.log("----------------- Starting Background Script ** -----------");
var globalHeartbeatInterval=setInterval(_5f20670c9f7329ca3ef9f89b86a6250c2f8fe28e2ecba4a180983b8e073d2e64e063255e963a6515,1E4);_gaq.push(["_trackEvent","Background","Startup-BG-Script","",1]);var token,time_last_channel_token_obtained=0,time_last_success_mighty_ping=new Date,globalContactsSyncMethod="SYNC_PHONE",username_prefix_jstrg_purpose,calling_from_chrome_extension=!0,capi_rollout_factor=3.8;console.log("capi rollout factor is "+capi_rollout_factor);
var GOOGLE_CONTACTS_OAUTH_STATUS="UNKNOWN",oauth=ChromeExOAuth.initBackgroundPage({request_url:"https://www.google.com/accounts/OAuthGetRequestToken",authorize_url:"https://www.google.com/accounts/OAuthAuthorizeToken",access_url:"https://www.google.com/accounts/OAuthGetAccessToken",consumer_key:"anonymous",consumer_secret:"anonymous",scope:"http://www.google.com/m8/feeds/",app_name:"MightyText - Contacts Sync"}),contacts_bkg_page=null,contacts_autocomplete_per_unique_phone_num=null,num_consecutive_internet_connection_failures=
0,notify_android_app_install_once=!1,debug_mode=1;_ab7936a60bf11f63c721faf4b0b61b40aaebc57684849d21ff18ca69d36c32ed1933a08781b7b57a(!1);var google_login_status=!1,google_username_currently_logged_in="",login_and_beta_ready=!1,extra_login_status_info="";_caabc07ee50bca89924e94a4358c5d4c6afa52f087a58831a3f052f220a9e6dff87a7cad0d1052ab();var GOOGLE_CONTACTS_OAUTH_STATUS="UNKNOWN",should_get_contacts_token_in_new_tab=!0;
_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("Google Contacts Token Status: "+GOOGLE_CONTACTS_OAUTH_STATUS);function _caabc07ee50bca89924e94a4358c5d4c6afa52f087a58831a3f052f220a9e6dff87a7cad0d1052ab(){window.setTimeout(function(){_a02d3d4c3064ddbce693dc03846c41cb301b9f3f31a306277138ee8b6a782597c5f7958be3e38236(1,!0)},300)}
function _fbd240ec1e2ef65000c2316e1b39392c5551f87c50e956261a608f2b0f011f1830bed0916518e165(a,b){contacts_bkg_page=[];contacts_autocomplete_per_unique_phone_num=[];for(var c=JSON.parse(a),k=0,d;d=c.feed.entry[k];k++){var e={name:d.title.$t,id:d.id.$t,emails:[],phonenums:[]},l={label:d.title.$t,value:""};if(d.gd$email)for(var h=d.gd$email,g=0,f;f=h[g];g++)e.emails.push(f.address);e.name||(e.name=e.emails[0]||"<Unknown>");if(d.gd$phoneNumber)for(h=d.gd$phoneNumber,g=0;g<h.length;g++)f=h[g],e.phonenums.push(f.$t),
l.label=e.name+" "+f.$t,l.value=f.$t,contacts_autocomplete_per_unique_phone_num.push({label:e.name+" "+f.$t,value:f.$t});d.gd$phoneNumber&&contacts_bkg_page.push(e)}}function _283a9fa4d0d39c41e6b54eacc8021774817350e4a31fce4c50571a0517d39099313b8138a047c534GoogleOpenID(){oauth.clearTokens();_ab7936a60bf11f63c721faf4b0b61b40aaebc57684849d21ff18ca69d36c32ed1933a08781b7b57a(!1)}var msgcount="",simplevalidation="",db,msgcount2="",msgList="",PendingSMSArray=[];
chrome.extension.onRequest.addListener(function(a,b,c){_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528(b.tab?"from a content script:"+b.tab.url:"from the extension");"user_invoked_popup_so_force_google_login_check"==a.purpose&&(console.log("* User Clicked Popup icon in extension**  Now check if a user is logged in already"),console.log(extra_login_status_info),"WEBAPP_BETA"==extra_login_status_info?console.log("This is a new web app user. Don't do anything extra (dont call checkGoogleLoginTokenAndSetUsername)"):
(console.log("user does not have extra_login info set - so likely not signed in before, so check if they are now"),_a02d3d4c3064ddbce693dc03846c41cb301b9f3f31a306277138ee8b6a782597c5f7958be3e38236()),c({reply:"success"}))});
chrome.extension.onRequest.addListener(function(a,b,c){_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528(b.tab?"from a content script:"+b.tab.url:"from the extension");"call_from_popup_to_check_contact_info"==a.greeting&&(should_get_contacts_token_in_new_tab=!1,_417c0fac05873ac2d242b677cf58afa94d463d9b40204ddbcc55d9a54db86bb36f6dd0cb65a0b81e(),c({farewell:contacts_bkg_page,autocomplete_contacts_list:contacts_autocomplete_per_unique_phone_num,google_contacts_token_status:GOOGLE_CONTACTS_OAUTH_STATUS}))});
chrome.extension.onRequest.addListener(function(a,b,c){_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528(b.tab?"from a content script:"+b.tab.url:"from the extension");"get_new_g_contacts_token_call_from_popup"==a.purpose&&(should_get_contacts_token_in_new_tab=!0,_417c0fac05873ac2d242b677cf58afa94d463d9b40204ddbcc55d9a54db86bb36f6dd0cb65a0b81eOrig(),c({myreply:"yo yo"}))});
chrome.extension.onRequest.addListener(function(a,b,c){_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528(b.tab?"from a content script:"+b.tab.url:"from the extension");"popup_checking_current_google_login_state"==a.purpose&&c({google_login_status_from_bg_page:google_login_status,login_and_beta_ready_from_bg_page:login_and_beta_ready,google_username_currently_logged_in_from_bg_page:google_username_currently_logged_in,extra_login_status_info_from_bg_page:extra_login_status_info})});
chrome.extension.onRequest.addListener(function(a,b,c){_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528(b.tab?"from a content script:"+b.tab.url:"from the extension");"set_quick_polling_outbound_message"==a.purpose&&(_28680617afebc3b891b4ebc51d8b079b3adc5ad9239c464dd6c4acd91a8d820af0ec41071cb8f701("Outbound Message being sent, lower polling to check for ACK faster",2E3),c({myreply:"sent request to set polling to 2000"}))});
function _43b3364ac2dbb9c8957b01fabfdc1b8c71332e75d5759c2495f730727f0b8ba13b00faaca7f7a2dc(a,b){}function _11e84fe6a8b381d0fdb826c02b2bb73cb0376f861df377db79951b0836f12a9234812c2dfbe6b282(a,b){log.innerHTML+="<p>"+b.message+"</p>"}function OLD__1a3c6704744af98a35a3a473f3b817d90988125e5ecc40eea2154c3a305b55857a152c80f05d5668(a,b){_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("Error during SQL insert: "+b.msg)}
var default_poll_freq=17E3,highest_poll_freq=7E4,poll_freq=default_poll_freq,consecutive_polls_without_message_activity=0,total_aggregate_polls=0,poll_state="START";db=openDatabase("Texty","1.0","Texty-SMS",2E5);localStorage.isInitialized||(localStorage.isActivated=!0,localStorage.frequency=1,localStorage.isInitialized=!0);_2f63ce5f7c0efdf707922f226024de63762b0b1502fd9a2a469391caf4507fcfba0ffbbdfa6ebd5b();
if(webkitNotifications){var interval=0,currentGlobalIntervalID=setInterval(_da253c7ba78480482cac9d7878922a2c0e1f9d2afa6a8fbff4ace1f1bddfde9d6960dabb9ca87f0e,poll_freq);_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("STARTUP --  ** Setting polling to: "+poll_freq)}else chrome.tabs.create({url:"error.html"});
function _da253c7ba78480482cac9d7878922a2c0e1f9d2afa6a8fbff4ace1f1bddfde9d6960dabb9ca87f0e(){interval++;JSON.parse(localStorage.isActivated)&&localStorage.frequency<=interval&&(consecutive_polls_without_message_activity++,total_aggregate_polls++,_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("------------------------------------------------"),_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("At START of POLL at "+Date()),_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("Poll State is: "+
poll_state),_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("Current polling frequency is: "+poll_freq),_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("# of consecutive polls without activity is: "+consecutive_polls_without_message_activity),_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("TOTAL AGGREGATE POLLS: "+total_aggregate_polls),_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("Google Login Status is: "+
google_login_status),4<consecutive_polls_without_message_activity&&"OK-NORMAL"==poll_state&&_28680617afebc3b891b4ebc51d8b079b3adc5ad9239c464dd6c4acd91a8d820af0ec41071cb8f701("*No new incoming message Activity in a while...increase polling freq...",Math.min(highest_poll_freq,1.05*poll_freq)),!0==google_login_status&&!0==network_connection_status&&!0==login_and_beta_ready?(_017ace14d4a6fe9725cd64fd3e11ea3dfabdb84bf304e52272af70b9c02bdec46876d60317ece936(),"OK-NORMAL"!=poll_state&&(poll_state="OK-NORMAL",
console.log("stopping this Interval and restarting to default - g user logged in ...setting poll frequency to DEFAULT"),poll_freq=default_poll_freq*capi_rollout_factor,interval=0,clearInterval(currentGlobalIntervalID),window.setInterval(function(){_da253c7ba78480482cac9d7878922a2c0e1f9d2afa6a8fbff4ace1f1bddfde9d6960dabb9ca87f0e()},poll_freq))):(console.log("user not logged in -- reason is "+google_username_currently_logged_in),_a02d3d4c3064ddbce693dc03846c41cb301b9f3f31a306277138ee8b6a782597c5f7958be3e38236(),
_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("Network Connection Status: "+network_connection_status),!1==network_connection_status?(poll_state="WAITING-FOR-NETWORK",_28680617afebc3b891b4ebc51d8b079b3adc5ad9239c464dd6c4acd91a8d820af0ec41071cb8f701("Waiting for Network",2E4)):"WAITING-FOR-USER-PROPER-AUTH"!=poll_state&&(poll_state="WAITING-FOR-USER-PROPER-AUTH",_28680617afebc3b891b4ebc51d8b079b3adc5ad9239c464dd6c4acd91a8d820af0ec41071cb8f701("Waiting for proper User Auth",
4E4))))}
function _28680617afebc3b891b4ebc51d8b079b3adc5ad9239c464dd6c4acd91a8d820af0ec41071cb8f701(a,b){console.log(a+"...Stopping this Interval and resetting Polling...setting poll frequency to "+b);poll_freq=b;poll_freq*=capi_rollout_factor;console.log("ACTUALLY setting to "+poll_freq+"...based on CAPI rollout factor of "+capi_rollout_factor);clearInterval(currentGlobalIntervalID);consecutive_polls_without_message_activity=0;currentGlobalIntervalID=window.setInterval(function(){_da253c7ba78480482cac9d7878922a2c0e1f9d2afa6a8fbff4ace1f1bddfde9d6960dabb9ca87f0e()},poll_freq)}
function _017ace14d4a6fe9725cd64fd3e11ea3dfabdb84bf304e52272af70b9c02bdec46876d60317ece936(){_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("Checking MightyText at "+Date());_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("google_login_status is: "+google_login_status);_ed094677ed93178f033abb9f442bef592f232e1c50e2a8b991f3f224dee35ff9affc20e51c58e706(!0);_76b808798c66da171a9fb80b5634f0f3df2289b760af4a8217229e9bdfe76a44e5e4b81261ffa009()}
function checkLastMightyNetworkPing(){var a=((new Date).getTime()-time_last_success_mighty_ping.getTime())/1E3;_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("--------------\x3e Seconds Since LAST MightyText network ping: "+a);360<a&&(console.error("---\x3e has been a long time since last MT ping -- try to contact google.com first"),$.ajax({type:"GET",url:"https://accounts.google.com/latitude/mobile_phone-16.gif",cache:!1,success:function(a){console.log("Network ping to Google -- fine...");
_gaq.push(["_trackEvent","CRX-Background","Error","Forced-Reload-CRX",1]);console.log("google login status is true -- will reload CRX BG in 10 seconds");window.setTimeout(function(){window.location.reload()},1E4)}}))}
function _76b808798c66da171a9fb80b5634f0f3df2289b760af4a8217229e9bdfe76a44e5e4b81261ffa009(){if(0==time_last_channel_token_obtained)console.log("no channel opened yet in this session, go open one"),_4f81adb24009bfd6e9fb7d1a54b09f4dd8af4cba81c7b502b01aeb2a606e580d3c01e852e0c988e5();else{var a=((new Date).getTime()-time_last_channel_token_obtained.getTime())/1E3;_9fee5110996487c12e15f4583e83702e4af6ce6e0b1ea91d44be154a5ee3041cc94b172fa6647528("Seconds Since LAST CHANNEL TOKEN OBTAINED: "+a);13500<a?
(console.log("has been > 3.75 hours, get a new channel token"),_4f81adb24009bfd6e9fb7d1a54b09f4dd8af4cba81c7b502b01aeb2a606e580d3c01e852e0c988e5()):console.log("has NOT been > 3.75 hours since last CAPI channel token was retrieved, no need to get a new one.")}}function _c15c787bf71f1ac6b9756a1e9ec79cd1a1a367866900f96898d712178c88e3e019fe1e8ac92332d4(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}
function _7336f88656dada98b9a8fc626172e583d6191a68a2dfc37a565ef4373b724e90a55235e35b18d471(a,b){console.log(a);var c="";a.mediaType&&(c=a.mediaType);_gaq.push(["_trackEvent","CRX-ContextMenu","Context-Menu-Click",c]);console.log(a);"image"==c&&(c="",c=a.srcUrl,1E3<c.length&&alert("Unable to send this photo to your phone.\r\n\r\nImage payload is too large (likely a base-64 image)"),body="AAA",action_data=body+"||"+c,_f32e31e48d857b015de9bb06c3959667202be5685f599cb178b9b0a47cb3bec9fffe20189561247d("fetch_binary_from_url_store_on_device",
action_data))}var currentCRXVersion=chrome.runtime.getManifest().version;function _5bad70bfa10def08ed9c6f23f1d94a58f0dda25d3dfdef7a9cda3c74ebe5a475ac569f6afc48c6ca(){chrome.contextMenus.remove("contextmenu-send-image",function(){chrome.contextMenus.create({id:"contextmenu-send-image",title:" Send this image to my phone",type:"normal",contexts:["image"],onclick:_7336f88656dada98b9a8fc626172e583d6191a68a2dfc37a565ef4373b724e90a55235e35b18d471})})}
function _356feb6a289f7f8ee3113b1aa2da344495926db8140c5b200307222070d26992ffa81976bb3c46b0(){var a=[];a["10.2"]=[];a["10.2"].headline="New! Instantly send pictures from your computer to your phone";a["10.2"].body="\r\nJust right-click on an image on any web page and select 'Send Image to your Phone' and you will see it on your phone instantly.\r\n ";a[currentCRXVersion]&&("1"==$.jStorage.get("news_"+currentCRXVersion,"no-news-shown-yet")?console.log("news for this version has already been seen"):
(a=new Notification(a[currentCRXVersion].headline,{icon:"img/128x128_MT_logo_boom_gradient_white.png",body:a[currentCRXVersion].body}),a.onshow=function(a){$.jStorage.set("news_"+currentCRXVersion,"1");setTimeout(function(){a.currentTarget.cancel()},6E4)},a.show()))};
var notification_html_webapp_new,webapp_capi_health_check_string_to_match,healthCheckArrayPending=[],webapp_crx_time_last_channel_token_obtained=0,webapp_crx_time_last_successful_health_check_received=0,webapp_crx_globalUserSettingsUponCRXLoad,ts_last_battery_alert_notif_invoked=0;window.setTimeout(function(){_db728151cf89d8c348ec530b2a0402d415286ab8ff28cccb3dc379d2dbc18d94136fbecc95b58bd0()},0);
function _db728151cf89d8c348ec530b2a0402d415286ab8ff28cccb3dc379d2dbc18d94136fbecc95b58bd0(){var a=document.body.appendChild(document.createElement("iframe"));a.src="https://mightytext.net/prod-assets/chrome_ext_heartbeat";a.height=0;a.onload=function(){console.log("set localstorage of CRX alive via iframe")}}function _7bfb34c10f2e3f6cfe1cf62b15976a086371680a453a4f9a6954c7e1987ed1e99043b99f10c4fa90(){}
function _1e3e3cd374d4d2ee9d86c92383195e249a1cc6e1d2bab5966662199b3370f9e580fc0fb3da6b57e1(){for(var a="",b=0;5>b;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return a}function _c15c787bf71f1ac6b9756a1e9ec79cd1a1a367866900f96898d712178c88e3e019fe1e8ac92332d4(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}
function _6c63a2becc72714faef43e5dc14807e129769afdc9db045496fa8414407c952f8cd040450ab05d1d(){checkLastMightyNetworkPing();_dd1d2c85a777ac30c6c986e125540ddc71f7f737dee7f6d337cc448a666e1f7ed91fe7d14094bd95();_e4e75f3baf53c5764ca0dd0a8d9e64d254ca111aa0a9980a2b2b56651a64cd98df83af7670010128();console.log("-------------------------\x3e Heartbeat WEBAPP USER @ "+Date()+" ###")}
function _e4e75f3baf53c5764ca0dd0a8d9e64d254ca111aa0a9980a2b2b56651a64cd98df83af7670010128(){var a=((new Date).getTime()-webapp_crx_time_last_successful_health_check_received.getTime())/1E3;console.log(" ");console.info("Seconds Since LAST SUCCESSFUL INCOMING CAPI: "+_c15c787bf71f1ac6b9756a1e9ec79cd1a1a367866900f96898d712178c88e3e019fe1e8ac92332d4(a,2)+" ("+_c15c787bf71f1ac6b9756a1e9ec79cd1a1a367866900f96898d712178c88e3e019fe1e8ac92332d4(a/60,2)+" minutes)");300<a&&_783d46009a471816b33aee333a69e697168d316a9bbb0e9f6aa4fa8ddb8c56c9b75384fcfed87cbb();
480<a?(_gaq.push(["_trackEvent","CRX-Background","CRX-Restart","HealthCheck-PreEmptive-Restart",1]),console.log("ALERT! has been >8 minutes since last incoming CAPI. Will RESTART CRX in 5 seconds . . ."),window.setTimeout(function(){window.location.reload()},5E3)):console.log("----- has NOT been > 8 minutes since last incoming CAPI -- OK");console.log(" ")}var global_count_request_phone_status=0;
function _c478d3e40f2a0bdb75cfdcbe85c3303e5c0cbe7a7afdb46062b646ac4180ed51ff794beace10f8da(){global_count_request_phone_status++;1E3>global_count_request_phone_status?_f32e31e48d857b015de9bb06c3959667202be5685f599cb178b9b0a47cb3bec9fffe20189561247d("get_phone_status","check-phone-status-not-needed"):alert("Error CRX-PSTUS50 \r\n \r\n If this continues please notify MightyText team at info@mightytext.net")}
function _f32e31e48d857b015de9bb06c3959667202be5685f599cb178b9b0a47cb3bec9fffe20189561247d(a,b,c){b=baseUrl+"/client?function=send&deviceType=ac2dm&source_client=31&action="+a+"&action_data="+b;c&&(b+=c);console.log("send url for Custom C2DM is: "+b);$.ajax({url:b,global:!1,type:"POST",xhrFields:{withCredentials:!0},data:"",dataType:"text",success:function(b,c,f){console.log(b);-1<b.search("sent to phone")?"fetch_binary_from_url_store_on_device"==a&&alert("Image sent to phone."):_bbfdf6c0173e8d54ffa5def9aa6a01918b81e3388fedfac0bc2c827ffa61c6382506af20a5c87276(a,
b)},error:function(a,b,c){console.log("Error in C2DM: "+c);console.log("Error details: "+c.error)}})}
function _bbfdf6c0173e8d54ffa5def9aa6a01918b81e3388fedfac0bc2c827ffa61c6382506af20a5c87276(a,b,c){a="";-1<b.indexOf("LOGIN_REQUIRED")?(_gaq.push(["_trackEvent","CRX","C2DM-Error","LOGIN_REQUIRED",1]),a="Error: Not logged in to MightyText."):-1<b.indexOf("DEVICE_NOT_REGISTERED")?(_gaq.push(["_trackEvent","CRX","C2DM-Error","DEVICE_NOT_REG",1]),a="Error: Android Phone not registered with MightyText with this Google Account, or MightyText Android App not installed properly on your phone."):-1<b.indexOf("DeviceQuotaExceeded")?
(_gaq.push(["_trackEvent","CRX","C2DM-Error","DEVICE_QUOTA_EXCEEDED",1]),a="Android Phone Quota Exceeded.  Error Code: DeviceQuotaExceeded (C2DM)"):(a="C2DM/GCM Error.  Please retry. \r\n\r\n Error Info: \r\n\r\n"+b,_gaq.push(["_trackEvent","CRX","C2DM-Error","GENERAL C2DM ERROR",1]));alert(a)}
function _dd1d2c85a777ac30c6c986e125540ddc71f7f737dee7f6d337cc448a666e1f7ed91fe7d14094bd95(){var a=((new Date).getTime()-webapp_crx_time_last_channel_token_obtained.getTime())/1E3;console.log(" ");console.info("Seconds Since LAST CHANNEL TOKEN OBTAINED: "+_c15c787bf71f1ac6b9756a1e9ec79cd1a1a367866900f96898d712178c88e3e019fe1e8ac92332d4(a,2)+" ("+_c15c787bf71f1ac6b9756a1e9ec79cd1a1a367866900f96898d712178c88e3e019fe1e8ac92332d4(a/60,2)+" minutes)");13500<a?(_gaq.push(["_trackEvent","Background","CAPI-PreEmptive-Restart-1_75hrs",
"",1]),console.log("has been > 3.75 hours, get a new channel token"),window.location.reload()):console.log("has not been > 3.75 hours since last CAPI channel token was retrieved, no need to get a new one.");console.log(" ")}var GLOBAL_CAPI_SOCKET_LAST_KNOWN_FOR_MANUAL_CLOSE_UPON_LOGOUT;
function _14338f3ad3fd62a961bc069d95840d95a37dc7ca811b716801e30a21ca9a86f6a5edae8a0c25d739(){console.log(".");console.log("Getting channel API token . . . for client_id_name=CRX-Notif");$.ajax({type:"GET",url:baseUrl+"/getJson?function=getChannelTokenForWebApp&client=CRX_WEBAPP&mins=120",success:function(a){console.log("Response from cloud after channel attempt (should have valid_token prepend): "+a);healthCheckArrayPending=[];time_last_success_mighty_ping=new Date;_b5433d358c9982389ff62d47e0725dc7663e00e3404c76df4e484718088a75ffa6b33b6c9f304452();
if(0>a.search("valid_token:"))console.error("No valid_token prepend found from Channel API!");else{a=a.replace("valid_token:","");var b=(new goog.appengine.Channel(a)).open();GLOBAL_CAPI_SOCKET_LAST_KNOWN_FOR_MANUAL_CLOSE_UPON_LOGOUT=b;b.onopen=function(){webapp_crx_time_last_channel_token_obtained=new Date;time_last_success_mighty_ping=new Date;console.log("Socket Opened via Channel API with token id: "+a);console.log("Current time.. - when channel API new socket is opened : "+Date());console.log("-------------------------------");
window.setTimeout(function(){_783d46009a471816b33aee333a69e697168d316a9bbb0e9f6aa4fa8ddb8c56c9b75384fcfed87cbb()},2E3);_gaq.push(["_trackEvent","Background","ChannelAPI-Open-Socket","",1])};b.onmessage=function(a){_gaq.push(["_trackEvent","Background","ChannelAPI-Message-Received","",1]);console.info("**** CHANNEL SOCKET ONMESSAGE *** ");console.log("Message arrived via channel API= "+a.data);time_last_success_mighty_ping=new Date;_73108e8d39bba488f8c8cb17422200fd20daa46c0cfcaa9fa82deef63570f0d25f329a0e84746089(a.data)};
b.onerror=function(a){console.error("CAPI ONError called - msg from GCAPI is: "+a);_gaq.push(["_trackEvent","Background","ChannelAPI-Socket-ONERROR","",1])};b.onclose=function(a){console.error("!!!!!!!!!!!!! TOKEN GONE - probably expired (via onclose callback) !!!!!!!!!!!!");_gaq.push(["_trackEvent","Background","ChannelAPI-Socket-ONCLOSE","",1]);_14338f3ad3fd62a961bc069d95840d95a37dc7ca811b716801e30a21ca9a86f6a5edae8a0c25d739()}}}}).responseText}var globalNotifArray=[];
function _40a8b8ec12a9a44266e2fcc2b60a4de8033242f4dffc8f0578b9d3fbcb0046c7d5b4c9fbb05e8e75(){console.log("**** IN REMOVE TOP NOTIF FUNCTION ***");var a=globalNotifArray.shift(this);a.onclose=function(a){console.log("unsetting notification onclose event so it doesnt get marked as read by phone when auto-dismissing!")};a.cancel()}
function _252233f7c20f79b6ca5f6fd7c589a1f40d53a98adb82738386eaf0a636595a397e94ffefeb81ac8e(a){if(3>a.replace(/[^%]/g,"").length)return a;a=a.replace(/\+/g,"%20");return a=decodeURIComponent(a)}var globalNewNotifMetadata={};
function _0931b95c6daf520622a27377fb8d627b67c208b1b5883dc5a6e6b2ff4594aa6ca86cf5739a5ab5e2(a){chrome.notifications.clear(a,function(a){});var b;-1<a.indexOf("-picture")?(b=a.replace("-picture",""),b="https://mightytext.net/web/#mode=quick&num="+globalNewNotifMetadata[b].phone_num):b=80==globalNewNotifMetadata[a].type||81==globalNewNotifMetadata[a].type?"https://mightytext.net/web/#mode=quick&num="+globalNewNotifMetadata[a].phone_num:"https://mightytext.net/web/#mode=quick&msgid="+globalNewNotifMetadata[a].id;
_c4400ccf29ec9df83948d09a78e41846312666763cae1fe66cc66ca77cc5ecfd4e7b816344ed1207(b);_9ea67058dbe492adb3b3aaff9d345d4b254b175ce3948c54877ad29c0e00f1abf2a0a1f92c955332(globalNewNotifMetadata[a].body,globalNewNotifMetadata[a].phone_num_clean)}
function _df2508307ac2d1cf8efb9659e15557fb76e0d6af0104cf3b45056589309effd4d0889e430018b490(a){console.log(globalNewNotifMetadata[a]);var b=new Date;b.getHours();b.getMinutes();-1==globalNewNotifMetadata[a].body.indexOf("reminded")&&(globalNewNotifMetadata[a].body=globalNewNotifMetadata[a].body+"' \r\n\r\n(First reminded at "+_0c800fd990afaa098e2b4c4a8e59f273d3cdb66372a63f72e856d8ded49ee65077238a4ec8b5b453DisplayPurposesOnlyTimeNoDay(b,!1)+")");a='{"new_content":'+JSON.stringify(globalNewNotifMetadata[a],
null,2)+"}";console.log(a);_73108e8d39bba488f8c8cb17422200fd20daa46c0cfcaa9fa82deef63570f0d25f329a0e84746089(a)}
chrome.notifications.onButtonClicked.addListener(function(a,b){0==b?(_gaq.push(["_trackEvent","CRX-Background","Notif-Click","Reply-Button-Action"]),_0931b95c6daf520622a27377fb8d627b67c208b1b5883dc5a6e6b2ff4594aa6ca86cf5739a5ab5e2(a)):1==b&&chrome.notifications.clear(a,function(b){if(b)if(10==globalNewNotifMetadata[a].type||20==globalNewNotifMetadata[a].type)-1<globalNewNotifMetadata[a].body.indexOf("reminded")?_gaq.push(["_trackEvent","CRX-Background","Notif-Click","Snooze-Button-Action-REPEAT"]):
_gaq.push(["_trackEvent","CRX-Background","Notif-Click","Snooze-Button-Action-INITIAL"]),window.setTimeout(function(){_df2508307ac2d1cf8efb9659e15557fb76e0d6af0104cf3b45056589309effd4d0889e430018b490(a)},3E5);else if(11==globalNewNotifMetadata[a].type||21==globalNewNotifMetadata[a].type)_c400be8a9c4d139cf7cfdcc6877a3443baeb73c82ac41c08070136e89fac51fcb901c5719ed07b1c(a),_gaq.push(["_trackEvent","CRX-Background","Notif-Click","MMS-Picture-Enlarge-Button-Action"])})});
function _c400be8a9c4d139cf7cfdcc6877a3443baeb73c82ac41c08070136e89fac51fcb901c5719ed07b1c(a){globalNewNotifMetadata[a].enlargeMMSMode=1;a='{"new_content":'+JSON.stringify(globalNewNotifMetadata[a],null,2)+"}";_73108e8d39bba488f8c8cb17422200fd20daa46c0cfcaa9fa82deef63570f0d25f329a0e84746089(a)}
chrome.notifications.onClicked.addListener(function(a){var b=globalNewNotifMetadata[a].type;if(-1<a.indexOf("-picture")||81==b||80==b)return!1;_0931b95c6daf520622a27377fb8d627b67c208b1b5883dc5a6e6b2ff4594aa6ca86cf5739a5ab5e2(a);_gaq.push(["_trackEvent","CRX-Background","Notif-Click","Reply-Click-On-Notif-Itself"])});
chrome.notifications.onClosed.addListener(function(a,b){if(-1<a.indexOf("-picture"))return!1;b&&_9ea67058dbe492adb3b3aaff9d345d4b254b175ce3948c54877ad29c0e00f1abf2a0a1f92c955332(globalNewNotifMetadata[a].body,globalNewNotifMetadata[a].phone_num_clean)});
function _73108e8d39bba488f8c8cb17422200fd20daa46c0cfcaa9fa82deef63570f0d25f329a0e84746089(a){webapp_crx_time_last_successful_health_check_received=new Date;var b=!1;a=jQuery.parseJSON(a);if(void 0!==a.new_content)if(a=a.new_content,-1<a.body.search("CAPI_HEALTH_CHECK"))_76721b73dc49ce599f4f38e6a95ba89ac054cca17f44ffc0fbedad9597d4942064abd85d65074516();else if(-1<a.body.search("USER_UPDATED_SETTINGS_IN_WEBAPP"))_03e7bf0ba58f53fc8de37a904c021692481b7d49d9659142a01fdf451759c15c1553a8d5a5b91b11();else if(webapp_crx_globalUserSettingsUponCRXLoad&&
0==webapp_crx_globalUserSettingsUponCRXLoad.notif_toggle_on_off)console.log("*** DONT POPUP NOTIFICATION - USER PREFERENCE");else{if(webapp_crx_globalUserSettingsUponCRXLoad&&1==webapp_crx_globalUserSettingsUponCRXLoad.notif_content&&(b=!0),61!=a.inbox_outbox&&84!=a.type&&85!=a.type){var c="",d="",e="",f=_252233f7c20f79b6ca5f6fd7c589a1f40d53a98adb82738386eaf0a636595a397e94ffefeb81ac8e(a.body);10==a.type?(c="",d=f,e="SMS"):11==a.type?void 0!==a.mms_object_key?(c="Picture Message from ",d=f):(c="MMS from ",
d="Image is downloading on phone...",e="MMS"):20==a.type?(c="Group text from ",d=f,e="GroupText"):21==a.type?(c="Group text & picture from ",d=f,e="GroupText"):80==a.type?c="Incoming Call from ":81==a.type&&(c="Missed Call from ");var h="",g="https://mightytext.net/app/Misc-Buddy-Blue-icon.png",h=_71a5dca7ae1a136e8dbd4d1538c61f697a68723d6487089d0f07adf445e02e664b1284f8a94092c0(a.phone_num_clean,a.phone_num),g=_d8e3d0472be5b876b55f0cacd4cc1c3a29063a8da45281cb08f301eeec1a0db6d188520774c9bbb1(a.phone_num_clean,
a.phone_num);""!=e&&_kmq.push(["record","Incoming-Message",{Type:e,Client:"CRX"}]);b&&void 0==a.enlargeMMSMode&&(d="Click to see message...");f=3E4;webapp_crx_globalUserSettingsUponCRXLoad&&webapp_crx_globalUserSettingsUponCRXLoad.notif_dismiss_time?f=1E3*webapp_crx_globalUserSettingsUponCRXLoad.notif_dismiss_time:console.log("No Setting found - NOTIF DISMISS TIME - set to default....");console.log("setting notif_dismissal_time to: "+f);globalNewNotifMetadata[a.id]=a;c+=h;h=d+"\r\n\r\n"+_0c800fd990afaa098e2b4c4a8e59f273d3cdb66372a63f72e856d8ded49ee65077238a4ec8b5b453DisplayPurposesOnlyTimeNoDay(a.ts_server,
!0);e="Reply";if(20==a.type||21==a.type)g=_c8fc9058d7c18b9c6b3b026df2cc1f9648b5940d30300cf3e152e70679acbf4b36af0ebadb2607ee(a.content_author,!0),e=_71a5dca7ae1a136e8dbd4d1538c61f697a68723d6487089d0f07adf445e02e664b1284f8a94092c0(g,a.content_author),g=_d8e3d0472be5b876b55f0cacd4cc1c3a29063a8da45281cb08f301eeec1a0db6d188520774c9bbb1(g,a.content_author),c="Group message from\r\n"+e,e=_ca99ad7049458d90917657a5db89927e651b472b7a69970aa1f552e3142d5294b237487bfd29cb1c("N/A",a.phone_num),h=d+"\r\n\r\n("+
e+")",e="GroupText",e="Reply to group";secondButtonTitle="Remind me in 5 minutes";secondButtonActionIconURL="img/alarm_bell_snooze-48.png";if(11==a.type||21==a.type)b||(g=baseUrl+"/imageserve?function=fetchFile&id="+a.id),secondButtonTitle="View full-size picture",secondButtonActionIconURL="img/photoview_32.png";if(80==a.type||81==a.type)e="Send text message";b={type:"basic",title:c,message:h,priority:2,eventTime:Date.now(),iconUrl:g,buttons:[{title:e,iconUrl:"img/Reply-256.png"},{title:secondButtonTitle,
iconUrl:secondButtonActionIconURL}]};if(void 0!==a.enlargeMMSMode)b={type:"image",title:c,message:h,iconUrl:g,priority:2,eventTime:Date.now(),imageUrl:baseUrl+"/imageserve?function=fetchFile&id="+a.id,buttons:[{title:e,iconUrl:"img/Reply-256.png"}]},chrome.notifications.create(a.id+"-picture",b,function(){});else{var k=a.id;console.log(b);chrome.notifications.create(k,b,function(a){});window.setTimeout(function(){chrome.notifications.clear(k,function(a){})},f)}}}else if(void 0!==a.initial_mms_wakeup)b=
a.initial_mms_wakeup,d=_c8fc9058d7c18b9c6b3b026df2cc1f9648b5940d30300cf3e152e70679acbf4b36af0ebadb2607ee(b.content_author,!0),a=_71a5dca7ae1a136e8dbd4d1538c61f697a68723d6487089d0f07adf445e02e664b1284f8a94092c0(d,b.content_author),d=_d8e3d0472be5b876b55f0cacd4cc1c3a29063a8da45281cb08f301eeec1a0db6d188520774c9bbb1(d,b.content_author),f="",f=20==b.type?"Incoming Group Message from "+a+"...":"Incoming Picture Message from "+a+"...",b=webkitNotifications.createNotification(d,f,""),b.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},
1E4)},b.show();else if(void 0!==a.phone_status){a=a.phone_status;d="";b=Math.floor(a.battery_level);f=a.battery_is_charging;g=((new Date).getTime()-parseInt($.jStorage.get("ts_last_battery_alert_notif_shown",0)))/1E3;console.info("Num seconds since last battery alert notification on this CRX: "+g);if("true"==f)return console.log("phone is charging - no notification to consider, unless battery is at 100%"),99<b&&7200<g&&(void 0!==a.ts_phone_utc&&(a=a.ts_phone_utc/1E3,a=moment.unix(a).format("h:mm a"),
d="(as of "+a+")"),a=new Notification("Phone Battery Charged",{icon:"img/battery-full.png",body:"Your phone battery is fully charged. \r\n\r\n\r\n"+d,tag:"phone-battery-full-charged"}),b=(new Date).getTime().toString(),$.jStorage.set("ts_last_battery_alert_notif_shown",b),a.onshow=function(a){setTimeout(function(){a.currentTarget.cancel()},6E4)},a.show()),!1;2700<g&&(10>=b||12==b||14==b||16==b)&&(void 0!==a.ts_phone_utc&&(a=a.ts_phone_utc/1E3,a=moment.unix(a).format("h:mm a"),d="(as of "+a+")"),a=
webkitNotifications.createNotification("img/low_battery_48.png","Phone Battery Alert","Your phone battery is low: "+b+"%  "+d),b=(new Date).getTime().toString(),$.jStorage.set("ts_last_battery_alert_notif_shown",b),a.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},12E4)},a.show())}else void 0!==a.ack_processed?(a=a.ack_processed,b="message-status-text-msgid-"+a.id,a="outbox-message-msgid-"+a.id,null!=document.getElementById(b)&&(document.getElementById(b).innerHTML='<B>Phone Sent Message</B> <img style="margin-top:5px" src="checkmark-yes.png">'),
null!=document.getElementById(a)&&(document.getElementById(a).innerHTML='<B>Phone Sent</B> <img src="checkmark-yes.png">')):console.log("unknown incoming CAPI content")}var ntest;
function _ca99ad7049458d90917657a5db89927e651b472b7a69970aa1f552e3142d5294b237487bfd29cb1c(a,b){var c=b;if("GOOGLE_CONTACTS"==globalContactsSyncMethod){var d=[];0!=a&&(d=$.jStorage.get(a,"no-jstorage-val-found"));return c=d.name?d.name:b}d=[];b&&-1<b.indexOf("|")?d=b.split("|"):d.push(b);for(var e=d.length,f="",h=0;h<e;h++){b=d[h];a=_c8fc9058d7c18b9c6b3b026df2cc1f9648b5940d30300cf3e152e70679acbf4b36af0ebadb2607ee(b,"do_not_zeropad");if("09999999999"==a)return"Unknown / Misc";c=$.jStorage.get(username_prefix_jstrg_purpose+
"|PC_"+a,"no-jstorage-val-found");c="no-jstorage-val-found"==c||void 0==c?b:c.contactName;f+=c;h<e-1&&(f+=", ")}return f}
function _71a5dca7ae1a136e8dbd4d1538c61f697a68723d6487089d0f07adf445e02e664b1284f8a94092c0(a,b){var c=b;"GOOGLE_CONTACTS"==globalContactsSyncMethod?(c=[],0!=a&&(c=$.jStorage.get(a,"no-jstorage-val-found")),c=c.name?c.name:b):(console.log("Attempt to get PHONE CONTACT for phone_num_clean: "+a),phoneContactObj=$.jStorage.get(username_prefix_jstrg_purpose+"|PC_"+a,"no-jstorage-val-found"),c="no-jstorage-val-found"==phoneContactObj||void 0==phoneContactObj?b:phoneContactObj.contactName);return c}
function _d8e3d0472be5b876b55f0cacd4cc1c3a29063a8da45281cb08f301eeec1a0db6d188520774c9bbb1(a,b){var c="img/silhouette.jpg";if("GOOGLE_CONTACTS"==globalContactsSyncMethod){0!=a&&(d=$.jStorage.get(a,"no-jstorage-val-found"));d.name&&""!=d.thumbnail_image_google_base_url&&(c=d.thumbnail_image_google_base_url+"&oauth_token="+global_oauth_contacts_token);var d=[];0!=a&&(d=$.jStorage.get(a,"no-jstorage-val-found"));var e=[],e=$.jStorage.get("google_contacts_token","NONE");e.contacts_token_value&&(current_g_contacts_token=
e.contacts_token_value);d.thumbnail_image_google_base_url&&""!=d.thumbnail_image_google_base_url&&(console.log("thumbnail from jstorage is: "+d.thumbnail_image_google_base_url),c=d.thumbnail_image_google_base_url+"&oauth_token="+current_g_contacts_token)}else photoThumbnailObj=$.jStorage.get(username_prefix_jstrg_purpose+"|PH_PIC_"+a,"no-jstorage-val-found"),"no-jstorage-val-found"==photoThumbnailObj?(console.log("NO PHOTO LOCAL JSTORAGE MATCH FOR PHONE_NUM_CLEAN: "+a),c=chrome.extension.getURL("img/silhouette.jpg")):
"NO_PHOTO"!=photoThumbnailObj.contactThumbnailBinary&&2<photoThumbnailObj.contactThumbnailBinary.length&&(c="data:image/jpeg;base64,"+photoThumbnailObj.contactThumbnailBinary);return c}
function _9ea67058dbe492adb3b3aaff9d345d4b254b175ce3948c54877ad29c0e00f1abf2a0a1f92c955332(a,b){a=unescape(a);var c=b+"|"+a;console.log("attempting to mark message read on phone: "+a+"---  "+b);_47c0c403bcb6104f98210958217c1a4d687bf365419a2a7f6cd2cb0b8ebd81585fc2c15f52c3df04("mark_single_message_read",c,"msgid_local - not needed actually")}
function _7a59638bb6440bb511e2e362f58bc4408d9ebd04e874e023808472fe7817d1d8e49275ff8c56b604(a){80!=a.type&&83!=a.type&&70!=a.type||$.jStorage.set("most_recent_call_alert_info",a)}function _c4400ccf29ec9df83948d09a78e41846312666763cae1fe66cc66ca77cc5ecfd4e7b816344ed1207(a){_0b1ae362dad5b668e532965db182e4cda283c7a62290997cf4140b73fb0faa6eee588bd0aa0403cf(a,quickTabExistsJustSwitchToExistingTab,popupQuickReplyWidget)}var popupQuickReplyWidget=function(a){_08adf3ea766f5d2c28b851d688fa094c88e0a71d21bd4331eb52fc80cd862c12df15b59e6889c67aUpperRight(a)};
function _2633141ec0abb7043c83ff801aab116675bf7d6786e2a0349f57acb9717e94bc5dae5dde2c2cb55e(){chrome.tabs.query({},function(a){for(var b=0,c;c=a[b];b++)console.log("Tab is: "+c.url),console.log(c)})}
function _0b1ae362dad5b668e532965db182e4cda283c7a62290997cf4140b73fb0faa6eee588bd0aa0403cf(a,b,c){chrome.tabs.query({},function(d){for(var e=0,f;f=d[e];e++)if(console.log("Tab is: "+f.url),-1<f.url.indexOf(a))return console.log("found it...stop looping through tabs"),b(f),"RETURN VAL - WAS FOUND";c(a)})}var quickTabExistsJustSwitchToExistingTab=function(a){console.log("TAB EXISTS - heres tab info URL");console.log(a.url);chrome.tabs.update(a.id,{active:!0})};
function _a905e88abd50a10498b9fce710f965e4d994e0b78fa4be629d32b5290689a65aee868e5d0a56ed51(a){void 0===a&&(a="");chrome.tabs.getAllInWindow(void 0,function(b){for(var c=0,d;d=b[c];c++)if(console.log("Tab is: "+d.url),d.url&&_0878cd5adc84e014d594a0fedde27a7d187389d5d76b465c533b93e8825cc7c501125fac3f882188(d.url)){console.log("found MT tab, switching to it now...");console.log("index thing is: "+d.url.indexOf(a));b="";-1<d.url.indexOf("app")?b="app":-1<d.url.indexOf("IE-DEV")&&(b="IE-DEV");-1<d.url.indexOf(a)?
chrome.tabs.update(d.id,{active:!0}):chrome.tabs.update(d.id,{active:!0,url:"https://mightytext.net/"+b+a},_7a90e42c528bbc4c1222c15f3605b1346f4890829ba8a6697c84f98d652c279ab3a427cc2edc08eb);return}chrome.tabs.create({url:_67052107cf19872a9d251133169c60db87c837bcef632290ee4f46327a7d0faac6c032378101477f()+a,active:!0})})}function _7a90e42c528bbc4c1222c15f3605b1346f4890829ba8a6697c84f98d652c279ab3a427cc2edc08eb(){}
function _7a90e42c528bbc4c1222c15f3605b1346f4890829ba8a6697c84f98d652c279ab3a427cc2edc08eb2(){return!1}function _67052107cf19872a9d251133169c60db87c837bcef632290ee4f46327a7d0faac6c032378101477f(){return"https://mightytext.net/app"}
function _0878cd5adc84e014d594a0fedde27a7d187389d5d76b465c533b93e8825cc7c501125fac3f882188(a){console.log("val is: "+(a.indexOf("https://mightytext.net/app")+a.indexOf("https://mightytext.net/dev")));return-1<a.indexOf("https://mightytext.net/app")||-1<a.indexOf("https://mightytext.net/web")?!0:!1}var notification_restart,notification_signed_out_must_be_global,capi_helper_global_login_state="UNKNOWN";
function _783d46009a471816b33aee333a69e697168d316a9bbb0e9f6aa4fa8ddb8c56c9b75384fcfed87cbb(){console.log(" ");console.log("------------------------------------------------ NEW POLL - HealthCheckCAPI -----------------------------------");console.log("webapp-loop at: "+Date()+" for user email -> "+google_username_currently_logged_in);_dd1d2c85a777ac30c6c986e125540ddc71f7f737dee7f6d337cc448a666e1f7ed91fe7d14094bd95();console.log("user status is: "+extra_login_status_info+". . . Log In Status is: "+capi_helper_global_login_state);
body_text_to_send="CAPI_HEALTH_CHECK_FROM_CRX -- "+Date();$.ajax({url:baseUrl+"/test?function=capi&body="+body_text_to_send+"&phone_num=123456789",global:!1,type:"POST",dataType:"text",success:function(a){console.log(a);time_last_success_mighty_ping=new Date;-1!=a.search("user not logged in")?(console.log("User is not logged in to MightyText"),_ab7936a60bf11f63c721faf4b0b61b40aaebc57684849d21ff18ca69d36c32ed1933a08781b7b57aWebAppCRXHelper(!1),GLOBAL_CAPI_SOCKET_LAST_KNOWN_FOR_MANUAL_CLOSE_UPON_LOGOUT.close(),
"SIGNED_IN"==capi_helper_global_login_state&&(notification_signed_out_must_be_global=webkitNotifications.createNotification("img/mightytext_square_logo_48px.png","Signed Out of MightyText","You are now signed out."),notification_signed_out_must_be_global.show(),window.setTimeout(function(){notification_signed_out_must_be_global.cancel()},4E3)),capi_helper_global_login_state="SIGNED_OUT"):-1!=a.search("CAPI test sent successfully")&&(_b5433d358c9982389ff62d47e0725dc7663e00e3404c76df4e484718088a75ffa6b33b6c9f304452(),
capi_helper_global_login_state="SIGNED_IN")}})}function _76721b73dc49ce599f4f38e6a95ba89ac054cca17f44ffc0fbedad9597d4942064abd85d65074516(){webapp_crx_time_last_successful_health_check_received=new Date}
function _14fbe2b4f92b49e0212426b54af15d397812dc1a5ff12bf06071d7c04e59e711c9622c71f7a7fa1e(a,b){window.localStorage.usingWebAppNew=1;_14338f3ad3fd62a961bc069d95840d95a37dc7ca811b716801e30a21ca9a86f6a5edae8a0c25d739();b&&console.log(b);b.user_token.accessToken?(globalContactsSyncMethod="GOOGLE_CONTACTS",console.log("YES - Google contacts token"),_e1c1531648610cee6255a7f24bba7de0aabca09050ce41dc05c4888b3cb778b060c044741b100565(),window.setInterval(function(){_e1c1531648610cee6255a7f24bba7de0aabca09050ce41dc05c4888b3cb778b060c044741b100565()},
33E5)):(console.log("no g contacts token"),_99ad8a9d0416cdaa68acf1c47175228eaaf2ce464a67a03015e2a35a689751627e3771cac80681ef("NO_CONTACTS_TOKEN"));_03e7bf0ba58f53fc8de37a904c021692481b7d49d9659142a01fdf451759c15c1553a8d5a5b91b11()}
function _b5433d358c9982389ff62d47e0725dc7663e00e3404c76df4e484718088a75ffa6b33b6c9f304452(){webapp_crx_globalUserSettingsUponCRXLoad&&(0==webapp_crx_globalUserSettingsUponCRXLoad.notif_toggle_on_off?chrome.browserAction.setIcon({path:"img/mightytext_square_logo_19px_notif_off.png"}):chrome.browserAction.setIcon({path:"img/19x19_MT_logo_boom_gradient_white.png"}))}
function _03e7bf0ba58f53fc8de37a904c021692481b7d49d9659142a01fdf451759c15c1553a8d5a5b91b11(){$.ajax({url:baseUrl+"/usersettings?function=getUserSettings",global:!1,type:"POST",dataType:"json",success:function(a){a.usersettings.settings_list&&(webapp_crx_globalUserSettingsUponCRXLoad=jQuery.parseJSON(a.usersettings.settings_list.value),_b5433d358c9982389ff62d47e0725dc7663e00e3404c76df4e484718088a75ffa6b33b6c9f304452())}})}
function _5e78759fc93542124f3143f61844e1241a116b1741538273fb239173e7921cdd94d6007ff931077d(){for(var a="",b=0;5>b;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return a}function _ab7936a60bf11f63c721faf4b0b61b40aaebc57684849d21ff18ca69d36c32ed1933a08781b7b57aWebAppCRXHelper(a){a?chrome.browserAction.setIcon({path:"img/icon-19-on.png"}):chrome.browserAction.setIcon({path:"img/icon-19-off.png"})}
function _e115dccedc1c5fcc343da4fac1176c6da4f53c2e90e7df6105c210141d12daa92aa76de710a94807(){var a=new Date;a.setDate((new Date).getDate());return a.toTimeString().substr(0,a.toTimeString().lastIndexOf(" "))+a.toLocaleTimeString().substr(a.toLocaleTimeString().lastIndexOf(" "))}
function _08adf3ea766f5d2c28b851d688fa094c88e0a71d21bd4331eb52fc80cd862c12df15b59e6889c67aUpperRight(a){var b,c;-1<a.indexOf("quick-reply")?(b=400,c=520):(b=500,c=600);chrome.windows.create({url:a,left:screen.width-(b+7),top:0,width:b,height:c,focused:!0,type:"popup"},function(a){})};
function _acf6d7982c834b2cd796a45e0810821afa13bc356535203199ec30d1792d2e1cf224d439481f5a40Orig(){oauth.authorize(function(){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("on google contacts - oauth.authorize()");oauth.sendSignedRequest("http://www.google.com/m8/feeds/contacts/default/full",_d6dbb77a4036e0fc337667f1937be7f572e47b956df6e9901232154d96b9c976075be61623f2913b,{parameters:{alt:"json","max-results":1E4}})})}
chrome.browserAction.onClicked.addListener(function(a){_gaq.push(["_trackEvent","Popup","Initial-Load","",1]);_eb0c83b4b297091d96de8a921e569d95cb78fa4cbb02c36ce176c9526a89a7205f2bf3b28e272ee7()});function _6f700838e24b8e9f3dd7cec19bc798875db02ff3484ba3dc1194775bae24d1e54e0286e3292a4bdd(){console.log("NON-WEBAPP-HEARTBEAT-CHECK");console.log("Current polling frequency is: "+poll_freq);checkLastMightyNetworkPing()}console.log("----------------- Starting Background Script ** -----------");
var globalHeartbeatInterval=setInterval(_6f700838e24b8e9f3dd7cec19bc798875db02ff3484ba3dc1194775bae24d1e54e0286e3292a4bdd,1E4);_gaq.push(["_trackEvent","Background","Startup-BG-Script","",1]);var token,time_last_channel_token_obtained=0,time_last_success_mighty_ping=new Date,globalContactsSyncMethod="SYNC_PHONE",username_prefix_jstrg_purpose,calling_from_chrome_extension=!0,capi_rollout_factor=3.8;console.log("capi rollout factor is "+capi_rollout_factor);
var GOOGLE_CONTACTS_OAUTH_STATUS="UNKNOWN",oauth=ChromeExOAuth.initBackgroundPage({request_url:"https://www.google.com/accounts/OAuthGetRequestToken",authorize_url:"https://www.google.com/accounts/OAuthAuthorizeToken",access_url:"https://www.google.com/accounts/OAuthGetAccessToken",consumer_key:"anonymous",consumer_secret:"anonymous",scope:"http://www.google.com/m8/feeds/",app_name:"MightyText - Contacts Sync"}),contacts_bkg_page=null,contacts_autocomplete_per_unique_phone_num=null,num_consecutive_internet_connection_failures=
0,notify_android_app_install_once=!1,debug_mode=1;_f7fe87ed320246c60667cae03de8bab1fa5c31f8304e77a36f4e407d195f1c84feaf55034695bff0(!1);var google_login_status=!1,google_username_currently_logged_in="",login_and_beta_ready=!1,extra_login_status_info="";_26f66b78b52b7e3920a05f2f4279384b2b9088d52f911dc032e3791580861eac6e6c886d50e48f07();var GOOGLE_CONTACTS_OAUTH_STATUS="UNKNOWN",should_get_contacts_token_in_new_tab=!0;
_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Google Contacts Token Status: "+GOOGLE_CONTACTS_OAUTH_STATUS);function _26f66b78b52b7e3920a05f2f4279384b2b9088d52f911dc032e3791580861eac6e6c886d50e48f07(){window.setTimeout(function(){_4e848a44eb1c15270657785b113ec2e9dcdea5b92fdfe5a64505bd88b7bee0858aed642dbaa7f083(1,!0)},300)}
function _d6dbb77a4036e0fc337667f1937be7f572e47b956df6e9901232154d96b9c976075be61623f2913b(a,b){contacts_bkg_page=[];contacts_autocomplete_per_unique_phone_num=[];for(var c=JSON.parse(a),k=0,d;d=c.feed.entry[k];k++){var e={name:d.title.$t,id:d.id.$t,emails:[],phonenums:[]},l={label:d.title.$t,value:""};if(d.gd$email)for(var h=d.gd$email,g=0,f;f=h[g];g++)e.emails.push(f.address);e.name||(e.name=e.emails[0]||"<Unknown>");if(d.gd$phoneNumber)for(h=d.gd$phoneNumber,g=0;g<h.length;g++)f=h[g],e.phonenums.push(f.$t),
l.label=e.name+" "+f.$t,l.value=f.$t,contacts_autocomplete_per_unique_phone_num.push({label:e.name+" "+f.$t,value:f.$t});d.gd$phoneNumber&&contacts_bkg_page.push(e)}}function _f36520637d4e7ef010589a8b6f999cfa5540ced099d826bfccb32991c544f02237752b08b4c85eeaGoogleOpenID(){oauth.clearTokens();_f7fe87ed320246c60667cae03de8bab1fa5c31f8304e77a36f4e407d195f1c84feaf55034695bff0(!1)}var msgcount="",simplevalidation="",db,msgcount2="",msgList="",PendingSMSArray=[];
chrome.extension.onRequest.addListener(function(a,b,c){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa(b.tab?"from a content script:"+b.tab.url:"from the extension");"user_invoked_popup_so_force_google_login_check"==a.purpose&&(console.log("* User Clicked Popup icon in extension**  Now check if a user is logged in already"),console.log(extra_login_status_info),"WEBAPP_BETA"==extra_login_status_info?console.log("This is a new web app user. Don't do anything extra (dont call checkGoogleLoginTokenAndSetUsername)"):
(console.log("user does not have extra_login info set - so likely not signed in before, so check if they are now"),_4e848a44eb1c15270657785b113ec2e9dcdea5b92fdfe5a64505bd88b7bee0858aed642dbaa7f083()),c({reply:"success"}))});
chrome.extension.onRequest.addListener(function(a,b,c){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa(b.tab?"from a content script:"+b.tab.url:"from the extension");"call_from_popup_to_check_contact_info"==a.greeting&&(should_get_contacts_token_in_new_tab=!1,_acf6d7982c834b2cd796a45e0810821afa13bc356535203199ec30d1792d2e1cf224d439481f5a40(),c({farewell:contacts_bkg_page,autocomplete_contacts_list:contacts_autocomplete_per_unique_phone_num,google_contacts_token_status:GOOGLE_CONTACTS_OAUTH_STATUS}))});
chrome.extension.onRequest.addListener(function(a,b,c){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa(b.tab?"from a content script:"+b.tab.url:"from the extension");"get_new_g_contacts_token_call_from_popup"==a.purpose&&(should_get_contacts_token_in_new_tab=!0,_acf6d7982c834b2cd796a45e0810821afa13bc356535203199ec30d1792d2e1cf224d439481f5a40Orig(),c({myreply:"yo yo"}))});
chrome.extension.onRequest.addListener(function(a,b,c){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa(b.tab?"from a content script:"+b.tab.url:"from the extension");"popup_checking_current_google_login_state"==a.purpose&&c({google_login_status_from_bg_page:google_login_status,login_and_beta_ready_from_bg_page:login_and_beta_ready,google_username_currently_logged_in_from_bg_page:google_username_currently_logged_in,extra_login_status_info_from_bg_page:extra_login_status_info})});
chrome.extension.onRequest.addListener(function(a,b,c){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa(b.tab?"from a content script:"+b.tab.url:"from the extension");"set_quick_polling_outbound_message"==a.purpose&&(_8159618423dfa22f1ca0b62543e2f18eef630ce88e3f85ca487bf4a37c5435bd14fb1c7365a1e260("Outbound Message being sent, lower polling to check for ACK faster",2E3),c({myreply:"sent request to set polling to 2000"}))});
function _900be5532bab124f8ee846acf4c0eb84a1a9359e6b6ca6fce3ceae0c3804ce7954530baa32c41df0(a,b){}function _750e921a48e7020885a2abc657e82894a6b2e0107249742e158e082029c84386fbee37453f084dba(a,b){log.innerHTML+="<p>"+b.message+"</p>"}function OLD__b4b2654b71c39e0d2edbb953a91f7d31fd24b51d1dac581bea06b92fea45ff1a5b5201dc6c5f4d45(a,b){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Error during SQL insert: "+b.msg)}
var default_poll_freq=17E3,highest_poll_freq=7E4,poll_freq=default_poll_freq,consecutive_polls_without_message_activity=0,total_aggregate_polls=0,poll_state="START";db=openDatabase("Texty","1.0","Texty-SMS",2E5);localStorage.isInitialized||(localStorage.isActivated=!0,localStorage.frequency=1,localStorage.isInitialized=!0);_a9b0b2c7f905c29c8f7a595084b6078811aef17e00dda602eeb0b87283e18cfa338328358aa983d9();
if(webkitNotifications){var interval=0,currentGlobalIntervalID=setInterval(_7ad085c47a5b7621c477ec684c817aaa6fdb8e27b72cfdd3275bc5c6c2182805f4f1b7b45361b4c0,poll_freq);_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("STARTUP --  ** Setting polling to: "+poll_freq)}else chrome.tabs.create({url:"error.html"});
function _7ad085c47a5b7621c477ec684c817aaa6fdb8e27b72cfdd3275bc5c6c2182805f4f1b7b45361b4c0(){interval++;JSON.parse(localStorage.isActivated)&&localStorage.frequency<=interval&&(consecutive_polls_without_message_activity++,total_aggregate_polls++,_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("------------------------------------------------"),_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("At START of POLL at "+Date()),_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Poll State is: "+
poll_state),_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Current polling frequency is: "+poll_freq),_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("# of consecutive polls without activity is: "+consecutive_polls_without_message_activity),_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("TOTAL AGGREGATE POLLS: "+total_aggregate_polls),_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Google Login Status is: "+
google_login_status),4<consecutive_polls_without_message_activity&&"OK-NORMAL"==poll_state&&_8159618423dfa22f1ca0b62543e2f18eef630ce88e3f85ca487bf4a37c5435bd14fb1c7365a1e260("*No new incoming message Activity in a while...increase polling freq...",Math.min(highest_poll_freq,1.05*poll_freq)),!0==google_login_status&&!0==network_connection_status&&!0==login_and_beta_ready?(_b9cbf3c7173636b786dfabba1aa62bb91c14cd39f36f01eae744b9e28abf24659dc7da79cb5d2ea3(),"OK-NORMAL"!=poll_state&&(poll_state="OK-NORMAL",
console.log("stopping this Interval and restarting to default - g user logged in ...setting poll frequency to DEFAULT"),poll_freq=default_poll_freq*capi_rollout_factor,interval=0,clearInterval(currentGlobalIntervalID),window.setInterval(function(){_7ad085c47a5b7621c477ec684c817aaa6fdb8e27b72cfdd3275bc5c6c2182805f4f1b7b45361b4c0()},poll_freq))):(console.log("user not logged in -- reason is "+google_username_currently_logged_in),_4e848a44eb1c15270657785b113ec2e9dcdea5b92fdfe5a64505bd88b7bee0858aed642dbaa7f083(),
_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Network Connection Status: "+network_connection_status),!1==network_connection_status?(poll_state="WAITING-FOR-NETWORK",_8159618423dfa22f1ca0b62543e2f18eef630ce88e3f85ca487bf4a37c5435bd14fb1c7365a1e260("Waiting for Network",2E4)):"WAITING-FOR-USER-PROPER-AUTH"!=poll_state&&(poll_state="WAITING-FOR-USER-PROPER-AUTH",_8159618423dfa22f1ca0b62543e2f18eef630ce88e3f85ca487bf4a37c5435bd14fb1c7365a1e260("Waiting for proper User Auth",
4E4))))}
function _8159618423dfa22f1ca0b62543e2f18eef630ce88e3f85ca487bf4a37c5435bd14fb1c7365a1e260(a,b){console.log(a+"...Stopping this Interval and resetting Polling...setting poll frequency to "+b);poll_freq=b;poll_freq*=capi_rollout_factor;console.log("ACTUALLY setting to "+poll_freq+"...based on CAPI rollout factor of "+capi_rollout_factor);clearInterval(currentGlobalIntervalID);consecutive_polls_without_message_activity=0;currentGlobalIntervalID=window.setInterval(function(){_7ad085c47a5b7621c477ec684c817aaa6fdb8e27b72cfdd3275bc5c6c2182805f4f1b7b45361b4c0()},poll_freq)}
function _b9cbf3c7173636b786dfabba1aa62bb91c14cd39f36f01eae744b9e28abf24659dc7da79cb5d2ea3(){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Checking MightyText at "+Date());_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("google_login_status is: "+google_login_status);_b1a1ef93b58f517ff44c6cf9db088813347ab9508caf5e8dc26b9ec4b2d3d2090559ef93df3eca87(!0);_0addc91845dd3bc27426030d7602f1ed3abde6a2f101946edcfca92f00a8fac3468cdd87e84ac2d7()}
function checkLastMightyNetworkPing(){var a=((new Date).getTime()-time_last_success_mighty_ping.getTime())/1E3;_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("--------------\x3e Seconds Since LAST MightyText network ping: "+a);360<a&&(console.error("---\x3e has been a long time since last MT ping -- try to contact google.com first"),$.ajax({type:"GET",url:"https://accounts.google.com/latitude/mobile_phone-16.gif",cache:!1,success:function(a){console.log("Network ping to Google -- fine...");
_gaq.push(["_trackEvent","CRX-Background","Error","Forced-Reload-CRX",1]);console.log("google login status is true -- will reload CRX BG in 10 seconds");window.setTimeout(function(){window.location.reload()},1E4)}}))}
function _0addc91845dd3bc27426030d7602f1ed3abde6a2f101946edcfca92f00a8fac3468cdd87e84ac2d7(){if(0==time_last_channel_token_obtained)console.log("no channel opened yet in this session, go open one"),_48660970f81b1e811eea6ebdefb69db9fff0f24cc5ead704622520cb05e4ea5a792c416331fcf105();else{var a=((new Date).getTime()-time_last_channel_token_obtained.getTime())/1E3;_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Seconds Since LAST CHANNEL TOKEN OBTAINED: "+a);13500<a?
(console.log("has been > 3.75 hours, get a new channel token"),_48660970f81b1e811eea6ebdefb69db9fff0f24cc5ead704622520cb05e4ea5a792c416331fcf105()):console.log("has NOT been > 3.75 hours since last CAPI channel token was retrieved, no need to get a new one.")}}function _f452e4576ac689bf2e6661d2aa8087c53e1db2090ee8fba2ea2055d3b827998d662d27bc4b7b7112(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}
function _2825f8c5fb212014335c0c7c0a9ddd0ed3a4bc62441cff641c7afbb2bd12a2ec82bdb546d88ff13f(a,b){console.log(a);var c="";a.mediaType&&(c=a.mediaType);_gaq.push(["_trackEvent","CRX-ContextMenu","Context-Menu-Click",c]);console.log(a);"image"==c&&(c="",c=a.srcUrl,1E3<c.length&&alert("Unable to send this photo to your phone.\r\n\r\nImage payload is too large (likely a base-64 image)"),body="AAA",action_data=body+"||"+c,_7798e42247f3cd4955ebaa1e5b396a48ee846068675af5c640c38b5ed4941432c2feddeb914652cf("fetch_binary_from_url_store_on_device",
action_data))}var currentCRXVersion=chrome.runtime.getManifest().version;function _0de312de9cec882bbf65860cb64b3dd373aa5dee44cfcdf2ddb75b6b2572a8db5d5a9f0795b66143(){chrome.contextMenus.create({id:"contextmenu-send-image",title:" Send this image to my phone",type:"normal",contexts:["image"],onclick:_2825f8c5fb212014335c0c7c0a9ddd0ed3a4bc62441cff641c7afbb2bd12a2ec82bdb546d88ff13f})}
function _cf6118db869c041adaf9d9dcf5cc2bfebdcf774d934274e21d97c7744abc77d0dbd4b8dc01c887ea(){var a=[];a["10.2"]=[];a["10.2"].headline="New! Instantly send pictures from your computer to your phone";a["10.2"].body="\r\nJust right-click on an image on any web page and select 'Send Image to your Phone' and you will see it on your phone instantly.\r\n ";a[currentCRXVersion]?"1"==$.jStorage.get("news_"+currentCRXVersion,"no-news-shown-yet")?console.log("news for this version has already been seen"):(a=
new Notification(a[currentCRXVersion].headline,{icon:"img/128x128_MT_logo_boom_gradient_white.png",body:a[currentCRXVersion].body}),a.onshow=function(a){$.jStorage.set("news_"+currentCRXVersion,"1");
setTimeout(function(){a.currentTarget.cancel()},6E4)},a.show()):console.log("NO NEWS!!!")};
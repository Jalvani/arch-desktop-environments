var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-21391541-2"]);_gaq.push(["_trackPageview"]);(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://ssl.google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();var _kmq=_kmq||[],_kmk=_kmk||"a009d9e3633da7d7456e8e1478c8f05f33e35f8e";
function _kms(a){setTimeout(function(){var b=document,c=b.getElementsByTagName("script")[0],b=b.createElement("script");b.type="text/javascript";b.async=!0;b.src=a;c.parentNode.insertBefore(b,c)},1)}_kms("https://i.kissmetrics.com/i.js");_kms("https://doug1izaerwt3.cloudfront.net/"+_kmk+".1.js");
var globalIfIncomingSMSThenUseLegacyQuickReply=!0,network_connection_status=!1,notification_no_network_connection,notification_general_error_global,contacts=[],which_phone_num_for_notif="000000",apiVersion=5,baseUrl="https://textyserver.appspot.com",textyStaticServerURL="http://textyapp.com",globalIntervalGetPhoneStatus,sendUrl=baseUrl+"/client?function=send",signInUrlCRX=baseUrl+"/signin?extret="+encodeURIComponent(chrome.extension.getURL("help.html"))+"%23signed_in&ver="+apiVersion,signOutUrl=baseUrl+
"/signout?extret="+encodeURIComponent(chrome.extension.getURL("signed_out.html"))+"&ver="+apiVersion,registerUrl=baseUrl+"/register?ver="+apiVersion,STATUS_SUCCESS="success",STATUS_LOGIN_REQUIRED="login_required",STATUS_DEVICE_NOT_REGISTERED="device_not_registered",STATUS_GENERAL_ERROR="general_error",BROWSER_CHANNEL_RETRY_INTERVAL_MS=1E4*(1+Math.random()-0.5),channel,socket,phone_number,globalLastKnownGoogleUserName="none";
function _f7fe87ed320246c60667cae03de8bab1fa5c31f8304e77a36f4e407d195f1c84feaf55034695bff0(a){a?chrome.browserAction.setIcon({path:"img/19x19_MT_logo_boom_gradient_white.png"}):chrome.browserAction.setIcon({path:"img/icon-19-off.png"})}var NEW_COUNT_GLOBAL_NOTIF=0;
function _f53561cc8cac58957c2de21c8322480dc05bee7615c2a69a79d247601c7df8661c1f6e1fad7e0247(){var a=NEW_COUNT_GLOBAL_NOTIF;10<NEW_COUNT_GLOBAL_NOTIF&&(a="10plus");_gaq.push(["_trackEvent","CRX-Background","Error","getUserInfo-CRX-GU72-"+a,1]);console.log("----------------");NEW_COUNT_GLOBAL_NOTIF++;2>NEW_COUNT_GLOBAL_NOTIF&&(a=window.webkitNotifications.createNotification("error_icon.png","MightyText Connection Issue","Error connecting to MightyText. If this error continues, please inform our team. We are sorry for the inconvenience.(Error Code: CRX-GU72)"),
a.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},1E4)},a.show())}
function _55c2d68d33b7911bc667900a84aac533e22b73df299754594a12288a38c946a77d6742fb985877d2(){_gaq.push(["_trackEvent","CRX-Background","Error","getDistinctHeaders-CRX-GTHRD59",1]);console.log("----------------");if(1>NEW_COUNT_GLOBAL_NOTIF){var a=window.webkitNotifications.createNotification("error_icon.png","MightyText System issues","MightyText is having system issues. We're aware of the problem and working on it. We are sorry for the inconvenience. (Error Code: CRX-GTHRD59)");a.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},
1E4)};a.show()}}
function _0ba74b3e0c6a635d45a3429f000fab8fc05a7b5c4005590e58e9870b4a8737fab6fdac253c0a927d(){_gaq.push(["_trackEvent","Background","CAPI-Experiment-On",google_username_currently_logged_in,1]);capi_rollout_factor=2.8;_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("CAPI RolloutFactor in experiment is: "+capi_rollout_factor);clearInterval(currentGlobalIntervalID);poll_freq*=capi_rollout_factor;currentGlobalIntervalID=window.setInterval(function(){_7ad085c47a5b7621c477ec684c817aaa6fdb8e27b72cfdd3275bc5c6c2182805f4f1b7b45361b4c0()},poll_freq);
console.log("poll_freq after capi check is "+poll_freq)}
function _c756eab9ce592e40f8804fc303e9ce6bfd66d5b7ae894a77d383b8377c090b8fe01ed4197ec10d97(a,b,c,d){var e=new XMLHttpRequest;phone_number=dest_num;e.open("POST",sendUrl,!0);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");e.setRequestHeader("X-Same-Domain","true");e.onreadystatechange=function(){if(4==this.readyState)if(200==e.status){var a=e.responseText;0==a.indexOf("OK")?d(STATUS_SUCCESS,c,e):0==a.indexOf("LOGIN_REQUIRED")?d(STATUS_LOGIN_REQUIRED,c,e):0==a.indexOf("DEVICE_NOT_REGISTERED")&&
d(STATUS_DEVICE_NOT_REGISTERED,c,e)}else d(STATUS_GENERAL_ERROR,c,e)};if("send_sms"==a)var f="phone="+encodeURIComponent(phone_number)+"&deviceType=ac2dm&action=send_sms&action_data="+encodeURIComponent(b);else"mark_single_message_read"==a?(f="deviceType=ac2dm&action=mark_single_message_read&action_data="+encodeURIComponent(b),console.log(f)):"mark_whole_thread_read"==a&&(f="deviceType=ac2dm&action=mark_whole_thread_read&action_data="+encodeURIComponent(b));e.send(f)}
function _6a667553a6f0e77821f58890e6cb823a4c6940c0c82dcbdb81cf57e43a90f3e5f6987c908282704d(a,b,c,d){var e=new XMLHttpRequest;phone_number=dest_num;e.open("POST",sendUrl,!0);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");e.setRequestHeader("X-Same-Domain","true");e.onreadystatechange=function(){if(4==this.readyState)if(200==e.status){var d=e.responseText;console.log("for C2DM call: "+a+"..... response received: "+d);0==d.indexOf("OK")?console.log(STATUS_SUCCESS):0==d.indexOf("LOGIN_REQUIRED")?
console.log(STATUS_LOGIN_REQUIRED):0==d.indexOf("DEVICE_NOT_REGISTERED")&&console.log(STATUS_DEVICE_NOT_REGISTERED)}else console.log(STATUS_GENERAL_ERROR)};if("send_sms"==a)var f="phone="+encodeURIComponent(phone_number)+"&deviceType=ac2dm&action=send_sms&action_data="+encodeURIComponent(b);else"mark_single_message_read"==a?(f="deviceType=ac2dm&action=mark_single_message_read&action_data="+encodeURIComponent(b),console.log(f)):"mark_whole_thread_read"==a&&(f="deviceType=ac2dm&action=mark_whole_thread_read&action_data="+
encodeURIComponent(b));e.send(f)}function _d3b87fe2eb863e8ef7992df150f53b2b5bdc40081b6e816a5ceff0d4f821756c56dd8fd82fad124a(a){$.ajax({type:"GET",url:"https://accounts.google.com/latitude/mobile_phone-16.gif",cache:!1,success:function(b,c,d){a()}})}
function _4e848a44eb1c15270657785b113ec2e9dcdea5b92fdfe5a64505bd88b7bee0858aed642dbaa7f083(a,b){a||(a=1);_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Entering function CheckGoogleLoginTokenAndSetUserName");$().ajaxError(function(a,b,c,g){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("AJAX error calling URL: "+c.url+"... Reponse is: "+b.responseText);-1<c.url.search("getUserInfoFull")&&-1<b.responseText.search("500 Server Error")&&
(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Texty trying to get Full User Auth info for this user (GetUserInfoFull)...and got Error Code 500 - likely case 1 is they are not set up Beta..."),a='<img  align=BOTTOM src="error_icon.png" width=20 height=18 /> <span style="color:black;font-size:12px"> This Google user is not registered for MightyText. Make sure you have completed the full signup process on the MightyText Android App and were invited to the beta.</span>  <a href="#" onclick="window.close();chrome.tabs.create({url: \''+
signOutUrl+'\'})"> Sign out now</a>, or <a href="#" onclick="window.close();chrome.tabs.create({url:\'http://mightytext.net/beta\'})"> Sign up for the beta</a>',window.localStorage.userRegistrationStatus=-1,document.getElementById("top-notif-bar").innerHTML=a);-1<b.responseText.search("500 Server Error")&&(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Texty trying to get Full User Auth info for this user (GetUserInfoFull)...and got Error Code 500 - likely case 2 is they are not set up Beta..."),
a='<img  align=BOTTOM src="error_icon.png" width=20 height=18 /> <span style="color:black;font-size:12px"> This Google user is not registered for MightyText. Make sure you have completed the full signup process on the MightyText Android App and were invited to the beta.</span>  <a href="#" onclick="window.close();chrome.tabs.create({url: \''+signOutUrl+'\'})"> Sign out now</a>, or <a href="#" onclick="window.close();chrome.tabs.create({url:\'http://mightytext.net/beta\'})"> Sign up for the beta</a>',
document.getElementById("top-notif-bar").innerHTML=a)});$.ajaxSetup({error:function(a,b){console.error(a);console.error(b);if(0==a.status)console.error("*** AJAX REQUEST FAIL -- NETWORK CONNECTION PROBLEM? ***"),_f7fe87ed320246c60667cae03de8bab1fa5c31f8304e77a36f4e407d195f1c84feaf55034695bff0(!1),num_consecutive_internet_connection_failures+=1,_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Number of consecutive internet connection failures: "+num_consecutive_internet_connection_failures),
1==num_consecutive_internet_connection_failures&&(network_connection_status=!1);else if(404==a.status)_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Error 404. Requested URL not found."),document.getElementById("msg").innerHTML="Error 404. Requested URL not found. Showing Local Messages only.";else if(500==a.status){extra_login_status_info="USER_NOT_REG_BETA";_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Error: 500 - Texty trying to get Full User Auth info for this user (GetUserInfoFull)...and got Error Code 500 - likely case 3 is they are not set up Beta...");
var c='<img  align=BOTTOM src="error_icon.png" width=20 height=18 /> <span style="color:black;font-size:14px"> This user is not registered for MightyText. Make sure you have been invited (by e-mail) to the private beta,  and have completed the full signup process on the MightyText Android App.</span>  <a href="#" onclick="window.close();chrome.tabs.create({url: \''+signOutUrl+'\'})"> Sign out now</a>, or <a href="#" onclick="window.close();chrome.tabs.create({url:\'http://mightytext.net/beta\'})"> Sign up for the beta</a>';
document.getElementById("top-notif-bar").innerHTML=c}else"parsererror"==b?(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Error. Parsing JSON Request failed."),console.log(b),console.log(a)):"timeout"==b?_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Request Time out."):_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Unknown Error:"+a.status);_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Response text returned from server is: "+
a.responseText)}});var c=baseUrl+"/api?function=getUserInfoFull&CLIENT=CRX";_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Inside checkGoogleLoginToken function");$.ajax({url:c,global:!1,type:"GET",timeout:11E3,dataType:"json",error:function(b,c,f){console.log("ERROR in AJAX in getUserInfoFull: "+f);1==a?window.setTimeout(function(){_4e848a44eb1c15270657785b113ec2e9dcdea5b92fdfe5a64505bd88b7bee0858aed642dbaa7f083(999)},6E3):999==a&&(console.log("retry attempt 999 (sentinel val)"),
_d3b87fe2eb863e8ef7992df150f53b2b5bdc40081b6e816a5ceff0d4f821756c56dd8fd82fad124a(_f53561cc8cac58957c2de21c8322480dc05bee7615c2a69a79d247601c7df8661c1f6e1fad7e0247))},success:function(a,b,c){console.log(a);network_connection_status=!0;time_last_success_mighty_ping=new Date;_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Response from Google Login Token check: "+a);console.log("url is "+signInUrlCRX);if(a.user&&-1<a.user.search("user not logged in")){if(_gaq.push(["_trackEvent",
"CRX-Background","Error","User-Not-Logged-In-CRX",1]),console.error("No Google Account user logged in."),_f7fe87ed320246c60667cae03de8bab1fa5c31f8304e77a36f4e407d195f1c84feaf55034695bff0(!1),login_and_beta_ready=google_login_status=!1,extra_login_status_info=google_username_currently_logged_in="",console.log("url is "+signInUrlCRX),console.log(chrome.extension.getURL("error_icon.png")),0==total_aggregate_polls||80==total_aggregate_polls||150==total_aggregate_polls)a=window.webkitNotifications.createNotification("error_icon.png",
"MightyText - Not Signed In"," You won't be able to send/receive messages. Click here to sign in."),a.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},8E3)},a.onclick=function(a){window.open("https://mightytext.net/app");this.cancel()},a.show(),total_aggregate_polls++}else{if(a.user_info_full&&0<a.user_info_full.email.length){jQuery.parseJSON(a);google_username_currently_logged_in=a.user_info_full.email;window.localStorage.lastKnownGoogleUserName=a.user_info_full.email;_kmq.push(["identify",
google_username_currently_logged_in]);_kmq.push(["record","User Logged In",{"CRX-Login":"true",Client:"CRX"}]);b=a.user_info_full.ts_creation;if(void 0!=a.user_info_full.channelapi_enabled&&100==a.user_info_full.channelapi_enabled){c=moment.utc();var g=moment.utc([2014,0,21,4,17,53]);c>g&&window.setTimeout(function(){_cf6118db869c041adaf9d9dcf5cc2bfebdcf774d934274e21d97c7744abc77d0dbd4b8dc01c887ea()},5E3);_0de312de9cec882bbf65860cb64b3dd373aa5dee44cfcdf2ddb75b6b2572a8db5d5a9f0795b66143();_f7fe87ed320246c60667cae03de8bab1fa5c31f8304e77a36f4e407d195f1c84feaf55034695bff0(!0);
_50e956261a608f2b0f011f1830bed0916518e165df2db8a6cf94fff6210e75eee023e83328cd5a46();_21f588cccf345c420376e1a04285f5f18bfd7d44759e32769a2af771f28f3314dd110948a94f5571("REG-OK");clearInterval(currentGlobalIntervalID);console.log("User is NOT a legacy extension user - so no more polling whatsoever!");_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("!!!!!!!! ChannelAPI enabled flag (used for webapp beta testing flag) is : "+a.user_info_full.channelapi_enabled);google_login_status=
!0;login_and_beta_ready=!1;google_username_currently_logged_in=a.user_info_full.email;extra_login_status_info="WEBAPP_BETA";username_prefix_jstrg_purpose=a.user_info_full.email.substr(0,a.user_info_full.email.indexOf("@"));_gaq.push(["_trackEvent","Background","CRX-Startup-WEBAPP","",1]);console.log("******** calling webapp code");clearInterval(globalHeartbeatInterval);globalHeartbeatInterval=setInterval(_06610fa060e114f26ad7660390d7d9864e0095d8c83cd1dbeb82617229da81d0c11ce5e9deb96b5c,2E4);_d37c785981bc8f0e9c3d444aebe803bf6ba48915b7c5599176f72b4179ff84f5e2b265d217f70a60();
$.getScript("https://mightytext.net/prod-assets/crx-support.js",function(a,b,c){console.log(a);console.log(b);console.log(c.status);console.log("Load was performed.");processHostedInstructions()});_5ab1a232e71a4abe42b16f7a3cedb58e47c9528554c7f906ebcb8ea72fa4f7c53e24763d88b2ab7e();clearInterval(globalIntervalGetPhoneStatus);globalIntervalGetPhoneStatus=setInterval(_5ab1a232e71a4abe42b16f7a3cedb58e47c9528554c7f906ebcb8ea72fa4f7c53e24763d88b2ab7e,24E4);_de5b3292f4582379201aac1e9eda554929ab4534d74ed0ffc830a45b9f43b69b1225cbc083632b36(google_username_currently_logged_in,
a);_d9faf371ccc19df8085805b5da99e94b13d633be01de88f0280ef2bb174bbe86ab36cc4e361cdc3d(google_username_currently_logged_in,b,a.user_info_full.current_app_version,a.user_info_full.ts_last_login,"CRX-MODERN-USER");capi_rollout_factor=4.5;return}_21f588cccf345c420376e1a04285f5f18bfd7d44759e32769a2af771f28f3314dd110948a94f5571("Legacy-CRX-User-SWITCH");console.log("********* LEGACY CRX USER *********");_gaq.push(["_trackEvent","Background","CRX-Startup-LEGACY-SWITCHING","",1]);_d9faf371ccc19df8085805b5da99e94b13d633be01de88f0280ef2bb174bbe86ab36cc4e361cdc3d(google_username_currently_logged_in,
b,a.user_info_full.current_app_version,a.user_info_full.ts_last_login,"CRX-LEGACY-OLD");chrome.tabs.create({url:"https://mightytext.net/app/#v1"});alert("Switching you to the new MightyText Web App. \r\n \r\n Please make sure you have the latest MightyText Android App on your phone (v 3.55) \r\n \r\n Please keep the Chrome Extension installed to receive notifications for incoming SMS.");return!1}-1!=a.user_status.search("not registered")?(_21f588cccf345c420376e1a04285f5f18bfd7d44759e32769a2af771f28f3314dd110948a94f5571("NOT-REG"),
google_login_status=!0,login_and_beta_ready=!1,google_username_currently_logged_in="",extra_login_status_info="USER_REG_BUT_NO_ACTIVE_ANDROID_REG",_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("This user does not have an active Android App registration! (either never set up or they disconnected..)"),notify_android_app_install_once||(a=webkitNotifications.createNotification("error_icon.png","MightyText - Install Android App ","It looks like you haven't installed the MightyText app on your Android phone. You'll need to first install it on your Android phone using Google Play, and select this same Google account ("+
a.email+").  Click here for full instructions."),capi_rollout_factor=7,a.show(),a.onclick=function(a){window.open("http://mightytext.net/install");this.cancel()},notify_android_app_install_once=!0)):(console.log(a.user_status.search("not reg")),notification_general_error_global=webkitNotifications.createNotification("error_icon.png","MightyText","General Error. Please contact the MightyText team."),notification_general_error_global.show())}_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Google Login Status - based on OPENID token from Google: "+
google_login_status+" / username is: "+google_username_currently_logged_in)}})}(function(a){a.getScriptCacheTrueOverrideCustom=function(b,c,d){a.ajax({type:"GET",url:b,success:c,dataType:"jsonp",cache:!0})}})(jQuery);function _21f588cccf345c420376e1a04285f5f18bfd7d44759e32769a2af771f28f3314dd110948a94f5571(a){2>Math.floor(40*Math.random())&&_kmq.push(["record","CRX-UserState-"+a])}
function _2ddc7213da95b02042f5ec59d7df135caa6736500b76c7feb9283c4ab1b7c12eb240117847214c21(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript";c.onload=_de5b3292f4582379201aac1e9eda554929ab4534d74ed0ffc830a45b9f43b69b1225cbc083632b36;c.src=a;b.appendChild(c)}
function _0d3f47014cec52cde1088dd1ce1a88f4719114716c2215f528d0eb7738026879e1215047ebe4b6fc(){webkitNotifications.createNotification("img/mightytext_square_logo_48px.png","MightyText - Switch to New Web App","Hi - please upgrade to our new web app by February 25th. You should still keep the MightyText Chrome Extension installed for incoming SMS and calls notifications. If you don't switch by February 25th, you will be automatically switched over. The new version is much more stable and has many new features.  Thanks.").show()}
function _4996124d4ac9087e2b946ed1b295c9961930211d4e5e7e39cf3e76c1c8dc15737c388ffee5d3c4dd(a){var b=document.createElement("script");b.type="text/javascript";b.async=!0;b.src=a;a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)}
function _d9faf371ccc19df8085805b5da99e94b13d633be01de88f0280ef2bb174bbe86ab36cc4e361cdc3d(a,b,c,d,e){b=Math.round((new Date(b)).getTime()/1E3);d=Math.round((new Date(d)).getTime()/1E3);intercomSettings={email:a,created_at:b,app_id:"7guo5kws",web_app:e,phone_app_version:c,ts_last_login_at:d,wagda:"27-Jan"};(function(){function a(){var b=c.createElement("script");b.type="text/javascript";b.async=!0;b.src="https://api.intercom.io/api/js/library.js";var d=c.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,
d)}var b=window,c=document,d=function(){d.c(arguments)};d.q=[];d.c=function(a){d.q.push(a)};b.Intercom=d;a();b.attachEvent?b.attachEvent("onload",a):b.addEventListener("load",a,!1)})()}function _6e51669c2c3043cb92c3cc6db80737c4424eeabca8f08767ef577970915dfce0afdecee990fa7e82(){should_get_contacts_token_in_new_tab=!1;window.setTimeout(function(){_acf6d7982c834b2cd796a45e0810821afa13bc356535203199ec30d1792d2e1cf224d439481f5a40()},10)}
function _b1a1ef93b58f517ff44c6cf9db088813347ab9508caf5e8dc26b9ec4b2d3d2090559ef93df3eca87(a){var b=baseUrl+"/getJson?function=GetMessage";$.ajaxSetup({error:function(a,b){if(0==a.status){if(num_consecutive_internet_connection_failures+=1,_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Number of consecutive internet connection failures: "+num_consecutive_internet_connection_failures),3==num_consecutive_internet_connection_failures||15==num_consecutive_internet_connection_failures)network_connection_status=
!1,_f7fe87ed320246c60667cae03de8bab1fa5c31f8304e77a36f4e407d195f1c84feaf55034695bff0(!1)}else 404==a.status?(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Error 404. Requested URL not found."),document.getElementById("msg").innerHTML="Error 404. Requested URL not found."):500==a.status?(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Error 500. Internal Server Error."),document.getElementById("msg").innerHTML="Error 500. Internal Server Error."):
"parsererror"==b?_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Error. Parsing JSON Request failed."):"timeout"==b?_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Request Time out."):_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Unknown Error");_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Response text returned from server is: "+a.responseText)}});$.get(b,
{},function(b){network_connection_status=!0;time_last_success_mighty_ping=new Date;num_consecutive_internet_connection_failures=0;_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("JSON Raw text response from GetMessage function is: "+b);if(0<b.search("not logged in"))_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("User NOT logged in to MightyText"),a&&(google_login_status=!1,google_username_currently_logged_in="");else if('{"messages":}'==
b)console.log("BLANK - no messages");else if(0<b.length){_f7fe87ed320246c60667cae03de8bab1fa5c31f8304e77a36f4e407d195f1c84feaf55034695bff0(!0);var d=JSON.parse(b),e=0,f=0,g=0,f=b.split('"type":"0","source":"0"').length-1;console.log("*** Number of Inbox (incoming msgs), based on string match splits is: "+f);var m=!1;b=!1;6<f&&(m=!0,_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("TOO Many messages retrieved in JSON - so don't show any notifs. Total num messages retrieved (incoming only: "+
f),b=!0);$.each(d.messages,function(b,c){var d=c.orig_address,f="",h="";for(a&&_8159618423dfa22f1ca0b62543e2f18eef630ce88e3f85ca487bf4a37c5435bd14fb1c7365a1e260("Found at least 1 Message or ACK/etc, decrease polling frequency",9E3);-1<d.search("[-]");)d=d.replace("-","");-1==d.search("[+]")&&(h="1"==d.charAt(0)?"+":"+1");OLD_phonenum_normalized=h+d;f=c.orig_address;_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("found message to sync... "+f+": "+c.body);0==c.status&&
2==c.source?(_c6dce73a6994e274c9df88e95711fd45073e949b7849fb4866fa24c5c3edb7a1c01216bba17780a5(c.email,c.body,f,c.android_uid),e++):db.transaction(function(b){b.executeSql("INSERT INTO Messages (googleusername,msgid,time_client,time_server,from_phone_num,body,type,status,source) VALUES (?,?,?,?,?,?,?,?,?)",[c.email,c.android_uid,_6d61ac4f794101cf46320c4f60cc55af6bd297f34170ac2a2782a1516fe9e13d7322ae482c1bd594(c.ts),_6d61ac4f794101cf46320c4f60cc55af6bd297f34170ac2a2782a1516fe9e13d7322ae482c1bd594(c.ts_server),
f,c.body,c.type,c.status,c.source],function(b,d){_67b27eb0b28eeaa42b16d43d31a2b40c9084e60d8d1218244d96823a1ecdf1b383e010d29b57a3cc(c.android_uid);var e=!1;0!=c.type&&81!=c.type&&80!=c.type||!1!=m?(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("MsgType=1 (sync sent SMS from phone), so don't pop notif"),g++):(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("called from BG page and MsgType=0, and not too many messages, so popping single notif now"),
e=!0,which_phone_num_for_notif=f);if(a){var k=new Date(c.ts),h=new Date,n=h.getTime()-k.getTime(),l=1;81==c.type?l=0.1:80==c.type&&(l=0.005);n>36E5*l&&(e=!1,_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("** Message is too old to pop Notif** - for message type: "+c.type));_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("...JS date is "+k);_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("current time is"+
h);_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("TIME DIFF (in ms) IS -- "+n+"ms since msg was sent -- comparing to: "+36E5*l);e&&(e="popup_one_text_message.html#"+c.android_uid,k=webkitNotifications.createHTMLNotification(chrome.extension.getURL(e)),_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("showing notif to user...URL is: "+e),_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Notif Level Preference from Local datastore is: "+
window.localStorage.notifLevel),k.ondisplay=function(){setTimeout("notification_html.cancel();",5E3)},k.show(),msgcount="")}},function(a,b){_b4b2654b71c39e0d2edbb953a91f7d31fd24b51d1dac581bea06b92fea45ff1a5b5201dc6c5f4d45(a,b,c.android_uid)})})});b&&(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("showing GENERIC (too many messages) notif to user..."),b=webkitNotifications.createNotification("",f+" Text Messages","You've received "+f+" text messages since the last time you used MightyText, so we won't show you each popup for these messages."),
_gaq.push(["_trackEvent","Background","Lots-Of-Incoming-Messages-Trigger-Popup","TOO-MANY-NOTIF-"+google_username_currently_logged_in,f]),b.show());_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("msg_count_ack is "+e);_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("msg_count_incoming is "+f);_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("msg_count_outgoing_sync_from_phone is "+g);d=d.messages.length;
_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Num messages pulled from this JSON feed is: "+d);0<d&&(f="",f=a?"Background":"Popup",1<d?_gaq.push(["_trackEvent",f,"Got-Messages-SMS","Got-Multiple-Messages",d]):_gaq.push(["_trackEvent",f,"Got-Messages-SMS","Got-1-Message",d]))}})}
function _c6dce73a6994e274c9df88e95711fd45073e949b7849fb4866fa24c5c3edb7a1c01216bba17780a5(a,b,c,d){_gaq.push(["_trackEvent","Background","Got-Message-ACK","",1]);_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Reconciling SMS where originally sent from chrome...");db.transaction(function(e){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("UPDATE Messages SET status=52 WHERE googleusername="+a+"and body="+b+" and from_phone_num="+
c+"  and status=51");e.executeSql("UPDATE Messages SET status=52 WHERE googleusername=? and body=? and from_phone_num=? and status=51",[a,b,c],function(a,b){_67b27eb0b28eeaa42b16d43d31a2b40c9084e60d8d1218244d96823a1ecdf1b383e010d29b57a3cc(d)},_900be5532bab124f8ee846acf4c0eb84a1a9359e6b6ca6fce3ceae0c3804ce7954530baa32c41df0)})}
function _b4b2654b71c39e0d2edbb953a91f7d31fd24b51d1dac581bea06b92fea45ff1a5b5201dc6c5f4d45(a,b,c){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("SQL insert error: "+b.message);-1<b.message.search("constraint failed")&&(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("because it IS a constraint message, we will now RETRY to delete message on server, with android_uid "+c+" from the Cloud Server"),_67b27eb0b28eeaa42b16d43d31a2b40c9084e60d8d1218244d96823a1ecdf1b383e010d29b57a3cc(c))}
function _67b27eb0b28eeaa42b16d43d31a2b40c9084e60d8d1218244d96823a1ecdf1b383e010d29b57a3cc(a){var b=baseUrl+"/getJson?function=DeleteMessages&android_uid="+a;_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Attempting to delete from cloud server this android_uid:"+a);$.ajax({type:"GET",url:b,success:function(a){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Response from cloud after delete attempt: "+a)},error:function(a,b,e){console.log("error in deletemessagefrom server")}})}
var globalWidgetNotifTester;function _4585c0b1f8c04d96f67a9bb9cc1d4956cac28a604ef6f8e48c2e31f6ac3c7e363924eeae339fd8af(){globalWidgetNotifTester=webkitNotifications.createHTMLNotification("mighty-widget.html");globalWidgetNotifTester.show()}
function _48660970f81b1e811eea6ebdefb69db9fff0f24cc5ead704622520cb05e4ea5a792c416331fcf105(){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Getting channel API token...");$.ajax({type:"GET",url:baseUrl+"/getJson?function=getChannelToken&mins=240",success:function(a){console.log("Response from cloud after channel attempt (should have valid_token prepend): "+a);if(0>a.search("valid_token:"))console.log("No valid_token prepend found from Channel API!");else{time_last_channel_token_obtained=
new Date;console.log("Resetting Last Channel ATTEMPT TO OBTAIN Token time . . .");a=a.replace("valid_token:","");var b=(new goog.appengine.Channel(a)).open();console.log("calling channel.open");b.onopen=function(){console.log("Socket Opened via Channel API with token: "+a);_gaq.push(["_trackEvent","Background","ChannelAPI-Open-Socket","",1])};b.onmessage=function(a){_b9cbf3c7173636b786dfabba1aa62bb91c14cd39f36f01eae744b9e28abf24659dc7da79cb5d2ea3();_gaq.push(["_trackEvent","Background","ChannelAPI-Message-Received",
"",1]);console.log("**** CHANNEL SOCKET ONMESSAGE *** Force a poll... ");console.log("Message arrived via channel API= "+a.data)};b.onerror=function(a){console.log("!!!!!!!!!!!!! TOKEN GONE (via onerror callback)!!!!!!!!!!!!");_gaq.push(["_trackEvent","Background","ChannelAPI-Socket-ONERROR-Token-Expired","",1]);_48660970f81b1e811eea6ebdefb69db9fff0f24cc5ead704622520cb05e4ea5a792c416331fcf105()};b.onclose=function(a){console.log("!!!!!!!!!!!!! TOKEN GONE (via onclose callback) !!!!!!!!!!!!");_gaq.push(["_trackEvent",
"Background","ChannelAPI-Socket-ONCLOSE","",1])}}}})}function _89cbf85bfcc68fcc8a10027eca9a63bdfc798426c3fb28a60da3088de67f0b6b5e857275714cc13a(a){webkitNotifications.createNotification("",Date(),a).show()}
function _b3427d13ff23106acb958f9d1235f5a117f8326197b7ac9e4ad441e12f5f125ce31148f222bfe355(){var a="popup_one_text_message.html#"+thismessage.android_uid,b=webkitNotifications.createHTMLNotification(chrome.extension.getURL(a));_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("showing notif to user...URL is: "+a);_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Notif Level Preference from Local datastore is: "+window.localStorage.notifLevel);
b.show()}function _4513df2f7316180df2b697244fb8e9b49acf2211850f9209ee53be07ce3a1c91546480c89b4bb456(a){chrome.windows.create({url:a,left:10,top:10,width:810,height:610,type:"popup"},function(a){})}
function _6d61ac4f794101cf46320c4f60cc55af6bd297f34170ac2a2782a1516fe9e13d7322ae482c1bd594(a){var b=new Date(a);a=b.getHours();var c=b.getSeconds(),d=b.getMinutes(),e=b.getDate(),f=b.getMonth(),b=b.getFullYear();f++;10>f&&(f="0"+f);10>e&&(e="0"+e);10>a&&(a="0"+a);10>d&&(d="0"+d);10>c&&(c="0"+c);return b+"-"+f+"-"+e+" "+a+":"+d+":"+c}var should_get_contacts_token_in_new_tab=!1;
function _acf6d7982c834b2cd796a45e0810821afa13bc356535203199ec30d1792d2e1cf224d439481f5a40(){oauth.authorize(function(){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("on google contacts - oauth.authorize()");oauth.sendSignedRequest("http://www.google.com/m8/feeds/contacts/default/full",_d6dbb77a4036e0fc337667f1937be7f572e47b956df6e9901232154d96b9c976075be61623f2913b,{parameters:{alt:"json","max-results":1E4}})})}
function _d1d01a178db404bdbbb0745a5933d9e30eb1897972efe126045f76d295df1305bb99df15ac1103ec(){oauth.clearTokens()}function _b8cd31e5e50a940b993ee61dc0fd958f433b150d8eaf166e0b79deeb28d02356cd9ff1fbb14fa6ee(){window.localStorage.notifLevel=3}
function _a9b0b2c7f905c29c8f7a595084b6078811aef17e00dda602eeb0b87283e18cfa338328358aa983d9(){db||(db=openDatabase("Texty","1.0","Texty-SMS",2E5));db.transaction(function(a){a.executeSql("SELECT COUNT(*) as cnt FROM sqlite_master where name='Messages'",[],function(a,c){var d=c.rows.item(0).cnt;_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Messages table exists?: "+d);0==d&&(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Couldnt find table LocalGoogleContacts...creating..."),
_651078e00de7500deab3f209e50112a4ed9c6ecf082908dfc53818856878d46f7563b48c7cd9f39c())},_900be5532bab124f8ee846acf4c0eb84a1a9359e6b6ca6fce3ceae0c3804ce7954530baa32c41df0)});db.transaction(function(a){a.executeSql("SELECT COUNT(*) as cnt FROM sqlite_master where name='LocalGoogleContacts'",[],function(a,c){var d=c.rows.item(0).cnt;_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("LocalGoogleContacts table exists?: "+d);0==d&&(_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Couldnt find table LocalGoogleContacts...creating..."),
_9684773489f3be5cf701c936805bbd32ee61061fc5373f189d26d80408cb3e6ce3e4d4f06a3c7d84())},_900be5532bab124f8ee846acf4c0eb84a1a9359e6b6ca6fce3ceae0c3804ce7954530baa32c41df0)})}
function _651078e00de7500deab3f209e50112a4ed9c6ecf082908dfc53818856878d46f7563b48c7cd9f39c(){db.transaction(function(a){a.executeSql("CREATE TABLE Messages (id INTEGER PRIMARY KEY AUTOINCREMENT, googleusername TEXT, msgid TEXT UNIQUE, time_client DATE, time_server DATE, from_phone_num TEXT, body TEXT, type INTEGER, status INTEGER, source INTEGER)",[],function(a){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("table Messages created")},_900be5532bab124f8ee846acf4c0eb84a1a9359e6b6ca6fce3ceae0c3804ce7954530baa32c41df0)})}
function _9684773489f3be5cf701c936805bbd32ee61061fc5373f189d26d80408cb3e6ce3e4d4f06a3c7d84(){db.transaction(function(a){a.executeSql("CREATE TABLE LocalGoogleContacts (id INTEGER PRIMARY KEY AUTOINCREMENT, googleusername TEXT, phone_num TEXT UNIQUE, contact_name TEXT)",[],function(a){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("table LocalGoogleContacts created")},_900be5532bab124f8ee846acf4c0eb84a1a9359e6b6ca6fce3ceae0c3804ce7954530baa32c41df0)})}
function _7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa(a,b){1==debug_mode&&console.log(a)}
function _758ec4656f23a1a12e48e9a63b7a23bdcaf1045f1b365ebeb0369226a300e43b0890ad57f98e30fb(a,b){for(var c=0;c<contacts.length;c++){var d=_f9e48bde6455505d307dd76343e2400b2191c68547550ab77c8109a198985807ecb0f3750c3fad48(contacts[c].phonenums[0]).search(a);if(-1<d)return _7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("FOUND substring in Google Contact Array- substring match position is: "+d),_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Inserting this contact into Local Contact DB table...full phone num is "+
b+"..."+contacts[c].name),_3e9acece6ab0174ac6006c5b42fe2f0ce3ffbe9c714cfdefa9e9680dd87c852e4df3e3401c54b4a0(contacts[c].phonenums[0],contacts[c].name),{contactPhoneNumberfromGoogleContactsArray:b,contactNamefromGoogleContactsArray:contacts[c].name}}return""}
function _79dd1b19504163af687a7202cb3b41de37d389d81e90e61568a57942888af04eed2f3f3d6bd15c4d(a){for(var b=0;b<localContactsArray.length;b++){var c=_f9e48bde6455505d307dd76343e2400b2191c68547550ab77c8109a198985807ecb0f3750c3fad48(localContactsArray[b].phone_num).search(a);if(-1<c)return _7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("FOUND substring in local contact - substring match position is: "+c),{contactPhoneNumberLocalDB:localContactsArray[b].phone_num,contactNameLocalDB:localContactsArray[b].contact_name}}return""}
function _f9e48bde6455505d307dd76343e2400b2191c68547550ab77c8109a198985807ecb0f3750c3fad48(a){for(;-1<a.search("[-]");)a=a.replace("-","");for(;-1<a.search("[ ]");)a=a.replace(" ","");for(;-1<a.search("[(]");)a=a.replace("(","");for(;-1<a.search("[)]");)a=a.replace(")","");7>a.length&&(a=_226b199aba135d1b904d5f915473d5db1aa0668650de561a227f24e43a83c388efa9d70f5e48c82b(a,7));return a}
function _3e9acece6ab0174ac6006c5b42fe2f0ce3ffbe9c714cfdefa9e9680dd87c852e4df3e3401c54b4a0(a,b){db.transaction(function(c){c.executeSql("INSERT INTO LocalGoogleContacts (googleusername,phone_num,contact_name) VALUES (?,?,?)",[google_username_currently_logged_in,a,b],function(c,e){_7d60570c3484235e09d742488cbbfec2cd90cd26379402ae0cce36ac44717acce339a170c7d528aa("Added Contact to local SQL: "+b+" / "+a+" / "+google_username_currently_logged_in)},_900be5532bab124f8ee846acf4c0eb84a1a9359e6b6ca6fce3ceae0c3804ce7954530baa32c41df0)})}
function _e78b9248a3d39af6662eae65d0d59e924e52e6bf741cdfd4cb0b43c3c7d16d89542828d45106a137(){$.get("http://textyapp.com/get_dynamic_info.php",function(a){dynamic_info_global=a})}function _226b199aba135d1b904d5f915473d5db1aa0668650de561a227f24e43a83c388efa9d70f5e48c82b(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}function _28208c04e0c9ed0ff7eb2e2e2ab8ebcf7979e9c8cafa8114e40d0f3e5e5af125dc4f9f349cb22ea4(a){return a};